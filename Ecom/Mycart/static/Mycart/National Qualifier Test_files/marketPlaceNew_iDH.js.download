var instanceId, orgID, masterform_id, OrgFormId, ProductFormId, UsrFormId, indexDetailsStatus=false, hashStatusVariable=false, currentPageOfcatalogue, currentPageOftransaction, itemTags, txtProductIDs, prdIdsAndName, OrderFormId,userFormid, headerUploadPath,footerUploadPath,indexUploadPath,catalogueUploadPath,cartUploadPath,userWishList,txtLoginLink,txtSignupLink,distributorProductDiscountQtyDetails="",globalResponse="",dynamicTabList="",googleAnalyticsId="",logoutURL="",globalCurrencySymbol="",calendar="",isCurrentSchedule=true,checkFromMinJs=false,showCalenderView=false,showFilterNav=true,globalCurrentDate="",globalCurrentYear="",currentView="",catalogueCheck=true,createNewRange=true,filterSearchFlag=true,micrositeCheck=false, remember, userid, confData, app_seq_no="", sessChk="",isDirectLA=false,groupID,globalPostLoginScreen=1,logme=false,myWishlistProducts="",openOrderWindow="",orderReceiptPage="",globalModuleVisibility="",languageId,languageName,languageDetails,currencyDetails,globalCategories,goToCatalogueText="",catalogueNavigation=false,paymentWindowInFrameYNCheck=true,isDisAvailable=false,isPubAvailable=false,gblTabVisibility,globalDisPubList,viewInvoiceInst="",viewRefundInst="",viewProductInvoiceInst="",typeOfProductsForDistributor="",isDashboardPresent=false,isLearnerMode="",externalId="",distributorClicked=false,profileCompletionFlag=true,userRegistrationEditLink="",isNewRegistration=false,isNewOrgRegistration=false,isNewInstituteFieldRequired=false,userTypesOrg="",allInstanceDetails,globalUrl="",encryptedString = "", order_app_seq_no = "",newPaymentApproach="",orderCalculationPath="",isPostPaidLicenseGenerationAllowed="",isSelfGenerationAllowed="",giftToFriendRequired="",digitalContractRequired="",typeOfHub="",publisherPurchaseAllowed="",offlineOrderInvoiceGeneration="",publisherDetails={},isNewHeader=false,newCartRequired="0",eformsLinksobj={},globalInstanceAPjson={};
var monthArraySmall=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
var monthArray=["January","February","March","April","May","June","July","August","September","October","November","December"];
var level1ArrayN=[],level2ArrayN=[],level3ArrayN=[],level4ArrayN=[],level1ArrayV=[],level2ArrayV=[],level3ArrayV=[],level4ArrayV=[],instancePubNameId=[],micrositeHeaderArray=[],micrositeHeaderHeightArray=[],orderArray=[];
var tabNamesNotToBeShown=["My Organizations","My Invitations","Manage Products","Manage Users","My Requests","Manage Licenses","View Licences","Online Assessment","Miscellaneous","As Publisher","As Distributor","My Received Requests","S1","S2","S3","S4","S5","S6","S7",""];
var instituteIdList=["affiliatingBodyOrg","principalNameOrg","principalMobileNumberOrg","principalEmailOrg","instituteCoordinatorNameOrg","instituteCoordinatorMobileNumberOrg","instituteCoordinatorEmailOrg","institutionCoordinatorDesignationOrg","assessmentSpocNameOrg","assessmentSpocMobileNumberOrg","assessmentSpocEmailOrg","internalTypeOfInstituteOrg"];
var instituteIdList0=["Affiliating Body","Principal/ CEO/Owner/Vice Chancellor Name","Principal/ CEO/Owner/Vice Chancellor's Mobile Number","Principal/ CEO/Owner/Vice Chancellor's Email id ","Coordinator's Name","Coordinator's Mobile Number","Coordinator's Email Id","Coordinator's Designation","","","","University Type/ Sector"];
var instituteIdList1=["School Board","Principal's Name","Principal's Mobile Number","Principal's Email id","School Coordinator's Name","School Coordinator's Mobile Number","School Coordinator's Email Id","School Coordinator's Designation","","","",""];
var instituteIdList2=["","Principal's Name","Principal's Mobile Number","Principal's Email id","College Coordinator's Name","College Coordinator's Mobile Number","College Coordinator's Email Id","College Coordinator's Designation","","","",""];
var instituteIdList3=["","Vice Chancellor's Name","Vice Chancellor's Mobile Number","Vice Chancellor's Email id ","University Coordinator's Name","University Coordinator's Mobile Number","University Coordinator's Email Id","University Coordinator's Designation","","","","University Type"];
var instituteIdList4=["","SSC CEO's Name","SSC CEO's Mobile Number","SSC CEO's Email Id","SSC Coordinator's Name","SSC Coordinator's Mobile Number","SSC Coordinator's Email Id","","SSC Assessment SPOC's Name","SSC Assessment SPOC's Mobile Number","SSC Assessment SPOC's Email Id","Sector Dropdown"];
var instituteIdList5=["","Principal's Name","Principal's Mobile Number","Principal's Email id","College Coordinator's Name","College Coordinator's Mobile Number","College Coordinator's Email Id","College Coordinator's Designation","","","",""];
var instituteIdList6=["","NGO CEO's Name","NGO CEO's Mobile Number","NGO CEO's Email Id","NGO Coordinator's Name","NGO Coordinator's Mobile Number","NGO Coordinator's Email Id","NGO Coordinator's Designation","","","",""];
var instituteIdList7=["","Mobilisation Partner CEO's Name","Mobilisation Partner CEO's Mobile Number","Mobilisation Partner CEO's Email Id","Mobilisation Partner Coordinator's Name","Mobilisation Partner Coordinator's Mobile Number","Mobilisation Partner Coordinator's Email Id","Mobilisation Partner Coordinator's Designation","","","",""];
var instituteIdList8=["","Training Partner Owner's Name","Training Partner Owner's Mobile Number","Training Partner Owner's  Email id ","Training Partner Coordinator's Name","Training Partner Coordinator's Mobile Number","Training Partner Coordinator's Email Id","","","","",""];
var selectorList=["Aerospace and Aviation","Agriculture","Apparel Made-Ups & Home Furnishing","Automotive","Beauty & Wellness","BFSI","Capital Goods","Construction","Domestic Workers","Electronics","Food Industry Capacity & Skill Initiative","Furniture and Fittings","Gem and Jewellery","Handicrafts and Carpet","Healthcare","Hydrocarbon","Indian Iron and Steel","Plumbing","Infrastructure Equipment","Life Sciences","Logistics","Management & Entrepreneurship and Professional","Media & Entertainment","Paints and Coatings","Power","Retailers Association's","Rubber","Green Jobs","Mining","Persons with Disability","Sports, Physical Education, Fitness & Leisure","Strategic Manufacturing","Telecom","Textile Tourism and Hospitality","Instrumentation Automation Surveillance & Communication","IT-ITeS","Leather"];
$(document).ready(function(){
	instanceId=$('#instanceId').val();
	var url=$.trim($('#instanceJsonPath').val()).replace('/ionstore','');
	globalUrl=url.replace(instanceId+'_A.json','');
	jQuery('a').on("click",function(){
		$("a").removeClass("Clicked");
		$(this).addClass("Clicked");
	});
	window.onerror = function() {
		hideLoader_iDH();
	};
});
function fnLoadUI() {
	var path=window.location.pathname;
	if(window.location.pathname.split('/').indexOf('Cart') > -1)
		store.set('waitForAnotherAjaxCall','true');
	else
		store.del('waitForAnotherAjaxCall');
	browserAlert();
	$('#registeredUsers').html($('#registrationCountWidget iframe').contents().find('span').text());
	$('#txtSessionCheck').next().remove();
	showLoader();
	getInstanceJson();
}
function getInstanceJson(){
	app_seq_no=$('#app_seq_no').val();	
	instanceId=$('#instanceId').val();
	orgID=$('#orgId').val();
	store.set('instanceId',instanceId);
	store.set('orgID',orgID);
	fetchMultingualPathJson('34');
	var instanceJsonPath=$.trim($('#instanceJsonPath').val()).replace('/ionstore','');
	globalUrl=instanceJsonPath.replace(instanceId+'_A.json','');
	$.getJSON(instanceJsonPath+"?version="+iHUB.version.get(), function( data ) {
		globalInstanceAPjson = data;
		languageDetails=data.languageDetails;
		if($.trim(data.instanceDetails.defaultLanguageId)!="")
			languageId=$.trim(data.instanceDetails.defaultLanguageId);
		else
			languageId="1";
		if(!jQuery.isEmptyObject(data.organizationDetails)){
			publisherDetails=data.organizationDetails;
		}
		preLoginAction(data);
	});	
}
function fnStringtoXML(text) {
	if (window.ActiveXObject) {
		var doc = new ActiveXObject('Microsoft.XMLDOM');
		doc.async = 'false';
		doc.loadXML(text);
	} else {
		var parser = new DOMParser();
		var doc = parser.parseFromString(text, 'text/xml');
	}
	return doc;
}
function callMylogoOnclick(){
	showAccordion('');		
	showLoader();		
	callOnSearch();			
	$('.bredcrum .container .pull-left').html('Home');		
	$('#IndexContent').removeClass('hidden');		
	
	$('#search1').addClass('hidden');		
	$('.bredcrum').addClass('hidden');		
	fireResize(); 		
	
	hideLoader_iDH();		
	/* setLinkHash(instanceId+'@IID@Home/'); */ /* commented as now no hash in jobs */
} 
function createCataloguePage(response){
	$("div[id='div437']").remove();
	var newResponse=JSON.stringify(response);
	var obj = JSON.parse(newResponse);
	var count=1;
	$('#catalogueItems').html("");
	var instructor=[],level1=[],level2=[],level3=[],level4=[],maxProductPrice=[],maxDuration=[];
	for(label in obj){
		if(label=="productDetails"){
			var val=obj[label];
			if(val.length>0){
				var page = Math.ceil(val.length/6);
				var objValue=0;
				var pageLabel="<div id='div437' class='custPagination container-fluid marginbottom30 margintop20 removepadding'>";
				pageLabel+="<p class='pagenumbertext bottompagetext'> <strong><span id='Start37'></span></strong><span data-a='23' data-b='to'> "+multilingualKeyValue('23','34')+" </span><strong><span id='end37'></span></strong><span data-a='24' data-b='of'> "+multilingualKeyValue('24','34')+" </span><strong><span id='total37'>"+val.length+"</span></strong><span data-a='25' data-b='Entries'> "+multilingualKeyValue('25','34')+"</span></p>";
				pageLabel+="<div class=' bottompagenum'>";
				pageLabel+="<div id='mobileDiv-37' class='text-center visible-sm visible-xs'><a onclick=\"selectPageCatalogue('productDetails-prev')\" id='secondbtn37' class='btn btn-default cousorPointer'><i class='fa fa-angle-left'></i><span data-a='27' data-b='Back'> "+multilingualKeyValue('27','34')+"</span></a>&nbsp;<a onclick=\"selectPageCatalogue('productDetails-next')\" id='thirdbtn37' class='btn btn-default cousorPointer'><span data-a='26' data-b='Next'>"+multilingualKeyValue('26','34')+" </span><i class='fa fa-angle-right'></i></a></div>";
				pageLabel+="<nav class='hidden-sm hidden-xs'>";
				pageLabel+="<ul id='paginationUL-37' class='pagination'>";
				pageLabel+="<li><a onclick=\"selectPageCatalogue('productDetails-1')\" class=\"cousorPointer\" id='firstbtn37' aria-label='Previous' > <i class='fa fa-angle-left'></i><i class='fa fa-angle-left'></i> </a>                </li>                <li>                    <a onclick=\"selectPageCatalogue('productDetails-prev')\" id='secondbtn37' class=\"cousorPointer\" aria-label='Previous' > <i class='fa fa-angle-left'></i></a>                </li>";
				for(var p = 0; p < page; p++){
					var currentPage=Number(p)+1;
					if(page!=1){
						pageLabel+="<li><a onclick=\"selectPageCatalogue(this.id);\" class=\"cousorPointer\" class=\"cousorPointer\" id='productDetails-"+currentPage+"' >"+currentPage+"</a></li>";
					}
					var str="";
					str+="<div id=\"catalogue"+currentPage+"\"><div class=\"row margintop10\"></div></div>";
					$("div[id='div437']").remove();
					$('#catalogueItems').append(str);
					var str1="";
					for (var i = 0; i < 6 && objValue < val.length; i++){
						var catalog = val[objValue];
						var productImage="";
						if (typeof createCustomThumbnail == 'function')
							str1+="<div class=\"col-md-4 col-sm-6 col-xs-12 paddingleft10 stamps\">"+createCustomThumbnail(catalog,"box_ht","C")+"</div>";
						else
							str1+="<div class=\"col-md-4 col-sm-6 col-xs-12 paddingleft10 stamps\">"+getThumbnail(catalog,"box_ht","C")+"</div>";	
						count++;
						objValue++;
					}			
					$("#catalogue"+currentPage+" .row").append(str1);
				}
				pageLabel+="<li><a onclick=\"selectPageCatalogue('productDetails-next')\" class=\"cousorPointer\" id='thirdbtn37' aria-label='Next' > <i class='fa fa-angle-right'></i> </a></li>";
				pageLabel+="<li><a onclick=\"selectPageCatalogue('productDetails-"+page+"')\" class=\"cousorPointer\" id='fourthbtn37' aria-label='Next' > <i class='fa fa-angle-right'></i><i class='fa fa-angle-right'></i> </a></li>";
				pageLabel+="</ul></nav></div></div>";
				$('#catalogueItems').after(pageLabel);
			}
			else{
				$('#catalogueItems').append("<h4 class='margintop20 text-center' data-a='28' data-b='Sorry, no results found.'>"+multilingualKeyValue('28','34')+"</h4>");
			}			
			var instructorName="";
			if(instructor.length>0){
				for(var k = 0; k < instructor.length ; k++){	
					if(instructor[k]!=null){
						$('.offerByOpen').addClass('hidden');
						instructorName+="<div class=\"checkbox\"><label><input type=\"checkbox\" id=\"txtInstructorName\" value=\"\">"+instructor[k]+"</label></div>";
					}
				}
			}
			else{
				$('.offerByOpen').addClass('hidden');
			}
			$('.offerBy').html("");
			$('.offerBy').append(instructorName);	
		}
		if(label=="catalogue" || label=="createSearchCatalogue" ){
			var valFilter,valCatalogue,valChildCatalogue,postView="";
			var valMain=obj[label];
			for(label in valMain){
				if(label.toLowerCase()=="filterdetails"){
					valFilter=valMain[label];
				}
				if(label.toLowerCase()=="catalogue"){
					valCatalogue=valMain[label];
				}
				if(label.toLowerCase()=="childcatalogue"){
					valChildCatalogue=valMain[label];
				}
			}
			var val="";
			var valLength=0;
			if(valCatalogue!=undefined){
				val=valCatalogue;
				valLength=val.length;
			}
			var str1="";
			var RecordCount="",PageNo="",page = "",PriceRange = "",RecordsPerPage="";
			var L1 = "",L2 = "",L3 = "",L4 = "",OB = "",PCT = "",schedule="",view="";
			var myArray=[];
			var showCatalogue = false,dontRepeat=false;
			var calenderHtmlText=[];
			var listHtmlText="",previousDate="";
			if(valFilter!=undefined){
				var catalog=valFilter['0'];
				RecordCount=catalog.RecordCount;
				PageNo=catalog.PageNo;
				RecordsPerPage = catalog.RecordsPerPage;
				page = Math.ceil(RecordCount/RecordsPerPage);
				PriceRange = catalog.PriceRange;						
				L1 = catalog.L1;
				L2 = catalog.L2;
				L3 = catalog.L3;
				L4 = catalog.L4;
				OB = catalog.OB;
				PCT = catalog.PCT;
				schedule = catalog.schedule;
				view = catalog.view;
				
				view = (view==null || view=="") ? "catalogue" : view ;
				schedule = (schedule==null || schedule=="") ? "none" : schedule ;
				
				if(view.toLowerCase()!="modal"){
					var levelsHideShow=false;
					if($('#filterLevelsToggle').length > 0){
						if($('#filterLevelsToggle').val().toLowerCase()=="yes"){
							levelsHideShow=true;
						}
					}
					if(levelsHideShow){
						openTheseFilters('L1',L1);
						openTheseFilters('L2',L2);
						openTheseFilters('L3',L3);
						openTheseFilters('L4',L4);
					}
					openTheseFilters('OB',OB);
					openTheseFilters('PCT',PCT);
					openViewAndSchedule(view.toLowerCase(),schedule.toLowerCase());
				}
				if(view.toLowerCase()=="catalogue"){
					showCatalogue=true;
				}
				if($('.slider_range').html()=="")
					createNewRange=true;
				else
					createNewRange=false;
				
				if((((schedule.toLowerCase().indexOf('schedule')>-1 && view.toLowerCase()=="list") || view.toLowerCase()=="list")|| view.toLowerCase()=="modal") && valLength>0){
					var parentProductId=[],dates=[],dateValues=[],datas=[];
					
					$.each(valCatalogue, function(k, v) {
						if(v.IsParentProduct.toLowerCase()=="yes"){
							var currDateValue="";
							if(valChildCatalogue!=undefined){
								$.each(valChildCatalogue, function(kc, vc) {
									if(v.app_seq_no==vc.txtParentProductId){
										var currentDate=new Date(vc.txtItemScheduledStartDate.split(' ')[0]).valueOf();
										if(currentDate!=currDateValue){
											currDateValue=currentDate;
											dateValues.push(currentDate);
											/* var	b = clone(v); */
											var	b = JSON.parse(JSON.stringify(v));
											b.txtItemScheduledStartDate=vc.txtItemScheduledStartDate;
											datas.push(b);
										}										
									}
								});
							}
						}
						else{
							var currentDate=new Date(v.txtItemScheduledStartDate.split(' ')[0]).valueOf();
							dateValues.push(currentDate);
							datas.push(v);
						}
					});
					var uniqueDateValues = [];
					$.each(dateValues, function(i, el){
						if($.inArray(el, uniqueDateValues) === -1) 
							uniqueDateValues.push(el);
					});
					var uniqueSortArray=uniqueDateValues.slice(0).sort();
					var newData=[];
					$.each(uniqueSortArray, function(k, v) {
						var  i = -1,indizes = [];
						while((i = dateValues.indexOf(v, i + 1)) !== -1) {
							indizes.push(i);
						}
						$.each(indizes, function(ik, iv) {
							newData.push(datas[iv]);
						});
					});
					$.each(newData, function(k, v) {
						if(v.IsParentProduct.toLowerCase()=="yes"){
							var seatsAvailableChildArray=[],locationChildArray=[],waitListStatusChildArray=[],registerInterestStatusChildArray=[],txtItemStartDateChildArray=[],txtItemEndDateChildArray=[];
							var parentDate=v.txtItemScheduledStartDate.split(' ')[0];
							if(valChildCatalogue!=undefined){
								var childCount=0;
								$.each(valChildCatalogue, function(kc, vc) {
									var currentDate=vc.txtItemScheduledStartDate.split(' ')[0];
									if(v.app_seq_no==vc.txtParentProductId && currentDate==parentDate){
										childCount++;
										if(!checkIfProductExpired(vc)){
											vc['expiredChildProduct']=false;
											if(vc.location!=undefined && vc.location!=null && $.trim(vc.location)!=''){
												locationChildArray.push(vc.location); 
											}
											if(vc.seatsAvailable!=undefined && vc.seatsAvailable!=null && !isNaN(vc.seatsAvailable) && $.trim(vc.seatsAvailable)!='' && vc.isLimitedSeats=="Yes"){
												seatsAvailableChildArray.push(vc.seatsAvailable); 
											}
										}
										else{
											vc['expiredChildProduct']=true;
										}
										if(vc.waitListStatus!=undefined && vc.waitListStatus!=null && $.trim(vc.waitListStatus)!=''){
											waitListStatusChildArray.push(vc.waitListStatus); 
										}
										if(vc.registerInterestStatus!=undefined && vc.registerInterestStatus!=null && $.trim(vc.registerInterestStatus)!=''){
											registerInterestStatusChildArray.push(vc.registerInterestStatus); 
										}
										if(vc.txtItemStartDate!=undefined && vc.txtItemStartDate!=null && $.trim(vc.txtItemStartDate)!=''){
											txtItemStartDateChildArray.push(vc.txtItemStartDate); 
										}
										if(vc.txtItemEndDate!=undefined && vc.txtItemEndDate!=null && $.trim(vc.txtItemEndDate)!=''){
											txtItemEndDateChildArray.push(vc.txtItemEndDate); 
										}
									}
								});
								v.seatsAvailable=seatsAvailableChildArray.toString();
								v.location=locationChildArray.join(';');
								v.countOfChildProducts=childCount;
								if(v.waitListStatus!=undefined && v.waitListStatus!=null){
									waitListStatusChildArray.push(v.waitListStatus);
								}
								v.waitListStatus=waitListStatusChildArray.toString();
								if(v.registerInterestStatus!=undefined && v.registerInterestStatus!=null){
									registerInterestStatusChildArray.push(v.registerInterestStatus);
								}
								v.registerInterestStatus=registerInterestStatusChildArray.toString();
								v['txtItemStartDateChildArray']=txtItemStartDateChildArray.toString();
								v['txtItemEndDateChildArray']=txtItemEndDateChildArray.toString();
							}
						}
					});
					valLength=newData.length;
					val=newData;
				}
				$('#catalogueItems').html('');
				$("div[id='div437']").remove();
				if(valLength>0){
					var str="";
					str+="<div id=\"catalogue"+PageNo+"\"><div class=\"row margintop10\"></div></div>";
					$('#catalogueItems').append(str);						
					var pageLabel="<div id='div437' class='custPagination container-fluid marginbottom30 margintop20'>";
					pageLabel+="<p class='pagenumbertext bottompagetext'> <strong><span id='Start37'></span></strong><span data-a='23' data-b='to'> "+multilingualKeyValue('23','34')+" </span><strong><span id='end37'></span></strong><span data-a='24' data-b='of'> "+multilingualKeyValue('24','34')+" </span><strong><span id='total37'>"+RecordCount+"</span></strong><span data-a='25' data-b='Entries'> "+multilingualKeyValue('25','34')+"</span></p>";
					pageLabel+="<div class=' bottompagenum'>";
					pageLabel+="<div id='mobileDiv-37' class='text-center visible-sm visible-xs'><a onclick=\"selectPageCatalogue('myTransHis-prev')\" id='secondbtn37' class='btn btn-default cousorPointer'><i class='fa fa-angle-left'></i><span data-a='27' data-b='Back'> "+multilingualKeyValue('27','34')+"</span></a>&nbsp;<a onclick=\"selectPageCatalogue('myTransHis-next')\" id='thirdbtn37' class='btn btn-default cousorPointer'><span data-a='26' data-b='Next'>"+multilingualKeyValue('26','34')+" </span><i class='fa fa-angle-right'></i></a></div>";
					pageLabel+="<nav class='hidden-sm hidden-xs'>";
					pageLabel+="<ul id='paginationUL-37' class='pagination'>";
					pageLabel+="<li><a onclick=\"selectPageCatalogue('myTransHis-1')\" class=\"cousorPointer\" id='firstbtn37' aria-label='Previous' > <i class='fa fa-angle-left'></i><i class='fa fa-angle-left'></i> </a></li> <li>          <a onclick=\"selectPageCatalogue('myTransHis-prev')\" id='secondbtn37' class=\"cousorPointer\" aria-label='Previous' > <i class='fa fa-angle-left'></i></a></li>";
					for(var p=1;p <= page;p++){
						if(page!=1){
							pageLabel+="<li><a onclick=\"selectPageCatalogue(this.id);\" class=\"cousorPointer\" class=\"cousorPointer\" id='myTransHis-"+p+"' >"+p+"</a></li>";
						}							
					}
					pageLabel+="<li><a onclick=\"selectPageCatalogue('myTransHis-next')\" class=\"cousorPointer\" id='thirdbtn37' aria-label='Next' > <i class='fa fa-angle-right'></i> </a></li>";
					pageLabel+="<li><a onclick=\"selectPageCatalogue('myTransHis-"+page+"')\" class=\"cousorPointer\" id='fourthbtn37' aria-label='Next' > <i class='fa fa-angle-right'></i><i class='fa fa-angle-right'></i> </a></li>";
					pageLabel+="</ul></nav></div></div>";
					$('#catalogueItems').after(pageLabel);
				}						
			}
			for (var i = 0; i < valLength; i++){
				var catalog = val[i];
				if((view.toLowerCase()=="calender" && !schedule.toLowerCase().indexOf('schedule')>-1) && valLength>0){
					if(i==0 && createNewRange){
						getMePriceRange(PriceRange);
					}
					calenderHtmlText.push(createCalenderData(catalog,i));
				}
				else if((((schedule.toLowerCase().indexOf('schedule')>-1 && view.toLowerCase()=="list") || view.toLowerCase()=="list")|| view.toLowerCase()=="modal") && valLength>0){
					var txtCurrency=catalog.txtCurrency;
					var currencySymbol=returnMyCurrencySymbol(txtCurrency);
					if(i==0 && createNewRange){
						globalCurrencySymbol=currencySymbol;
						getMePriceRange(PriceRange);
					}
					if(i==0)
						listHtmlText+='<div class="listingView'+pageNo+'">';
					var showYear=false;
					var currentDate="",currentYear="";
					currentDate=new Date(catalog.txtItemScheduledStartDate.split(' ')[0]).valueOf();
					currentYear=catalog.txtItemScheduledStartDate.split('-')[0];
					if(i==0){
						if(PageNo==1){
							globalCurrentDate="";
							globalCurrentYear="";
							previousDate=catalog.txtItemScheduledStartDate==null || catalog.txtItemScheduledStartDate=="" ? previousDate : new Date(catalog.txtItemScheduledStartDate.split(' ')[0]).valueOf();
							previousYear=catalog.txtItemScheduledStartDate==null || catalog.txtItemScheduledStartDate=="" ? previousYear : catalog.txtItemScheduledStartDate.split('-')[0];
						}
						else{
							previousDate=globalCurrentDate;
							previousYear=globalCurrentYear;
						}								
					}							
					else{
						globalCurrentDate=currentDate;
						globalCurrentYear=currentYear;
					}
					if(i!=0 && previousDate!=currentDate){
						listHtmlText+='</div>';
						listHtmlText+='<legend class="category_heads"></legend>';
					}
					if(i==0 && previousDate!=currentDate && PageNo!=1){
						/* listHtmlText+='</div>'; */
						listHtmlText+='<legend class="category_heads"></legend>';
					}
					if(i==0 || previousDate!=currentDate){
						dontRepeat=true;
						listHtmlText+='<div class="marginbottom20" data-dateValue="'+currentDate+'" data-date="'+catalog.txtItemScheduledStartDate+'">';
					}
					if(i==0 && previousDate==currentDate && PageNo!=1){		
						dontRepeat=false;
					}
					if((i==0 && PageNo==1) || previousYear!=currentYear){
						showYear=true;
					}
					listHtmlText+=createListDate(catalog,dontRepeat,showYear,false);
					if(i==(val.length-1) && dontRepeat){
						listHtmlText+='</div>';
					}
					dontRepeat=false;
					previousDate=currentDate;
					previousYear=currentYear;
					if(i==(val.length-1))
							listHtmlText+='</div>';
					if(PageNo!=page && page!=1 && i==(val.length-1) && view.toLowerCase()!="modal")
						listHtmlText+="<div class=\"loadmore_btn cousorPointer margintop20\" onclick=\"selectPageCatalogue('myTransHis-"+(PageNo+1)+"');\"><a class=\"btn btn-default\" data-a='29' data-b='Load More'>"+multilingualKeyValue('29','34')+"</a></div>";
				}
				else if(valLength>0){
					showCatalogue=true;
					var productImage="";
					if (typeof createCustomThumbnail == 'function')
						str1+="<div class=\"col-md-4 col-sm-6 col-xs-12 paddingleft10 stamps\">"+createCustomThumbnail(catalog,"box_ht","C")+"</div>";
					else
						str1+="<div class=\"col-md-4 col-sm-6 col-xs-12 paddingleft10 stamps\">"+getThumbnail(catalog,"box_ht","C")+"</div>";
					
					var txtCurrency=catalog.txtCurrency;
					var currencySymbol=returnMyCurrencySymbol(txtCurrency);
					if(i==0 && createNewRange){
						globalCurrencySymbol=currencySymbol;
						getMePriceRange(PriceRange);
					}
				}				
			}
			if(showCatalogue){
				if(valLength>0){
					$("#catalogue"+PageNo+" .row").append(str1);
					var heightArray=$('#catalogue'+PageNo+' .lblContainer .clearfix:last-child .pull-left').parent().map(function(){ if($.trim($(this).children('.pull-left').html())!="")return $(this).height() }).toArray();
					var uniqueDateValues = [];
					$.each(heightArray, function(i, el){
						if($.inArray(el, uniqueDateValues) === -1) 
							uniqueDateValues.push(el);
					});
					if(uniqueDateValues.length > 1){
						$('#catalogue'+PageNo+' .resizeNames').attr('style','display:none');
						$('#catalogue'+PageNo+' .resizeIcons').attr('style','display:inline-block');
					}
					selectPageCatalogue("selectPageCatalogue-"+PageNo+"");
				}
				else{
					$('#catalogueItems').append("<h4 class='margintop20 text-center' data-a='28' data-b='Sorry, no results found.'>"+multilingualKeyValue('28','34')+"</h4>");
				}
			}
			else if(view.toLowerCase()=="calender" && !schedule.toLowerCase().indexOf('schedule')>-1){
				currView=schedule.toLowerCase().split('calender')[0];
				var date=new Date().toISOString().split('T')[0];
				if(currView=="month"){
					var month=schedule.split(':')[1].split('-')[0];
					var year=schedule.split(':')[1].split('-')[1];
					if(month<10 && !(month.indexOf('0')>-1) && !(month.length>1)){
						month='0'+month;
					} 
					date=new Date(""+year+"-"+month+"").toISOString().split('T')[0];
				}
				else if(currView=="year"){
					var year=schedule.split(':')[1];
					date=new Date(""+year+"").toISOString().split('T')[0];
				}
				log("date..."+date);
				currentView="calender";
				dynamicCalender(calenderHtmlText,currView,date);
				log('calendar called from calender');
				/* added for job CR */
				try{
					calendar.options.views.day.enable=0;
				}
				catch(err) {
					log(err);
				}
				/* added for job CR */
				postView="calendar";
				/* preventAnchorAction(); */
				var maxHeight=Math.max.apply(Math,$('.cal-cell .hideEvents').map(function(){ return $(this).height() }).toArray());
				if(!isNaN(maxHeight))
					$('.cal-year-box .cal-cell').css('height',maxHeight+40);
			}				
			else if(schedule.toLowerCase().indexOf('schedule')>-1){
				$('#listview .container').hide();
				if(PageNo==1)
					$('.upcoming-schedule').find('.sched_cont').html('');
				if(valLength>0){
					if($('.upcoming-schedule .loadmore_btn').html()!=undefined)
						$('.upcoming-schedule .loadmore_btn').remove();
					$('.upcoming-schedule').find('.sched_cont').append(listHtmlText);
					postView="list";
/* 					preventAnchorAction(); */
				}
				else{
					$('.upcoming-schedule').find('.sched_cont').append("<h4 class='margintop20 text-center' data-a='28' data-b='Sorry, no results found.'>"+multilingualKeyValue('28','34')+"</h4>");
				}
				$('.upcoming-schedule').show();
				selectPageCatalogue("selectPageCatalogue-"+PageNo+"");
				if(PageNo!=1)
					$("html, body").animate({ scrollTop: $(document).height()},'slow');				
			}
			else if(view.toLowerCase()=="modal"){
				$('#events-modal').find('.modal-body').html('');
				$('#events-modal').find('.modal-body').append(listHtmlText);
			}
			else if(view.toLowerCase()=="list" && !schedule.toLowerCase().indexOf('schedule')>-1){
				var calldynamicCalender=true;
				if(schedule.toLowerCase().indexOf('list')>-1)
					currView=schedule.toLowerCase().split('list')[0];
				else if(schedule.toLowerCase().indexOf('date')>-1){
					currView="date";
					$('.'+currView+'ly-schedule').find('.click_box.pull-left.text-center').addClass('hidden');
					$('.'+currView+'ly-schedule').find('.click_box.pull-right.text-center').addClass('hidden');
					if(schedule.toLowerCase().split(':')[0]=='date'){
						var dateSplit=schedule.toLowerCase().split(':')[1].split('/');
						var showDate=Number(dateSplit[0])+" "+monthArray[(Number(dateSplit[1])-1)]+" "+dateSplit[2];
						$('.'+currView+'ly-schedule').find('.media-middle').text(showDate);
						calldynamicCalender=false;
					}
					else if(schedule.toLowerCase().split(':')[0]=='daterange'){
						var dateSplit1=schedule.toLowerCase().split(':')[1].split('/');
						var dateSplit2=schedule.toLowerCase().split(':')[2].split('/');
						var showDate=Number(dateSplit1[0])+" "+monthArray[(Number(dateSplit1[1])-1)]+" "+dateSplit1[2]+" - "+Number(dateSplit2[0])+" "+monthArray[(Number(dateSplit2[1])-1)]+" "+dateSplit2[2];
						$('.'+currView+'ly-schedule').find('.media-middle').text(showDate);
						calldynamicCalender=false;
					}
				}						
				$('#listview .container').hide();
				if(PageNo==1)
					$('.'+currView+'ly-schedule').find('.sched_cont').html('');
				if(valLength>0){
					if($('.'+currView+'ly-schedule .loadmore_btn').html()!=undefined)
						$('.'+currView+'ly-schedule .loadmore_btn').remove();						
					$('.'+currView+'ly-schedule').find('.sched_cont').append(listHtmlText);
					postView="list";
					/* preventAnchorAction(); */
					if(PageNo!=1)
						$("html, body").animate({ scrollTop: $(document).height()},'slow');
				}
				else{
					$('.'+currView+'ly-schedule').find('.sched_cont').append("<h4 class='margintop20 text-center' data-a='28' data-b='Sorry, no results found.'>"+multilingualKeyValue('28','34')+"</h4>");
				}
				$('.'+currView+'ly-schedule').show();
				log($('.'+currView+'ly-schedule').find('.media-middle').text());
					var date=new Date().toISOString().split('T')[0];
					if(currView=="month"){
						var month=schedule.split(':')[1].split('-')[0];
						var year=schedule.split(':')[1].split('-')[1];
						if(month<10 && !(month.indexOf('0')>-1) && !(month.length>1)){
							month='0'+month;
						} 
						date=new Date(""+year+"-"+month+"").toISOString().split('T')[0];
					}
					else if(currView=="year"){
						var year=schedule.split(':')[1];
						date=new Date(""+year+"").toISOString().split('T')[0];
					}
					else if(currView=="week"){
						var week=schedule.split(':')[1].split('-')[0];
						var year=schedule.split(':')[1].split('-')[1];
						var d = new Date(year, 0, 1);
						d.setDate(d.getDate() + (week * 7) + 1);
						date=d.toISOString().split('T')[0];
					}
					log("currView.."+currView+" & date..."+date);
					var myArray=[];
					if(calldynamicCalender)
						dynamicCalender(myArray,currView,date);
					log('calendar called from list');
				selectPageCatalogue("selectPageCatalogue-"+PageNo+"");
			}
			if(valChildCatalogue!=undefined){
				if(valChildCatalogue.length>0 && !showCatalogue){
					var preAppend="";
					if(schedule.toLowerCase().indexOf('schedule')>-1){
						preAppend=$('.upcoming-schedule');
					}
					else if(view.toLowerCase()=="modal"){
						preAppend=$('#events-modal');
					}
					else if(view.toLowerCase()=="list" && !schedule.toLowerCase().indexOf('schedule')>-1){
						preAppend=$('.'+currView+'ly-schedule');
					}
					for (var i = 0; i < valChildCatalogue.length; i++){
						var catalog = valChildCatalogue[i];
						var listHtmlTextChild="";
						listHtmlTextChild+=createListDate(catalog,false,false,true);
						if(catalog.txtParentProductId!=undefined && catalog.txtParentProductId!="" && catalog.txtParentProductId!=null && catalog.txtParentProductId!="null"){
							var dateforPP=new Date(catalog.txtItemScheduledStartDate.split(' ')[0]).valueOf();
							preAppend.find('.listingView'+pageNo).find('#'+catalog.txtParentProductId+'-Child-'+dateforPP).append(listHtmlTextChild);
						}
					}					
					clickExpandButn(PageNo);
				}
			}
			if(postView!=""){
				if(postView=="list"){					
					if (typeof customPostListView == 'function')  
						customPostListView(response);
				}
				else if(postView=="calendar"){
					if (typeof customPostCalenderView == 'function')  
						customPostCalenderView(response);
				}
				/* preventAnchorAction(); */
			}
		}
	}
	$('#catalogueItems .hoverContent').each(function(){
		if($(this).text()==""){$(this).remove();}
	});
	MyCartAct("C");
	tooltipHoverFocus();
}
function selectPageCatalogue(a){	
	checkPage=a.split('-')[0];
	pageNo=a.split('-')[1];
	recordsPerPage=6;
	if($('#recordsPerPage').val()!=undefined && !isNaN($('#recordsPerPage').val()) && $('#recordsPerPage').val()!=""){
		if(Number($('#recordsPerPage').val())>=1 && Number($('#recordsPerPage').val())<=50)
			recordsPerPage=$('#recordsPerPage').val();
	}
	pages=Math.ceil(Number($('#total37').html())/recordsPerPage);
	if(pageNo=="prev"){
		for(var i=1;i<=pages;i++){
			if($('#paginationUL-37 li:nth-child('+(Number(i)+2)+')').hasClass('active')){
				pageNo=i-1;
			}
		}
		if(pageNo<1){
			pageNo="NA";
		}
	}
	else if(pageNo=="next"){
		for(var i=1;i<=pages;i++){
			if($('#paginationUL-37 li:nth-child('+(Number(i)+2)+')').hasClass('active')){
				pageNo=Number(i)+1;
			}
		}
		if(pageNo>pages){
			pageNo="NA";
		}
	}
	if(pageNo!="NA"){
		for(var i=1;i<=pages;i++){
			if(pageNo==i){
				$('#catalogue'+i).removeClass('hidden');
				$('#myTransHis-'+i).parent().addClass('active');
				if(checkPage!="selectPageCatalogue" && checkPage!="productDetails"){
					currentPageOfcatalogue=pageNo;
					filterSearch();
				}
			}
		}
		if(pageNo==1){
			$('#paginationUL-37 #firstbtn37').addClass('hidden');
			$('#paginationUL-37 #secondbtn37').addClass('hidden');
		}
		else{
			$('#paginationUL-37 #firstbtn37').removeClass('hidden');
			$('#paginationUL-37 #secondbtn37').removeClass('hidden');
		}
		if(pageNo==pages){
			$('#paginationUL-37 #thirdbtn37').addClass('hidden');
			$('#paginationUL-37 #fourthbtn37').addClass('hidden');
		}
		else{
			$('#paginationUL-37 #thirdbtn37').removeClass('hidden');
			$('#paginationUL-37 #fourthbtn37').removeClass('hidden');
		}
		if(pageNo!=pages){
			$('#Start37').html((Number(pageNo)*recordsPerPage)-(recordsPerPage-1));
			$('#end37').html((Number(pageNo)*recordsPerPage));
		}
		if(pageNo==pages){
			$('#Start37').html((Number(pageNo)*recordsPerPage)-(recordsPerPage-1));
			$('#end37').html($('#total37').html());
		}

		if(pages>5){
			var startNo=pageNo;
			var endNo=Number(pageNo)+4;
			for(var k=0;k<=Number(pages);k++){
				$('#myTransHis-'+k).addClass('hidden');
			}
			if(pageNo==1 || pageNo==2){
				startNo=1;
				endNo=5;
			}
			else if(pageNo>2 && pageNo<=Number(pages)-2){
				startNo=(Number(pageNo)-2);
				endNo=(Number(pageNo)+2);
			}
			else if(pageNo==Number(pages) || pageNo==Number(pages)-1){
				startNo=(Number(pages)-4);
				endNo=(Number(pages));
			}
			for(var j=startNo;j<=endNo;j++){
				$('#myTransHis-'+j).removeClass('hidden');
			}
		}
	}	
	if(pageNo==1){$('#secondbtn37').addClass('hidden');}else{$('#secondbtn37').removeClass('hidden');}
	if(pageNo==pages){$('#thirdbtn37').addClass('hidden');}else{$('#thirdbtn37').removeClass('hidden');}
}

function alertMsg(msg){
	$('#alertmsg1612').html('');
	$('#alertmsg1612').html(msg);
	$('#alert').modal();
}
function cartJSPartPreLogin(){
	var selectedCat="";
	log("get-search-selected "+selectedCat);	
	/* preventAnchorAction(); */
	$('.searchfontawesome').on('click',function(){
		selectedCat=$.trim($("#get-search-selected").text());
		if(selectedCat=="Products" || selectedCat==""){
			var txtSearchText=[];
			var searchContex = $(this).siblings('input').length==0 ? ($(this).parent().siblings('input').length==0 ? "" : $(this).parent().siblings('input')) : $(this).siblings('input');
			txtSearchText.push($.trim(searchContex.val().replace(/</g, "").replace(/>/g, "").replace(/'/g, "").replace(/"/g, "").replace(/\\/g, '').replace(/\//g, '').replace(/%/g, '')));
			
			/* if($.trim($('#CatalogueContent').html())==""){
				store.set('txtSearchText',txtSearchText);
				callJobsCataloge(this,'searchfontawesome');
			}else{ */
				itemTags="";
				if($.trim(externalId)!=""){
					$(".disAssigned").click();
				}
				showAccordion('');
				$(".slider_range").fadeOut();
				$('.collapseAllLink').click();
				showLoader();
				callOnSearch();
				if(txtSearchText.length>0 ){
					callOnSearch();
					SetBreadCrumbCatalogue();
					$('#CatalogueContent').removeClass('hidden');
					$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
					$("#distributorManagement").parent().addClass('hidden');
					filterSearch();
					deleteMyFilter();
				}
			/* } */
			/* itemTags="";
			if($.trim(externalId)!=""){
				$(".disAssigned").click();
			}
			showAccordion('');
			$(".slider_range").fadeOut();
			$('.collapseAllLink').click();
			showLoader();
			callOnSearch();
			var txtSearchText=[];
			
			
			if(txtSearchText.length>0 ){
				callOnSearch();
				$('#micrositeContent').addClass('hidden');
				$('#showCatalogue a')[0].click();
				
				if($('#CatalogueContent').html() == ""){
					if($.trim(globalUrl)==""){
						instanceId=$('#instanceId').val();
						var url=$.trim($('#instanceJsonPath').val()).replace('/ionstore','');
						globalUrl=url.replace(instanceId+'_A.json','');
					}
					var path=globalUrl+'catalogue.html';
					if(path!=''){
						$('#CatalogueContent').load(path, function( response, status, xhr ) {
							if ( status == "success" ) {
								SetBreadCrumbCatalogue();
								$('#CatalogueContent').removeClass('hidden');
								$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
								/*$('#filterScreen').css('top',$('#top').height()+$('.filterNav').height());
								$("#distributorManagement").parent().addClass('hidden');
								filterSearch();
								deleteMyFilter();//microsite catalogue logic ends
								getCatalougeData();
								setTimeout(function() {
									custom_marketplace();
								},1000);
							}
						});
					}
				}else{
					SetBreadCrumbCatalogue();
					$('#CatalogueContent').removeClass('hidden');
					$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
					$("#distributorManagement").parent().addClass('hidden');
					filterSearch();
					deleteMyFilter();
				
			}} */
		}
		else if(selectedCat=="Jobs" || selectedCat=='Jobs/Internship'){
			log("Jobs selected");
			/* $('#showjobs a')[0].click(); */		
				var searchContex = $(this).siblings('input').length==0 ? ($(this).parent().siblings('input').length==0 ? "" : $(this).parent().siblings('input')) : $(this).siblings('input');
				var searchText=$.trim(searchContex.val());
				$('#jobcontainer').html('');
				if($.trim(searchText)=="")
					createJobCatalogue("12","","1","");
				else
					createJobCatalogue("12","","1","jobSearch:"+searchText);		
		}
	
		hideLoader_iDH();
	});
	
	$('.searchfontawesome').parent().children('input').on('keypress',function(event){
		if(event.keyCode == 13){
		selectedCat=$.trim($("#get-search-selected").text());
			if(selectedCat=="Products" || selectedCat==""){
				var txtSearchText=[];
				txtSearchText.push($.trim($(this).val().replace(/</g, "").replace(/>/g, "").replace(/'/g, "").replace(/"/g, "").replace(/\\/g, '').replace(/\//g, '').replace(/%/g, '')));
				/* if($.trim($('#CatalogueContent').html())==""){
					store.set('txtSearchText',txtSearchText);
					callJobsCataloge(this,'searchfontawesomeKey');
				}else{ */
					itemTags="";
					showAccordion('');
					$(".slider_range").fadeOut();
					$('.collapseAllLink').click();
					showLoader();
					callOnSearch();
					
					if(txtSearchText.length>0){
						if($.trim($('#openCategory .list-group').html())==""){
							var categoryLevelDetails=$('#product_catlog').data('levelDetails');
							eval('getCategoryDetails(categoryLevelDetails)');
						}
						SetBreadCrumbCatalogue();
						$('#CatalogueContent').removeClass('hidden');
						$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
						/*$('#filterScreen').css('top',$('#top').height()+$('.filterNav').height());*/
						$("#distributorManagement").parent().addClass('hidden');
						var searchFields=txtSearchText.toString();
						var searchVariables="PopularUp";
						filterSearch();	
						deleteMyFilter();				
					}
				/* } */				
			}else if(selectedCat=="Jobs"){
				log("Jobs selected");
				$('#showjobs a')[0].click();
				var searchContex = $.trim($(this).val());
				$('#jobcontainer').html('');
				if($.trim(searchContex)=="")
					createJobCatalogue("12","","1","");
				else
					createJobCatalogue("12","","1","jobSearch:"+searchContex);				
			}
			hideLoader_iDH();
		}
	});
	$('.searchfontawesome').parents('.desktopinpt').children('input').on('keypress',function(event){
		selectedCat=$.trim($("#get-search-selected").text());
		if(event.keyCode == 13){
			if(selectedCat=="Products" || selectedCat==""){
				var txtSearchText=[];
				txtSearchText.push($.trim($(this).val().replace(/</g, "").replace(/>/g, "").replace(/'/g, "").replace(/"/g, "").replace(/\\/g, '').replace(/\//g, '').replace(/%/g, '')));
				/* if($.trim($('#CatalogueContent').html())==""){
					store.set('txtSearchText',txtSearchText);
					callJobsCataloge(this,'searchfontawesomeKey');
				}else{ */
					itemTags="";
					showAccordion('');
					$(".slider_range").fadeOut();
					$('.collapseAllLink').click();
					showLoader();
					callOnSearch();
					if(txtSearchText.length>0){
						/* change By Kiran */
						if($.trim($('#openCategory .list-group').html())==""){
							var categoryLevelDetails=$('#product_catlog').data('levelDetails');
							eval('buildCategoryLevelDetails(categoryLevelDetails)');
						}
						$('#CatalogueContent').removeClass('hidden');
						$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
						/*$('#filterScreen').css('top',$('#top').height()+$('.filterNav').height());*/
						$("#distributorManagement").parent().addClass('hidden');
						var searchFields=txtSearchText.toString();
						var searchVariables="PopularUp";
						filterSearch();	
						deleteMyFilter();
					}
				/* } */
			}
			else if(selectedCat=="Jobs"){
				log("Jobs selected");
				/* $('#showjobs a')[0].click(); */
				var searchContex = $.trim($(this).val());
				$('#jobcontainer').html('');
				if($.trim(searchContex)=="")
					createJobCatalogue("12","","1","");
				else
					createJobCatalogue("12","","1","jobSearch:"+searchContex);
			}
			hideLoader_iDH();
		}
	});
	$('a.logo>.fa-home').on('click',function(){	
		callMylogoOnclick();
	});
	$('.mylogo').on('click',function(){
		showAccordion('');
		showLoader();
		callOnSearch();
		//microsite index logic
		$('#micrositeContent,#micrositeHeadContent').addClass('hidden');//hide microsite
		if($('#IndexContent').html() == ""){
			if($.trim(globalUrl)==""){
				instanceId=$('#instanceId').val();
				var url=$.trim($('#instanceJsonPath').val()).replace('/ionstore','');
				globalUrl=url.replace(instanceId+'_A.json','');
			}
			if($('#app_seq_no').length>0){
				/* var path=globalUrl+'indexPage.html'; */
				var path=globalUrl+'indexPage.html';
				if(path!=''){
					$('#IndexContent').load(path);
					setTimeout(function() {
						//microsite catalogue logic ends
						$('.dropdown-menu-right.searchdropdown li a').removeClass('currSelected');
						$('.bredcrum .container .pull-left').html('Home');
						$('#IndexContent').removeClass('hidden');
						/* $("ul[id='hideForIndex']").addClass('hidden'); */
						$('#search1').addClass('hidden');
						$('.bredcrum').addClass('hidden');
						/* window.dispatchEvent(new Event('resize')); */fireResize(); 
						/*generateIndexPage();*/
						hideLoader_iDH();
						/* setLinkHash(instanceId+'@IID@Home/'); */ /* commented as now no hash in jobs */
						generateIndexPage();
					},500);
				}
			}
			else{
				var path=globalUrl;
				if(path!=''){
					window.location = path;
				}
			}
		}
		else{
			//microsite index logic ends
			$('.dropdown-menu-right.searchdropdown li a').removeClass('currSelected');
			$('.bredcrum .container .pull-left').html('Home');
			$('#IndexContent').removeClass('hidden');
			/* $("ul[id='hideForIndex']").addClass('hidden'); */
			$('#search1').addClass('hidden');
			$('.bredcrum').addClass('hidden');
			/* window.dispatchEvent(new Event('resize')); */fireResize(); 
			/*generateIndexPage();*/
			hideLoader_iDH();
			/* setLinkHash(instanceId+'@IID@Home/'); */ /* commented as now no hash in jobs */
		}
	});	
	if($('button.indexsearchbtn').length>0){
		$('button.indexsearchbtn').on('click',function(){
			var txtSearchText=[];
			txtSearchText.push($.trim($(this).parent().parent().children('input').val().replace(/</g, "").replace(/>/g, "").replace(/'/g, "").replace(/"/g, "").replace(/\\/g, '').replace(/\//g, '')));
			/* if($.trim($('#CatalogueContent').html())==""){
				store.set('txtSearchText',txtSearchText);
				callJobsCataloge(this,'searchIndexsearchbtn');
			}else{ */
				showAccordion('');
				$(".slider_range").fadeOut();
				$('input[id="txtItemPurchaseType"]').removeAttr('checked');
				$('input:checkbox').prop('checked',false);
				$('#txtItemScheduledStartDate').val('');
				$('#txtItemScheduledEndDate').val('');
				$('.collapseAllLink').click();
				showLoader();
				if($('#sessChk').val()!="" && $('#sessChk').val()!=null){
					callOnSearch();
				}
				callOnSearch();
				/* change By Kiran */
				if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
					var categoryLevelDetails=$('#product_catlog').data('levelDetails');
					eval('buildCategoryLevelDetails(categoryLevelDetails)');
				}
				SetBreadCrumbCatalogue();
				$('#CatalogueContent').removeClass('hidden');
				$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
				/*$('#filterScreen').css('top',$('#top').height()+$('.filterNav').height());*/
				$("#distributorManagement").parent().addClass('hidden');
				filterSearch();
				deleteMyFilter();
				hideLoader_iDH();
			/* } */
		});	
	}
	$('.goToCatalog').on('click',function(){
		if($.trim($('#CatalogueContent').html())==""){
			filterSearch();
		}else{
			callOnSearch();
			$('#micrositeContent').addClass('hidden');
			
			if($('#CatalogueContent').html() == ""){
				if($.trim(globalUrl)==""){
					instanceId=$('#instanceId').val();
					var url=$.trim($('#instanceJsonPath').val()).replace('/ionstore','');
					globalUrl=url.replace(instanceId+'_A.json','');
				}
				var path=globalUrl+'catalogue.html';
				if(path!=''){
					$('#CatalogueContent').load(path, function( response, status, xhr ) {
						if ( status == "success" ) {
							SetBreadCrumbCatalogue();
							$('#CatalogueContent').removeClass('hidden');
							getCatalougeData();
							$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
							
							$("#distributorManagement").parent().addClass('hidden');
							setTimeout(function() {
								custom_marketplace();
							},1000);
						}
					});
				}
			}else{
				SetBreadCrumbCatalogue();
				$('#CatalogueContent').removeClass('hidden');
				$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
				
				$("#distributorManagement").parent().addClass('hidden');
			}
		}
	});
	jQuery('.openLogin').on('click',function(){
		openLoginEventHandler();
	});  
	$("#productClose").off('click').on('click', function () {
		productClose();
	});
}
/* added for jobs CR */
function lnk(e){
	showLoader();
	callOnSearch();
	var txtProductCreationType=[];
	var field=$.trim($(e).attr('data-level'));
	if(field=="txtLevel1" || field=="txtLevel2" || field=="txtLevel3" || field=="txtLevel4"){
		if(!isNaN($(e).attr('value'))){
			txtProductCreationType.push($(e).attr('value'));
		}			
	}				
	else if(field=="txtProductCreationType")
		if(!isNaN($(e).attr('data-typeId'))){
			txtProductCreationType.push($(e).attr('data-typeId'));
		}
	else
		txtProductCreationType.push($.trim($(e).text()));
	
	var tempField=field,tempVariable=txtProductCreationType.toString();
	
	if($('#txtUsrRole').length>0){
		if($('#txtUsrRole').val().toLowerCase()=="distributor"){
			if($('.disAssigned').parent().hasClass('active')){
				var disAssigned="";
				$('.disAssigned').each(function() {
					if($(this).parent().hasClass('active')) {
						disAssigned=$(this).attr('data-search');
					}
				});
				if(disAssigned!=""){
					if(tempField==""){
						tempField=tempField.concat("isAssigned");
						tempVariable=tempVariable.concat(disAssigned);
					}
					else{
						tempField=tempField.concat("@~@isAssigned");
						tempVariable=tempVariable.concat("@~@"+disAssigned);
					}
				}
			}
			else{
				var distributorCatalogue=$.trim(store.get('distributorCatalogue'))=="" ? "yes" : ($.trim(store.get('distributorCatalogue')).toLowerCase()=="unassigned" ? "no" : ($.trim(store.get('distributorCatalogue')).toLowerCase()=="assigned" ? "yes" : $.trim(store.get('distributorCatalogue')).toLowerCase()));
				if(tempField==""){
					tempField=tempField.concat("isAssigned");
					tempVariable=tempVariable.concat(distributorCatalogue);
				}
				else{
					tempField=tempField.concat("@~@isAssigned");
					tempVariable=tempVariable.concat("@~@"+distributorCatalogue);
				}
			}
		}
	}
	
	if(tempVariable.length>0){
		/* if($.trim($('#CatalogueContent').html())==""){
			var lnkParam=field+"@@"+tempField+"@@"+tempVariable+"@@"+txtProductCreationType;
			callJobsCataloge(e,'lnk',lnkParam);
		}else{ */
			callOnSearch();
			setLnk(e,field,tempField,tempVariable,txtProductCreationType); 
		/* } */
	}
	hideLoader_iDH();
}
function setLnk(e,field,tempField1,tempVariable,txtProductCreationType){
	/* changed by Kiran */
	if($.trim($('#openCategory .list-group').html())==""){
		var categoryLevelDetails=$('#product_catlog').data('levelDetails');
		eval('getCategoryDetails(categoryLevelDetails)');
	}
	SetBreadCrumbCatalogue();
	$('#CatalogueContent').removeClass('hidden');
	$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
	$("#distributorManagement").parent().addClass('hidden');
	var myLevel=field;
	var tempField="view@~@schedule@~@"+tempField1+"@~@txtorderby";
	var variables = "catalogue@~@none@~@"+tempVariable+"@~@PopularUp";
	if(txtProductIDs!="" && txtProductIDs!=undefined){
		if($('#txtUsrRole').val()=="Distributor"){
			tempField="ProductIdList@~@"+tempField;
			variables=$.trim(txtProductIDs)+"@~@"+variables;
		}		
	}
	$('input:radio[id="txtItemPurchaseType"]:checked').prop('checked', false);
	$('input:checkbox').prop('checked',false);
	$('#txtItemScheduledStartDate').val('');
	$('#txtItemScheduledEndDate').val('');
	$('.searchfontawesome').parent().children('input').val('');
	setTimeout(function() {
		$('input:checkbox[data-id="txtLevels"]').each(function() {
			if($.trim($(this).attr('data-level'))==myLevel && $(this).val()==txtProductCreationType){
				$(this).prop('checked',true);
				$('.collapseAllLink').click();
				openNextlevels($(this));
				showAccordion('openCategory');
			}
			else{
				$(this).prop('checked',false);
			}
		});
		$('input:checkbox[data-id="txtProductCreationType"]').each(function() {
			if($.trim($(this).attr('data-level'))==myLevel && $.trim($(this).attr('data-typeId'))==txtProductCreationType){
				$(this).prop('checked',true);
				showAccordion('openType');
			}
			else{
				$(this).prop('checked',false);
			}
		});
	},500);
	createCatalogueDataRequest(tempField,variables);
	createMySearchLabels(tempField,variables);
}
function callOnSearch(moveToTop){
	$('.diffviews.list-unstyled.clearfix').addClass('hidden');
	$('#tabs').hide();
	$('#customSubscriptionTabs').remove();
	$('#subscriptionLayoutBanner').remove();
	$(".selctdIcon").addClass('hidden');
	$(".showMySubscriptionsWeb .mySubscriptionSub").text('');
	$('#customTabs').remove();
	$('.headings').hide();
	$('#LandingView').hide();
	$('#MyAccount').hide();
	$('#manageUsers').hide();
	$('.leftNavTabs').hide();
	$('.blue-bg #joinOrg').hide();
	$('.blue-bg #createPro').hide();
	$('.blue-bg #ProductListHeading').hide();
	$('#back').hide();
	$('#listbannerarea').addClass('hidden');
	$('#listing').hide();
	$('body').css("overflow","auto");
	$('#orgn').css('display','none');
	$('#HelpCenterContent').html('');
	$('#HelpCenterContent').addClass('hidden');
	$('#IndexContent').addClass('hidden');
	$('#CartContent').addClass('hidden');
	$('#WishListContent').addClass('hidden');
	$('#CatalogueContent').addClass('hidden');
	$('#micrositeHeadContent').addClass('hidden');
	$('#userDashboard').addClass('hidden');
	$('#blogContent').html('');
	$('#blogContent').addClass('hidden');
	micrositeCheck=false;
	$("[id^='fragment']").hide();
	$('#organization_table').hide();
	$('#subscriptionLayoutBody').addClass('hidden');
	$('#distributorManagement').addClass('hidden');
	$("#distributorManagement").parent().addClass('hidden');
	$('.pageContainer').hide();
	$("ul[id='hideForIndex']").removeClass('hidden');
	$('#search1').removeClass('hidden');
	$('.bredcrum').removeClass('hidden');
	hideMicrosite();
	$('#transactionHistory').addClass('hidden');
	if(moveToTop!=true)
		$('html, body').animate({ scrollTop: 0 }, 'slow');
	
}
function createCatalogueDataRequest(fields,variables,flag){	
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	$('#catalogueItems').html("<h4 class='margintop20 text-center' style='background: url(\"/iDH/dashboard/images/iHUBLoader.gif\") no-repeat scroll 50% 27%;height:100px'></h4>");
	$("div[id='div437']").remove();
	if($('#app_seq_no').length==0)
		app_seq_no="";
	else
		app_seq_no=$('#app_seq_no').val();
	if($('#txtDistributorId').length==0)
		txtdistributerId="";
	else
		txtdistributerId=$('#txtDistributorId').val();
	if( $('#app_seq_no').length>0 && $('#txtUsrRole').val().toLowerCase()=="distributor"){
		txtdistributerId=$('#txtDistributorId').val();
	}
	if($('#txtloginType').length==0)
		txtloginType="";
	else
		txtloginType=$('#txtloginType').val();
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	var distributorDisplay="";
	if(typeOfProductsForDistributor!=undefined && typeOfProductsForDistributor!=""){
		if(typeOfProductsForDistributor.toLowerCase()=="parent"){
			distributorDisplay="true";
		}
	}
	if($.trim(distributorDisplay)==""){
		distributorDisplay=$.trim(store.get('typeOfProductsForDistributor'))=="" ? "" : (store.get('typeOfProductsForDistributor').toLowerCase()=="parent" ? "true" : "false");
	}
	recordsPerPage="6";
	if($('#recordsPerPage').val()!=undefined && !isNaN($('#recordsPerPage').val()) && $('#recordsPerPage').val()!=""){
		if(Number($('#recordsPerPage').val())>=1 && Number($('#recordsPerPage').val())<=50)
			recordsPerPage=$('#recordsPerPage').val();
	}
	if(currentPageOfcatalogue==undefined || currentPageOfcatalogue=="" || currentPageOfcatalogue=="undefined" || isNaN(currentPageOfcatalogue))
		pageNo="1";
	else
		pageNo=currentPageOfcatalogue;
	if(!(fields.indexOf('view')>-1)){
		fields="view@~@schedule@~@"+fields;
		variables="catalogue@~@none@~@"+variables;
	}
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	
	if($.trim($('#CatalogueContent').html())==""){
		var extraPart = ('open#'+instanceId+"@IID@Home/Catalogue=redirectTo~@~field="+fields+"&subAction=createCatalogue&variable="+variables+"&pageNo="+pageNo.replace(/ /g, '+')).replace(/\//g,'%2F');
		var sharelink=window.location.protocol+"//"+window.location.host+returnRouteLink("/iDH/Products")+"/view/catalogue";
		if($.trim(fields)!="" && $.trim(variables)!="" && fields.split('@~@').length==variables.split('@~@').length){
			for(var i=0;i<fields.split('@~@').length;i++){	
				
				sharelink+="/"+fields.split('@~@')[i]+"/"+variables.split('@~@')[i];
			}
		}
		sharelink+="/pageNo/"+pageNo;
		console.log(sharelink);
		if($('#share_link').length>0){
			$('#share_link').val(sharelink);
		}
		else{
			$('body').append('<input type="hidden" id="share_link" name="share_link" value="'+sharelink+'" autocomplete="off">');
		}
		if($('#ProductHiddenField').length > 0){
			$('#ProductHiddenField a').attr('href',returnRouteLink("/iDH/Products")+"/"+extraPart);
			document.getElementById('ProductHiddenField').firstElementChild.click();
			return false;
		}
	}
	
	if(!(flag==true && variables.split('@~@')[0].toLowerCase()=="list" && pageNo!="1")){
		var sharelink=window.location.protocol+"//"+window.location.host+returnRouteLink("/iDH/Products")+"/view/catalogue";
		if($.trim(fields)!="" && $.trim(variables)!="" && fields.split('@~@').length==variables.split('@~@').length){
			for(var i=0;i<fields.split('@~@').length;i++){	
				
				sharelink+="/"+fields.split('@~@')[i]+"/"+variables.split('@~@')[i];
			}
		}
		sharelink+="/pageNo/"+pageNo;
		console.log(sharelink);
		if($('#share_link').length>0){
			$('#share_link').val(sharelink);
		}
		else{
			$('body').append('<input type="hidden" id="share_link" name="share_link" value="'+sharelink+'" autocomplete="off">');
		}
		if(catalogueCheck){
			catalogueCheck=false;
			languageId=$.trim(languageId)==""?"1":languageId;
			$.ajax({
				type: "POST",
				url: url,
				data: {
					orgID:orgID,
					masterform_id:masterform_id,
					app_seq_no:app_seq_no,
					txtdistributerId:txtdistributerId,
					txtloginType:txtloginType,
					sessChk:sessChk,
					txtInstanceId:instanceId,
					variable:variables,
					field:fields,
					recordsPerPage:recordsPerPage,
					pageNo:pageNo,
					languageId:languageId,
					distributorDisplay:distributorDisplay,
					subAction:"createCatalogue"
				},
				dataType: "json",
				success: function(result){
					var condn=iHUB.checkSessionOrToken(result);
					if(eval(condn)){
						hideMicrosite();
						currentPageOfcatalogue="";
						if(fields.split('@~@').indexOf('txtItemPrice')>-1)
							createNewRange=false;
						else
							createNewRange=true;
						if(!(variables.split('@~@')[0].indexOf('modal')>-1)){
							var hash = decodeURIComponent(location.href);
							if(hash.indexOf('Products/view')>-1){
								
							}	
							else{
								createHashString=instanceId+"@IID@Home/Catalogue=redirectTo~@~field="+fields+"&subAction=createCatalogue&variable="+variables+"&pageNo="+pageNo;
								setLinkHash(createHashString);
							}
						}
						var checkCatalogueType = checkIfRedirectToCustom(fields,variables);
						if (typeof createCustomCataloguePage == 'function'){
							if(checkCatalogueType)
								createCustomCataloguePage(result);
							else
								createCataloguePage(result);
						}					
						else				
							createCataloguePage(result);
					}
				},
				error: function(x, e){
					if(e=="parsererror" && x.responseText=="session is not avaliable"){
						$('#toaster').html('');
						iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34'));   /* session expired, relogin to continue */
						createLoginLoader();
						fnLogoutICMP('1');
						return false;
					}
				},
				complete: function(){
					catalogueCheck=true;
					if(typeof lazyImageLoad == 'function')
						lazyImageLoad('CatalogueContent');
					applyvEllipsis();
					$('#IndexContent').addClass('hidden');
					fireResize();
					hideLoader_iDH();
					miniCart();
				}
			});
		}
	}
	else{
		currentPageOfcatalogue="";
		catalogueCheck=true;
	}
}
function micrositeCatalogueRequest(fields,variables,recordCount,caller){
	if(fields!=null && fields!=undefined && variables!=undefined && variables!=null && recordCount!=null && recordCount!=undefined && recordCount!=""){
		var url=iHUB.url.iDH();/* iHUB.url.get(); */
		if($('#app_seq_no').length==0)
			app_seq_no="";
		else
			app_seq_no=$('#app_seq_no').val();
		if($('#txtDistributorId').length==0)/* added for jobs CR */
			txtdistributerId="";
		else
			txtdistributerId=$('#txtDistributorId').val();/* added for jobs CR */
		if( $('#app_seq_no').length>0 && $('#txtUsrRole').val().toLowerCase()=="distributor"){
			txtdistributerId=$('#txtDistributorId').val();/* added for jobs CR */
		}
		if($('#txtloginType').length==0)
			txtloginType="";
		else
			txtloginType=$('#txtloginType').val();
		if($('#sessChk').length==0)
			sessChk="";
		else
			sessChk=$('#sessChk').val();
		recordsPerPage="6";
		recordsPerPage=recordCount;
		if($('#recordsPerPage').val()!=undefined && !isNaN($('#recordsPerPage').val()) && $('#recordsPerPage').val()!=""){
			if(Number($('#recordsPerPage').val())>=1 && Number($('#recordsPerPage').val())<=50)
				recordsPerPage=$('#recordsPerPage').val();
		}
		if(currentPageOfcatalogue==undefined || currentPageOfcatalogue=="" || currentPageOfcatalogue=="undefined" || isNaN(currentPageOfcatalogue))
			pageNo="1";
		else
			pageNo=currentPageOfcatalogue;
		if(!(fields.indexOf('view')>-1)){
			fields="view@~@schedule@~@"+fields;
			variables="catalogue@~@none@~@"+variables;
		}	
		languageId=$.trim(languageId)==""?"1":languageId;
		if($.trim(masterform_id)=="")
			masterform_id=$('#userFormId').val();
		$.ajax({
			type: "POST",
			url: url,
			data: {
				orgID:orgID,
				masterform_id:masterform_id,
				app_seq_no:app_seq_no,
				txtdistributerId:txtdistributerId,
				txtloginType:txtloginType,
				sessChk:sessChk,
				txtInstanceId:instanceId,
				variable:variables,
				field:fields,
				recordsPerPage:recordsPerPage,
				pageNo:pageNo,
				languageId:languageId,
				subAction:"createCatalogue"
			},
			dataType: "json",
			success: function(result){
				var condn=iHUB.checkSessionOrToken(result);
				if(eval(condn)){
					if(caller==undefined){
						if($('#myRequestMicrosite').length>0){
							document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"micrositeCatalogueRequestResponse",result:result,groupID:groupID,orgID:orgID,txtUsrRole:$('#txtUsrRole').val()}], "*");
						}
						else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
							if(result!=undefined){
								if (typeof customMicrositeCatalogueRequestResponseHandler == 'function')  
									customMicrositeCatalogueRequestResponseHandler(result);
								else
									micrositeCatalogueRequestResponseHandler(result);
							}
						}
					}
					else if(caller=='JobMicrosite'){
						micrositeCatalogueRequestResponseHandlerForJobMicrosite(result);
					}
					
				}
			},
			error: function(x, e){
			 if(e=="parsererror" && x.responseText=="session is not avaliable"){
					$('#toaster').html('');
					iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
					createLoginLoader();
					fnLogoutICMP('1');
					return false;
				}
			},
			complete: function(){
				fireResize();
				hideLoader_iDH();
				miniCart();
			}
		});	
	}
}
function createCatalogueDataRequestForProductIds(productIds){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#app_seq_no').length==0)
		app_seq_no="";
	else
		app_seq_no=$('#app_seq_no').val();
	if($('#txtDistributorId').length==0)
		txtdistributerId="";
	else
		txtdistributerId=$('#txtDistributorId').val();
	if($('#txtloginType').length==0)
		txtloginType="";
	else
		txtloginType=$('#txtloginType').val();
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	languageId=$.trim(languageId)==""?"1":languageId;
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({ 
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			app_seq_no:app_seq_no,
			txtdistributerId:txtdistributerId,
			txtloginType:txtloginType,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			languageId:languageId,
			productId:productIds,
			subAction:"getListofproductDetails"
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				/*createHashString=instanceId+"@IID@Home/Catalogue=redirectTo~@~productIds="+productIds+"&subAction=getListofproductDetails";
				setLinkHash(createHashString);*/
				if (typeof createCustomCataloguePage == 'function')  
					createCustomCataloguePage(result);
				else				
					createCataloguePage(result);
				hideLoader_iDH();
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		}
	});
}
function fetchChildProducts(parentProductId,fields,variables){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#app_seq_no').length==0)
		app_seq_no="";
	else
		app_seq_no=$('#app_seq_no').val();
	if($('#txtDistributorId').length==0)/* added for jobs CR */
		txtdistributerId="";
	else
		txtdistributerId=$('#txtDistributorId').val();/* added for jobs CR */
	if($('#txtloginType').length==0)
		txtloginType="";
	else
		txtloginType=$('#txtloginType').val();
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	languageId=$.trim(languageId)==""?"1":languageId;
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({ 
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			app_seq_no:app_seq_no,
			txtdistributerId:txtdistributerId,
			txtloginType:txtloginType,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			languageId:languageId,
			productId:parentProductId,
			variable:variables==undefined ? "" : variables,
			field:fields==undefined ? "" : fields,
			subAction:"fetchChildProducts"
		},
		dataType: "json",
		/* async:false, */
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("fetchChildProductsForMicrositeResponse@~@"+JSON.stringify(result),"*");
				}
				else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					if(result!=undefined){
						if (typeof createCustomFetchChildProductsList == 'function'){
							createCustomFetchChildProductsList(result);
						}else{
							createFetchChildProductsList(result);
						}
					}
				}
				hideLoader_iDH();
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}		
		}
	});
}
function fetchSimilarProductsForMicrosite(parentProductId,fields,variables){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#app_seq_no').length==0)
		app_seq_no="";
	else
		app_seq_no=$('#app_seq_no').val();
	if($('#txtDistributorId').length==0)/* added for jobs CR */
		txtdistributerId="";
	else
		txtdistributerId=$('#txtDistributorId').val();/* added for jobs CR */
	if($('#txtloginType').length==0)
		txtloginType="";
	else
		txtloginType=$('#txtloginType').val();
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	languageId=$.trim(languageId)==""?"1":languageId;
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({ 
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			app_seq_no:app_seq_no,
			txtdistributerId:txtdistributerId,
			txtloginType:txtloginType,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			languageId:languageId,
			productId:parentProductId,
			variable:variables,
			field:fields,
			subAction:"getSimilarProducts"
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("fetchSimilarProductsForMicrositeResponse@~@"+JSON.stringify(result),"*");
				}else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					if(JSON.stringify(result)!="" || JSON.stringify(result)!=null){
						if (typeof createCustomSimilarProductsList == 'function'){
							createCustomSimilarProductsList(JSON.stringify(result));
						}else{
							createSimilarProductsList(JSON.stringify(result));
						}
					}
				}
				hideLoader_iDH();
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}		
		}
	});
}
function fetchProductsTaggedToDistributor(distributorId,recordCount){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#app_seq_no').length==0)
		app_seq_no="";
	else
		app_seq_no=$('#app_seq_no').val();
	if($('#txtloginType').length==0)
		txtloginType="";
	else
		txtloginType=$('#txtloginType').val();
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	var recordsPerPage="10";
	if(recordCount!=undefined && !isNaN(recordCount) && recordCount!=""){
		if(Number(recordCount)>=1 && Number(recordCount)<=50)
			recordsPerPage=recordCount;
	}
	languageId=$.trim(languageId)==""?"1":languageId;
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();	
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			app_seq_no:app_seq_no,
			txtdistributerId:distributorId,
			txtloginType:txtloginType,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			variable:"catalogue@~@none@~@yes",
			field:"view@~@schedule@~@isAssigned",
			recordsPerPage:recordsPerPage,
			pageNo:1,
			languageId:languageId,
			subAction:"createCatalogue"
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"fetchProductsTaggedToDistributorResponse"},{result:JSON.stringify(result)}], "*");
				}
				else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					if (typeof customRefundCheckResponse == 'function')  
						customFetchProductsTaggedToDistributorResponse(JSON.stringify(result));
					else
						fetchProductsTaggedToDistributorResponse(JSON.stringify(result));
				}
			}
		},
		error: function(x, e){
		 if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		},
		complete: function(){
			fireResize();
			hideLoader_iDH();
			miniCart();
		}
	});	
}
function showRefundInformation(productId){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	languageId=$.trim(languageId)==""?"1":languageId;
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			languageId:languageId,
			productId:productId,
			subAction:"getListofproductDetails"
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"showRefundInformationResponse"},{result:JSON.stringify(result)}], "*");
				}
				else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					if (typeof customRefundCheckResponse == 'function')  
						customShowRefundInformationResponse(JSON.stringify(result));
					else
						showRefundInformationResponse(JSON.stringify(result));
				}
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		}
	});
}
function fetchProductsTaggedToPublisher(publisherId,recordCount){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#app_seq_no').length==0)
		app_seq_no="";
	else
		app_seq_no=$('#app_seq_no').val();
	if($('#txtloginType').length==0)
		txtloginType="";
	else
		txtloginType=$('#txtloginType').val();
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	languageId=$.trim(languageId)==""?"1":languageId;
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	var recordsPerPage="10";
	if(recordCount!=undefined && !isNaN(recordCount) && recordCount!=""){
		if(Number(recordCount)>=1 && Number(recordCount)<=50)
			recordsPerPage=recordCount;
	}	
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			app_seq_no:app_seq_no,
			txtloginType:txtloginType,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			variable:"catalogue@~@none@~@"+publisherId,
			field:"view@~@schedule@~@txtOrgId",
			recordsPerPage:recordsPerPage,
			pageNo:1,
			languageId:languageId,
			subAction:"createCatalogue"
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"fetchProductsTaggedToPublisherResponse"},{result:JSON.stringify(result)}], "*");
				}
				else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					if (typeof customRefundCheckResponse == 'function')  
						customFetchProductsTaggedToPublisherResponse(JSON.stringify(result));
					else
						fetchProductsTaggedToPublisherResponse(JSON.stringify(result));
				}
			}
		},
		error: function(x, e){
		 if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		},
		complete: function(){
			fireResize();
			hideLoader_iDH();
			miniCart();
		}
	});	
}
function filterSearch(modalFields,modalVariables){//on refreshing publisher mode products are visible...has to be handled.
	checkForCollapseAll();
	showLoader();
	var fields="",variables="";
	var txtSearchText="",scheduleAppended=false;
	currentView="catalogue";
	var searchText=$('.searchfontawesome').map(function(){ return $(this).siblings('input').length==0 ? ($(this).parent().siblings('input').length==0 ? "" : $(this).parent().siblings('input').val()) : $(this).siblings('input').val() }).toArray().join().replace(/,/g,"");
	if(searchText!=""){
		txtSearchText=$.trim(searchText.replace(/</g, "").replace(/>/g, "").replace(/'/g, "").replace(/"/g, "").replace(/\\/g, '').replace(/\//g, '').replace(/%/g, ''));
	}
	else{
		$('.yourSearch').each(function(){
			if($(this).children('span[data-filtered="txtSearchText"]').length > 0){
				txtSearchText=$.trim($('.yourSearch:first').children('span[data-filtered="txtSearchText"]').text().replace(/</g, "").replace(/>/g, "").replace(/'/g, "").replace(/"/g, "").replace(/\\/g, '').replace(/\//g, '').replace(/%/g, ''));
			}
		});
	}
	$('.dropdown-menu-right.searchdropdown li a').each(function(){
		if($(this).hasClass('currSelected')){
			$('[data-level="txtLevel1"][value="'+$(this).attr('value')+'"][type="checkbox"]').prop('checked', true);
		}		
	});
	$('.dropdown-menu-right.searchdropdown li a').removeClass('currSelected');
	$('.searchfontawesome').each(function(){
		$(this).siblings('input').length==0 ? ($(this).parent().siblings('input').length==0 ? "" : $(this).parent().siblings('input').val('')) : $(this).siblings('input').val('');
	});
	if(filterSearchFlag==true){
		$('.diffviews li').each(function(){
			if($(this).hasClass('active')){
				currentView=$(this).children().attr('aria-controls').split('view')[0];
				if($('#openSchedule').find('.schedule-filter li').hasClass('active') && currentView!="catalogue"){
					var currSchName=$('#openSchedule').find('.schedule-filter li.active').attr('data-search').toLowerCase();
					if((currSchName=="upcoming schedules" || currSchName=="this week" || currSchName=="custom") && !showCalenderView)
						currentView="list";
				}
				if(fields==""){
					fields=fields.concat("view");
					variables=variables.concat(currentView);
				}
				else{
					fields=fields.concat("@~@"+"view");
					variables=variables.concat("@~@"+currentView);
				}			
			}
		});
		if(currentView.toLowerCase()=="calender"){
			$('#txtItemScheduledStartDate').val('');
			$('#txtItemScheduledEndDate').val('');
		}
		else{
			if($('#txtItemScheduledStartDate').length>0 || $('#txtItemScheduledEndDate').length>0){
				var txtItemScheduledStartDate=$('#txtItemScheduledStartDate').length>0 ? $('#txtItemScheduledStartDate').val() : "";
				var txtItemScheduledEndDate=$('#txtItemScheduledEndDate').length>0 ? $('#txtItemScheduledEndDate').val() : "";
				if(txtItemScheduledStartDate.length>0 && txtItemScheduledStartDate!='DD/MM/YYYY' && txtItemScheduledEndDate.length>0 && txtItemScheduledEndDate!='DD/MM/YYYY'){
					if(fields==""){
						fields=fields.concat("schedule");
						variables=variables.concat("dateRange:"+txtItemScheduledStartDate+":"+txtItemScheduledEndDate);
					}
					else{
						fields=fields.concat("@~@schedule");
						variables=variables.concat("@~@dateRange:"+txtItemScheduledStartDate+":"+txtItemScheduledEndDate);
					}
					$('.schedule-filter li').removeClass('active');
					scheduleAppended=true;
				}
				else if(txtItemScheduledStartDate.length>0 && txtItemScheduledStartDate!='DD/MM/YYYY'){ 
					if(fields==""){
						fields=fields.concat("schedule");
						variables=variables.concat("date:"+txtItemScheduledStartDate);
					}
					else{
						fields=fields.concat("@~@schedule");
						variables=variables.concat("@~@date:"+txtItemScheduledStartDate);
					}
					$('.schedule-filter li').removeClass('active');
					scheduleAppended=true;
				}
				else if(txtItemScheduledEndDate.length>0 && txtItemScheduledEndDate!='DD/MM/YYYY'){
					$('#txtItemScheduledEndDate').val('');
					$('#toaster').html('');
					iHUB.toaster.redMessageToaster(multilingualKeyValue('30','34'));/* Please select Start Date */
					$('.schedule-filter li').removeClass('active');
					scheduleAppended=true;
					return false;
				}
			}
		}
		if(!$('#openSchedule').find('.schedule-filter li').hasClass('active') && !scheduleAppended){
			var schedule="none",appendString="List",defaultBothView="none",defaultCustomHiddenValue="";
			if(currentView=="catalogue")
				schedule="none";
			else if(currentView=="list"){
				appendString="List";
				if($('#customDefaultViewList').val()!=undefined && $('#customDefaultViewList').val()!="")
					defaultCustomHiddenValue=$('#customDefaultViewList').val().toLowerCase();
				else
					defaultBothView="upcomingSchedule"
			}				
			else if(currentView=="calender"){
				appendString="Calender";
				if($('#customDefaultViewCalender').val()!=undefined && $('#customDefaultViewCalender').val()!="")
					defaultCustomHiddenValue=$('#customDefaultViewCalender').val().toLowerCase();
				else
					defaultBothView="monthCalender:"+getToday("month")+"-"+getToday("year");
			}
			if(defaultCustomHiddenValue!=undefined && defaultCustomHiddenValue!=""){
				var defaultView=defaultCustomHiddenValue;
				if(defaultView=="month")
					schedule="month"+appendString+":"+getToday("month")+"-"+getToday("year");
				else if(defaultView=="week")
					schedule="week"+appendString+":"+(getToday("week")-1)+"-"+getToday("year");
				else if(defaultView=="year")
					schedule="year"+appendString+":"+getToday("year");
				else
					schedule=defaultBothView;
			}
			else
				schedule=defaultBothView;		
			if(fields==""){
				fields=fields.concat("schedule");
				variables=variables.concat(schedule);
			}
			else{
				fields=fields.concat("@~@"+"schedule");
				variables=variables.concat("@~@"+schedule);
			}
		}
		else if(!scheduleAppended){
			$('#openSchedule').find('.schedule-filter').children().each(function(){
				var presentScheduleFilter=$('.calgrid-heading .title').attr('data-search');
				log("presentScheduleFilter.."+presentScheduleFilter);
				if($(this).hasClass('active')){
					var scheduleText=$(this).attr('data-search').toLowerCase();
					var scheduleSelected="";
					var scheduleCurrent="",date="";
					var appendString="List";
					if(currentView=="calender"){
						appendString="Calender";
						if(scheduleText=="upcoming schedules" || scheduleText=="this week" || scheduleText=="custom")
							scheduleText="this month";
					}
					if(scheduleText=="custom" && !checkFromMinJs){
						var pickerVariable = $('.custom_datetime').find('.datetimepicker').length > 0 ? '.datetimepicker' : '.datepicker';
						$('.custom_datetime').find(pickerVariable).children().each(function(){
							if($(this).attr('style').indexOf('block')>-1){
								var openView=$(this).attr('class').split('-')[1];
								if(openView=='days'){
									scheduleText="custom";
									date=$('.custom_datetime').find(pickerVariable).find('td.day.active').text()+"/"+(monthArray.indexOf($('.custom_datetime').find(pickerVariable).find('.'+$(this).attr('class')).find('.picker-switch').text().split(' ')[0])+1)+"/"+$('.custom_datetime').find(pickerVariable).find('.'+$(this).attr('class')).find('.picker-switch').text().split(' ')[1];
								}
								else if(openView=='months'){
									scheduleText="this month";
									scheduleSelected = "month"+appendString+":"+(monthArraySmall.indexOf($('.custom_datetime').find(pickerVariable).find('.month.active').text())+1)+"-"+$('.custom_datetime').find(pickerVariable).find('.'+$(this).attr('class')).find('.picker-switch').text();
								}
								else if(openView=='years'){
									scheduleText="this year";
									scheduleSelected = "year"+appendString+":"+$('.year.active').text();
								}
							}
						});
					}				
					switch (scheduleText) {
						case 'upcoming schedules':
							scheduleSelected = "upcomingSchedule";
							scheduleCurrent = "upcomingSchedule";
							break;
						case 'this week':
							var splitWeek=presentScheduleFilter.split(' of ');
							scheduleSelected = "week"+appendString+":"+(splitWeek[0].replace('week ','')-1)+"-"+splitWeek[1];
							scheduleCurrent = "week"+appendString+":"+(getToday("week")-1)+"-"+getToday("year");
							break;
						case 'this month':
							if(scheduleSelected=="")
								scheduleSelected = "month"+appendString+":"+(monthArray.indexOf($.trim(presentScheduleFilter).split(' ')[0])+1)+"-"+$.trim(presentScheduleFilter).split(' ')[1];
							scheduleCurrent = "month"+appendString+":"+getToday("month")+"-"+getToday("year");
							break;
						case 'this year':
							if(scheduleSelected=="")
								scheduleSelected = "year"+appendString+":"+presentScheduleFilter;
							scheduleCurrent = "year"+appendString+":"+getToday("year");
							break;
						case 'custom':
							/* Thursday 1 December, 2016 */	
							if(date=="")
								date=$.trim(presentScheduleFilter).split(' ')[1]+"/"+(monthArray.indexOf($.trim(presentScheduleFilter).split(' ')[2].split(',')[0])+1)+"/"+$.trim(presentScheduleFilter).split(' ')[3];
							scheduleSelected = "date:"+date;
							scheduleCurrent = "date:"+date;
							break;				
					}
					var schedule=scheduleSelected;
					if(isCurrentSchedule)
						schedule=scheduleCurrent;
					if(fields==""){
						fields=fields.concat("schedule");
						variables=variables.concat(schedule);
					}
					else{
						fields=fields.concat("@~@"+"schedule");
						variables=variables.concat("@~@"+schedule);
					}			
				}
			});
		}
	}
	if(txtSearchText!=""){
		if(fields==""){
			fields=fields.concat("txtSearchText");
			variables=variables.concat(txtSearchText);
		}
		else{
			fields=fields.concat("@~@"+"txtSearchText");
			variables=variables.concat("@~@"+txtSearchText);
		}
	}
	if(itemTags!="" && itemTags!=undefined){
		if(fields==""){
			fields=fields.concat("txtItemTags");
			variables=variables.concat(itemTags);
		}
		else{
			fields=fields.concat("@~@txtItemTags");
			variables=variables.concat("@~@"+itemTags);
		}
	}
	if($("[data-id='txtLevels']").length>0){
		var txtLevels = [];
		$('input:checkbox[data-id="txtLevels"]:checked').each(function() {
			if($.trim($(this).attr('data-level'))=="txtLevel1"){
				myfield=$.trim($(this).attr('data-level'));
				if(!isNaN($(this).val())){
					txtLevels.push($(this).val());
				}
			}
		});
		if(txtLevels.length>0){
			if(fields==""){
				fields=fields.concat(myfield);
				variables=variables.concat(txtLevels);
			}
			else{
				fields=fields.concat("@~@"+myfield);
				variables=variables.concat("@~@"+txtLevels);
			}
		}
	}
	if($("[data-id='txtLevels']").length>0){
		var txtLevels = [];
		$('input:checkbox[data-id="txtLevels"]:checked').each(function() {
			if($.trim($(this).attr('data-level'))=="txtLevel2"){
				myfield=$.trim($(this).attr('data-level'));
				if(!isNaN($(this).val())){
					txtLevels.push($(this).val());
				}
			}
		});
		if(txtLevels.length>0){
			if(fields==""){
				fields=fields.concat(myfield);
				variables=variables.concat(txtLevels);
			}
			else{
				fields=fields.concat("@~@"+myfield);
				variables=variables.concat("@~@"+txtLevels);
			}
		}
	}
	if($("[data-id='txtLevels']").length>0){
		var txtLevels = [];
		$('input:checkbox[data-id="txtLevels"]:checked').each(function() {
			if($.trim($(this).attr('data-level'))=="txtLevel3"){
				myfield=$.trim($(this).attr('data-level'));
				if(!isNaN($(this).val())){
					txtLevels.push($(this).val());
				}
			}

		});
		if(txtLevels.length>0){
			if(fields==""){
				fields=fields.concat(myfield);
				variables=variables.concat(txtLevels);
			}
			else{
				fields=fields.concat("@~@"+myfield);
				variables=variables.concat("@~@"+txtLevels);
			}
		}
	}
	if($("[data-id='txtLevels']").length>0){
		var txtLevels = [];
		$('input:checkbox[data-id="txtLevels"]:checked').each(function() {
			if($.trim($(this).attr('data-level'))=="txtLevel4"){
				myfield=$.trim($(this).attr('data-level'));
				if(!isNaN($(this).val())){
					txtLevels.push($(this).val());
				}
			}
		});
		if(txtLevels.length>0){
			if(fields==""){
				fields=fields.concat(myfield);
				variables=variables.concat(txtLevels);
			}
			else{
				fields=fields.concat("@~@"+myfield);
				variables=variables.concat("@~@"+txtLevels);
			}
		}
	}
	if(filterSearchFlag==true){
		if($("[data-id='txtProductCreationType']").length>0){
			var txtLevels = [];
			$('input:checkbox[data-id="txtProductCreationType"]:checked').each(function() {
				txtLevels.push($.trim($(this).attr('data-typeId')));
			});
			if(txtLevels.length>0){
				if(fields==""){
					fields=fields.concat("txtProductCreationType");
					variables=variables.concat(txtLevels);
				}
				else{
					fields=fields.concat("@~@"+"txtProductCreationType");
					variables=variables.concat("@~@"+txtLevels);
				}
			}
		}
	}
	if($("[data-id='txtOrgId']").length>0){
		var txtOrgIds = [];
		$('input:checkbox[data-id="txtOrgId"]:checked').each(function() {
			txtOrgIds.push($.trim($(this).attr('data-txtOrgId')));
		});
		if(txtOrgIds.length>0){
			if(fields==""){
				fields=fields.concat("txtOrgId");
				variables=variables.concat(txtOrgIds);
			}
			else{
				fields=fields.concat("@~@"+"txtOrgId");
				variables=variables.concat("@~@"+txtOrgIds);
			}
		}
	}
	if($('#txtItemPurchaseType').length>0){
		var txtItemPurchaseType;
		$('input:radio[id="txtItemPurchaseType"]:checked').each(function() {
			txtItemPurchaseType=$.trim($(this).attr('data-search'));
		});
		if(txtItemPurchaseType!="" && txtItemPurchaseType!=undefined){
			if(fields==""){
				fields=fields.concat("txtItemPurchaseType");
				variables=variables.concat(txtItemPurchaseType);
			}
			else{
				fields=fields.concat("@~@txtItemPurchaseType");
				variables=variables.concat("@~@"+txtItemPurchaseType.toString());
			}
			if($("[data-id='txtItemPrice']").length>0 && txtItemPurchaseType.toLowerCase()=="paid"){
				var txtItemPrice = [];
				$('input:checkbox[data-id="txtItemPrice"]:checked').each(function(){
					txtItemPrice.push($.trim($(this).attr('data-txtItemPrice')));
				});
				if(txtItemPrice.length>0){
					if(fields==""){
						fields=fields.concat("txtItemPrice");
						variables=variables.concat(txtItemPrice);
					}
					else{
						fields=fields.concat("@~@txtItemPrice");
						variables=variables.concat("@~@"+txtItemPrice);
					}
				}				
			}		
		}
	}
	if($('#IsRecommendedByiON').length>0){
		var IsRecommendedByiON = $('#IsRecommendedByiON').val();
		if(IsRecommendedByiON.length>0){
			if(fields==""){
				fields=fields.concat("IsRecommendedByiON");
				variables=variables.concat(IsRecommendedByiON);
			}
			else{
				fields=fields.concat("@~@IsRecommendedByiON");
				variables=variables.concat("@~@"+IsRecommendedByiON);
			}
		}
	}
	if($('#txtInstructorName').length>0){
		var txtInstructorName=[];
		$('input:checkbox[id="txtInstructorName"]:checked').each(function() {
			txtInstructorName.push($.trim($(this).parent().text()));
		});
		if(txtInstructorName.length>0){
			if(fields==""){
				fields=fields.concat("txtInstructorName");
				variables=variables.concat(txtInstructorName);
			}
			else{
				fields=fields.concat("@~@txtInstructorName");
				variables=variables.concat("@~@"+txtInstructorName.toString());
			}
		}
	}
	if($('#distributorDisplay').length>0){
		var distributorDisplay=[];
		if($('#distributorDisplay').val().toLowerCase()=="true") {
			distributorDisplay.push("true");
		}
		else{
			distributorDisplay.push("false");
		}
		if(distributorDisplay.length>0){
			if(fields==""){
				fields=fields.concat("distributorDisplay");
				variables=variables.concat(distributorDisplay);
			}
			else{
				fields=fields.concat("@~@distributorDisplay");
				variables=variables.concat("@~@"+distributorDisplay.toString());
			}
		}
	}
	if($('#minDiscount').length>0 && $('#maxDiscount').length>0){
		var txtDiscountPercentage = $('#minDiscount').val()+":"+$('#maxDiscount').val();
		if(txtDiscountPercentage.length>0){
			if(fields==""){
				fields=fields.concat("txtDiscountPercentage");
				variables=variables.concat(txtDiscountPercentage);
			}
			else{
				fields=fields.concat("@~@txtDiscountPercentage");
				variables=variables.concat("@~@"+txtDiscountPercentage);
			}
		}
	}
	if($('#minDuration').length>0 && $('#maxDuration').length>0){
		var txtItemDuration = $('#minDuration').val()+":"+$('#maxDuration').val();
		if(txtItemDuration.length>0){
			if(fields==""){
				fields=fields.concat("txtItemDuration");
				variables=variables.concat(txtItemDuration);
			}
			else{
				fields=fields.concat("@~@txtItemDuration");
				variables=variables.concat("@~@"+txtItemDuration);
			}
		}
	}
	if(filterSearchFlag==true){
		if($('#txtorderby').length>0){
			var txtorderby=[];
			if($('input:radio[id="txtorderby"]:checked').length < 1){
				$('input:radio[id="txtorderby"][data-id="Popular"]').prop('checked', true);
			}
			$('input:radio[id="txtorderby"]:checked').each(function() {
				if($.trim($(this).attr('data-id'))=="Popular" || $.trim($(this).attr('data-id'))=="Latest")
					txtorderby.push($.trim($(this).attr('data-id'))+"Down");
				else
					txtorderby.push($.trim($(this).attr('data-id'))+"Up");
			});
			if(txtorderby.length == 0)
				txtorderby.push("PopularDown");
			if(txtorderby.length>0){
				if(fields==""){
					fields=fields.concat("txtorderby");
					variables=variables.concat(txtorderby);
				}
				else{
					fields=fields.concat("@~@txtorderby");
					variables=variables.concat("@~@"+txtorderby);
				}
			}
		}
		if($('#txtUsrRole').length>0){
			if($('#txtUsrRole').val().toLowerCase()=="distributor"){
				if($('.disAssigned').parent().hasClass('active')){
					var disAssigned="";
					$('.disAssigned').each(function() {
						if($(this).parent().hasClass('active')) {
							disAssigned=$(this).attr('data-search');
						}
					});
					if(disAssigned!=""){
						if(fields==""){
							fields=fields.concat("isAssigned");
							variables=variables.concat(disAssigned);
						}
						else{
							fields=fields.concat("@~@isAssigned");
							variables=variables.concat("@~@"+disAssigned);
						}
					}
				}
				else{
					var distributorCatalogue=$.trim(store.get('distributorCatalogue'))=="" ? "yes" : ($.trim(store.get('distributorCatalogue')).toLowerCase()=="unassigned" ? "no" : ($.trim(store.get('distributorCatalogue')).toLowerCase()=="assigned" ? "yes" : $.trim(store.get('distributorCatalogue')).toLowerCase()));
					if(fields==""){
						fields=fields.concat("isAssigned");
						variables=variables.concat(distributorCatalogue);
					}
					else{
						fields=fields.concat("@~@isAssigned");
						variables=variables.concat("@~@"+distributorCatalogue);
					}
				}
			}
		}
		if(fields!=""){
			showLoader();
			createCatalogueDataRequest(fields,variables);
			createMySearchLabels(fields,variables);
		}
		else{
			showLoader();
			filterSearch();
			strSearch="<span data-a='31' data-b='All Products'>"+multilingualKeyValue('31','34')+"</span>";
			$('.clearAll').addClass('hidden');
			$('.yourSearch').append(strSearch);
			deleteMyFilter();
		}
	}
	else{
		if(fields!=""){
			fields=modalFields+"@~@"+fields;
			variables=modalVariables+"@~@"+variables;
		}
		else{
			fields=modalFields;
			variables=modalVariables;
		}
		createCatalogueDataRequest(fields,variables);
	}
	filterSearchFlag=true;
	hideLoader_iDH();
}

function recommendedProductsForMicrosite(productId){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#app_seq_no').length==0)
		app_seq_no="";
	else
		app_seq_no=$('#app_seq_no').val();
	if($('#txtDistributorId').length==0)/* added for jobs CR */
		txtdistributerId="";
	else
		txtdistributerId=$('#txtDistributorId').val();/* added for jobs CR */
	if($('#txtloginType').length==0)
		txtloginType="";
	else
		txtloginType=$('#txtloginType').val();
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	languageId=$.trim(languageId)==""?"1":languageId;
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({ 
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			app_seq_no:app_seq_no,
			txtdistributerId:txtdistributerId,
			txtloginType:txtloginType,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			languageId:languageId,
			productId:productId,
			subAction:"recommendedProductsForMicrosite"
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("recommendedProductsForMicrositeResponse@~@"+JSON.stringify(result),"*");
				}
				else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					if (typeof createCustomRecommendedProductsList == 'function'){ 
						createCustomRecommendedProductsList(JSON.stringify(result));
					}else{
						createRecommendedProductsList(JSON.stringify(result));
					}
				}
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		}
	}); 
}

function returnMyCurrencySymbol(currency1){
	/* if(currencyDetails==null || currencyDetails==undefined || $.trim(currencyDetails)=="")
		currencyDetails=getCurrencyDetails(); */
	/* Added for jobs CR */
	if(currencyDetails==null || currencyDetails==undefined || $.trim(currencyDetails)==""){
		currencyDetails={"1":{"crnsubunits":"100","crndecimaldigits":"2","crnid":"1","crnsubunitsymbol":"Ps.","crnshortname":"INR","crnsymbol":"&#8377;","crnname":"Rupee","crnsubunitname":"Paise"}};
	}
	/* Added for jobs CR */
	var isNumber=!isNaN(currency1);
	var currency="";
	if(isNumber){
		if(currencyDetails[""+currency1+""]!=undefined){
			currency=$.trim(currencyDetails[""+currency1+""].crnshortname);		
		}
	}
	else{
		currency=currency1;
	}
	var myDBString=["inr","rupee","dollar","eur","bitcoin","btc","cny","usd","eur","gbp","ils","inr","jpy","krw","money","rmb","rouble","rub","ruble","shekel","sheqel","try","turkish-lira","won","yen"];
	var bootstrapRespectiveText=["fa-rupee","fa-rupee","fa-dollar","fa-eur","fa-bitcoin","fa-btc","fa-cny","fa-usd","fa-euro","fa-gbp","fa-ils","fa-inr","fa-jpy","fa-krw","fa-money","fa-rmb","fa-rouble","fa-rub","fa-ruble","fa-shekel","fa-sheqel","fa-try","fa-turkish-lira","fa-won","fa-yen"];
	var tempCur=currency.toLowerCase();
	if(myDBString.indexOf(tempCur)!=-1){
		return bootstrapRespectiveText[myDBString.indexOf(tempCur)];
	}
	else
		return "";
}
function deleteMyFilter(){
	$('.dMF').on('click',function(){
		showLoader();
		var removefilter=$(this).parent().attr('data-filtered');
		if(removefilter=="txtItemScheduledStartDate"){
			$('#CatalogueContent').find('#txtItemScheduledStartDate').val('');
			filterSearch();
		}
		else if(removefilter=="txtItemScheduledEndDate"){
			$('#CatalogueContent').find('#txtItemScheduledEndDate').val('');
			filterSearch();
		}
		else if(removefilter=="txtItemPrice"){
			var values=$.trim($(this).parent().attr('data-value'));
			$('input:checkbox[data-id="txtItemPrice"]').each(function() {
				myfield=$.trim($(this).attr('data-txtitemprice'));
				if(values==myfield){
					$(this).prop('checked',false);
					filterSearch();
				}
			});
		}
		else if(removefilter=="txtItemPurchaseType"){
			$(".slider_range").fadeOut();
			$('input[id="txtItemPurchaseType"]').removeAttr('checked');
			$('input:radio[id="txtItemPurchaseType"]:checked').prop('checked', false);
			filterSearch();
		}
		else if(removefilter=="IsRecommendedByiON"){
			filterSearch();
		}
		else if(removefilter=="txtProductCreationType"){
			var myLevel=$(this).parent().attr('data-level');
			var myName=$(this).parent().attr('data-name');
			$('input:checkbox[data-id="txtProductCreationType"]').each(function() {
				myfield=$.trim($(this).attr('data-level'));
				if($.trim($(this).attr('data-level'))==myLevel && $.trim($(this).attr('data-typeId'))==myName){
					$(this).prop('checked',false);
					filterSearch();
				}
			});
		}
		else if(removefilter=="txtLevels"){
			var myLevel=$(this).parent().attr('data-level');
			var myName=$(this).parent().attr('data-name');
			$('input:checkbox[data-id="txtLevels"]').each(function() {
				myfield=$.trim($(this).attr('data-level'));
				if($.trim($(this).attr('data-level'))==myLevel && $.trim($(this).val())==myName){
					$(this).prop('checked',false);
					checkForExpandAndCollapse($(this));
					filterSearch();
				}
			});
		}
		else if(removefilter=="txtOrgId"){
			var myName=$(this).parent().attr('data-name');
			$('input:checkbox[data-id="txtOrgId"]').each(function() {
				if($.trim($(this).attr('data-txtorgid'))==myName){
					$(this).prop('checked',false);
					filterSearch();
				}
			});
		}
		else if(removefilter=="txtSearchText"){
			$('[data-filtered="txtSearchText"]').remove();
			$('.searchfontawesome').siblings().val('');
			filterSearch();
		}
		else if(removefilter=="txtItemTags"){
			itemTags="";
			filterSearch();
		}
		else if(removefilter=="ProductIdList"){
			if($('#txtUsrRole').val()=="Distributor"){
				filterSearch();
			}			
		}
		else if(removefilter=="schedule"){
			$('.schedule-filter li').removeClass('active');
			$('.diffviews li').removeClass('active');
			$('.diffviews li:nth-child(1)').addClass('active');
			filterSearch();	
		}
		else if(removefilter=="noScheduledDate"){
			$('.schedule-filter li').removeClass('active');
			filterSearch();	
		}
		$(this).parent().remove();
		hideLoader_iDH();
	});
}
function createMySearchLabels(fields,variables){
	var moveToTop=false;
	SetBreadCrumbCatalogue();
	var splitVariables=variables.split('@~@');
	var splitVariablesLength=splitVariables.length;
	var splitFields=fields.split('@~@');
	var splitFieldsLength=splitFields.length;
	$('.yourSearch span').remove();
	var strSearch="";
	var hiddenStrSearch="";
	if(splitVariablesLength==1 && splitFields.indexOf("ProductIdList")>-1)
		$('.clearAll').addClass('hidden');
	else
		$('.clearAll').removeClass('hidden');
	for (var i=0; i<splitVariablesLength;i++){
		if(splitFields[i]=="txtItemScheduledStartDate"){
			strSearch+="<span data-a='32' data-b='Start Date'>"+multilingualKeyValue('32','34')+"</span><span data-filtered=\""+splitFields[i]+"\">"+splitVariables[i].replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		}
		if(splitFields[i]=="txtItemTags"){
			strSearch+="<span data-filtered=\""+splitFields[i]+"\">"+splitVariables[i]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		}
		if(splitFields[i]=="ProductIdList"){
			if($('#txtUsrRole').val()=="Distributor"){
				hiddenStrSearch+="<span class=\"hidden\"></span><span class=\"hidden\" data-filtered=\""+splitFields[i]+"\">"+splitVariables[i]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			}			
		}
		if(splitFields[i]=="txtSearchText"){
			strSearch+="<span data-filtered=\""+splitFields[i]+"\">"+splitVariables[i].replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		}
		else if(splitFields[i]=="txtItemScheduledEndDate"){
			strSearch+="<span data-a='33' data-b='End Date'>"+multilingualKeyValue('33','34')+"</span><span data-filtered=\""+splitFields[i]+"\">"+splitVariables[i].replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		}
		else if(splitFields[i]=="txtItemPrice"){
			strSearch+="<span data-a='34' data-b='PRICE'>"+multilingualKeyValue('34','34')+"</span>";
			var splitType=splitVariables[i].split(',');
			for (var j=0; j<splitType.length;j++){
				var showValue="";
				if($.trim(splitType[j].split(':')[0])=="0")
					showValue=splitType[j].split(':')[1]+" & below";
				else if($.trim(splitType[j].split(':')[1])==$.trim($('.slider_range div:last label input').attr('data-txtitemprice').split(':')[1]))
					showValue=splitType[j].split(':')[0]+" & above";
				else
					showValue=splitType[j].replace(/'/g,'').replace(/:/g," to <i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;");
				strSearch+="<span data-filtered=\""+splitFields[i]+"\" data-value=\""+splitType[j]+"\"><i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+showValue+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			}
		}
		else if(splitFields[i]=="txtItemPurchaseType"){
			var purchaseType="Licence";
			if(splitVariables[i].replace(/'/g,'').toLowerCase()=="free"){
				purchaseType=multilingualKeyValue('35','34');   /* data-b=Free */
			}
			else if(splitVariables[i].replace(/'/g,'').toLowerCase()=="paid"){
				purchaseType=multilingualKeyValue('36','34');   /* data-b=Paid */
			}
			strSearch+="<span data-filtered=\""+splitFields[i]+"\">"+purchaseType+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		}
		else if(splitFields[i]=="IsRecommendedByiON"){
			strSearch+="<span data-filtered=\""+splitFields[i]+"\" data-a='37' data-b='Recommended by iON'>"+multilingualKeyValue('37','34')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		}
		else if(splitFields[i].indexOf("txtLevel")!=-1){
			var splitType=splitVariables[i].split(',');
			if(splitType.length>1){
				for (var j=0; j<splitType.length;j++){
					if(!isNaN(splitType[j])){
						var levelNames=$( "input[value='"+splitType[j]+"'][data-level='"+splitFields[i]+"']" ).parent().text();
						strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\""+splitType[j]+"\" data-filtered=\"txtLevels\">"+levelNames.replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
						/* strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\""+levelNames+"\" data-filtered=\"txtLevels\">"+levelNames.replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>"; */
					}				
				}
			}
			else{
				if(!isNaN(splitVariables[i])){
					var levelNames=$( "input[value='"+splitVariables[i]+"'][data-level='"+splitFields[i]+"']" ).parent().text();
					strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\""+splitVariables[i]+"\" data-filtered=\"txtLevels\">"+levelNames.replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
				}				
			}
		}
		else if(splitFields[i].indexOf("txtProductCreationType")!=-1){
			var splitType=splitVariables[i].split(',');
			if(splitType.length>1){
				for (var j=0; j<splitType.length;j++){
					strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\""+splitType[j]+"\" data-filtered=\"txtProductCreationType\">"+getProductCreationType(splitType[j]).replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
				}
			}
			else{
				strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\""+splitVariables[i]+"\" 	data-filtered=\"txtProductCreationType\">"+getProductCreationType(splitVariables[i]).replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			}
		}
		else if(splitFields[i].indexOf("txtOrgId")!=-1){
			var splitType=splitVariables[i].split(',');
			var orgName="";
				for (var j=0; j<splitType.length;j++){
					$('input:checkbox[data-id="txtOrgId"]:checked').each(function() {
						if($(this).attr('data-value')==splitType[j]){
						  orgName=$(this).parent().text();
						}
					});
					strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\""+splitType[j]+"\" data-filtered=\"txtOrgId\">"+orgName.replace(/'/g,'')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
				}
		}
		else if(splitFields[i].indexOf("schedule")!=-1){
			var splitType=splitVariables[i];
			if(splitType.indexOf('List') > -1 || catalogueNavigation==true)
				moveToTop=true;
			if(splitType.toLowerCase().indexOf("daterange")>-1){
				var splitDateRange=splitType.split(':');
				if(splitDateRange.length==2)
					strSearch+="<span data-a='32' data-b='Start Date'>"+multilingualKeyValue('32','34')+"</span><span data-filtered=\"txtItemScheduledStartDate\">"+splitDateRange[1]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
				else if(splitDateRange.length==3)
					strSearch+="<span data-a='32' data-b='Start Date'>"+multilingualKeyValue('32','34')+"</span><span data-filtered=\"txtItemScheduledStartDate\">"+splitDateRange[1]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span><span>End Date:</span><span data-filtered=\"txtItemScheduledEndDate\">"+splitDateRange[2]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			}
			else if(splitType.toLowerCase()=="upcomingschedule")
				strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\""+splitType+"\" data-filtered=\"schedule\">Upcoming Schedule&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			else if(splitType.toLowerCase().indexOf("week")>-1){
				var weekCal=splitType.replace('List','').replace('Calender','').replace(':',' ').replace('-',' of ').split(' ');
				strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\"week\" data-filtered=\"schedule\">"+weekCal[0]+" "+(Number(weekCal[1])+1)+" "+weekCal[2]+" "+weekCal[3]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			}				
			else if(splitType.toLowerCase().indexOf("month")>-1){
				var monthVal=splitType.replace('monthList:','').replace('monthCalender:','').replace('-',', ').split(',');
				strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\"month\" data-filtered=\"schedule\">"+monthArray[monthVal[0]-1]+" "+monthVal[1]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			}				
			else if(splitType.toLowerCase().indexOf("year")>-1)
				strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\"year\" data-filtered=\"schedule\">"+splitType.split(':')[1]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			else if(splitType.toLowerCase().indexOf("date")>-1)
				strSearch+="<span data-level=\""+splitFields[i]+"\" data-name=\"date\" data-filtered=\"schedule\">"+splitType.split(':')[1]+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		}
		else if(splitFields[i].indexOf("noScheduledDate")!=-1){
				strSearch+="<span data-filtered=\"noScheduledDate\" data-a='38' data-b='Self Paced Courses'>"+multilingualKeyValue('38','34')+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		}
	}
	if(strSearch==""){
		strSearch="<span data-a='31' data-b='All Products'>"+multilingualKeyValue('31','34')+"</span>";
		$('.clearAll').addClass('hidden');
	}
	callOnSearch(moveToTop);
	/* changed by Kiran */
	if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
		var categoryLevelDetails=$('#product_catlog').data('levelDetails');
		eval('getCategoryDetails(categoryLevelDetails)');
	}
	$('#CatalogueContent').removeClass('hidden');
	$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
	$('.yourSearch').append(strSearch);
	$('.yourSearch').append(hiddenStrSearch);
	createShareDiv('#catalogueview .yourSearch');
	deleteMyFilter();
}
function postHeaderScript(){
	$.fn.menuAim = function(opts) {
		this.each(function() {
			init.call(this, opts);
		});
		return this;
	};
	$('.showMySubscriptionsWeb ul li a').on('click',function(){
		$(".selctdIcon").addClass('hidden');
		$(this).children('.selctdIcon').removeClass('hidden');
	});
	$(document).on('click', '.headNav li.roleSelectionWeb .subdropdown_menu>li a', function() {
		if($(this).hasClass('learners') && $.trim(isLearnerMode)!=0){
			$(".distributorClass > span.distribNm").text($(this).text());
		}
	});
	$(document).on('click', '.getMyProductLists', function() {
		if($('#txtUsrRole').val()=="Distributor"){
			$(".distributorClass > span.distribNm").text(multilingualKeyValue('39','34'));
			$(".distributorClass > span.distribNm").attr({ 'data-m34': '39', 'data-val': multilingualKeyValue('39','34')});
			$("a#selectRole + span.selectRoleSub").text($(this).attr('data-distributorName'));
			$("a#selectRole + span.selectRoleSub").attr('title',$(this).attr('data-distributorName'));
			$('#distributerOrg').modal('hide');
		}
		else{
			$(".distributorClass > span.distribNm").text(multilingualKeyValue('40','34'));
			$(".distributorClass > span.distribNm").attr({ 'data-m34': '40', 'data-val': multilingualKeyValue('40','34')});
			$("a#selectRole + span.selectRoleSub").text($(this).attr('data-publisherName'));
			$("a#selectRole + span.selectRoleSub").attr('title',$(this).attr('data-publisherName'));
			$('#publisherOrg').modal('hide');
		}
		hideTabsForLearner();
	});
	$("#ul.searchdropdown.dropdown-menu li").on('click',function(e) {
		e.stopPropagation();
	});
	$('.searchboxnew').on('click',function(){
		var windowWidth = $(window).width();
		$('.searchbox2').show().css({'width': windowWidth+'px','top':$('#top').height()});
		$('.navbarmobile-search .searchboxnew').hide();
	});
	$('.close_srch').on('click',function(){
		$('.searchbox2').hide();
		$('.navbarmobile-search .searchboxnew').show();
	});
	$('#loginmodal').on('show.bs.modal', function() {
		$('.marketplace-wrp').css('padding', '0');
	});
	$('#loginmodal').on('hide.bs.modal', function() {
		$('#loginmodal').find('#showPreMessage').removeClass('hidden');
	});
	$('#Registermodal').on('show.bs.modal', function() {
		$('.marketplace-wrp').css('padding', '0');
	});
	$('.signup').on('click',function() {
		$(this).parent().parent().parent().find('.successBody').show();
		$(this).parents('.loginBody').hide();
	});
	$(".activationCode").on("keyup",function() {
		$(".activeproductForm .close-icon").removeClass("disable-pointer");		
	});
	$(".activeproductForm .close-icon").on("click", function () {
		$('.activeProductInfoWrong').addClass('hidden');
		$('.activeProductInfo').addClass('hidden');
		$('#activateProductModal').find('.modal-footer').addClass('hidden');
		$(".activationCode").val("");
		$(".activeproductForm .close-icon").addClass("disable-pointer");
	});

	$(document).on("focus","input.selectOpt",function(){
		$(this).parents(".form-group").find(".selName").addClass("in");
		$(this).parents(".datepicker").find(".selName").addClass("in");
	}).on("blur","input.selectOpt",function(){
		var a = $(this).val();
		if(a.length==0){
			if(typeof clearAllValidation_iDH == 'function')
				clearAllValidation_iDH();
			$(this).parents(".form-group").find(".selName").removeClass("in");
			$(this).parents(".datepicker").find(".selName").removeClass("in");
		}
	});
	$(document).on("change","select.selectpicker",function(){
		if($.trim($(this).val()).toLowerCase()==$.trim($(this).find('option.bs-title-option').text()).toLowerCase()){
			$(this).parents(".form-group").find(".selName").removeClass("in");
		}
		else{
			if(typeof clearAllValidation_iDH == 'function')
				clearAllValidation_iDH();
			$(this).parents(".form-group").find(".selName").addClass("in");
		}
	});

	$('.scroll_top').on("click",function(e){
		$(window).scrollTop(0);
		$('body').click();			 
	});
	if(!isNewHeader){
		if ($(window).width() < 600) {
			$('#cartdisp').addClass('shrink');
			$('.navbar-search').addClass('shrink');
		}
		else{
			$('#cartdisp').removeClass('shrink');
			$('.navbar-search').removeClass('shrink');
		}
	}
	$(window).on("scroll",function() {
		var scrollerTop = $(window).scrollTop();
			/* added new */
		if ($(window).width() < 603) {
			if (scrollerTop >= 200) {
				$('.new_header_mobile').slideUp();
			}
			else {
				$('.new_header_mobile').slideDown();
			}
		}
		if ($(window).width() < 653) {
			if($.trim($("#txtUsrRole").val()).toLowerCase()!='publisher'){
				if (scrollerTop >= 200) {
					$('.updatedHeader .actCodehubSearch, .updatedHeader .activateCode.desk').slideUp();
				}
				else {
					$('.updatedHeader .actCodehubSearch, .updatedHeader .activateCode.desk').slideDown();
				}
			}
		}
		if (scrollerTop >= 200) {
			$('.additionalbar_header').slideUp(300);
		}
		else {
			$('.additionalbar_header').slideDown(300);
		}
		if ($(window).width() > 991) {
			if (scrollerTop >=1350){
				$("#fixed_srch").addClass("float_srch");
			}
			else{
				$("#fixed_srch").addClass("fixsearch_filter");
			}
			if (scrollerTop >10) {
				/* $('#top').removeClass('affix-top').addClass('affix'); */
				$('#loader').css('top','0');
				$('#loader').css('z-index','5000');
				$(".scroll_top").show();
				$("#fixed_srch").addClass("fixsearch_filter");
				$("#fixed_srch").removeClass("float_srch");
				/* $('.navbar-header').addClass('shrinklogo');
				$('.headNav').addClass('shrink'); */
				$("ul[id='announcemetul']").removeAttr('style').css('margin-left','-20px');
				$('#top').removeClass('affix-top').addClass('affix');
				if(!isNewHeader){					
					$('.navbar-header').addClass('shrinklogo');
					$('.headNav').addClass('shrink');					
					$('.product_catlog').addClass('shrink');
					$('.product_catlog li ul.dropdown-menu li ul li a').addClass('shrink');
					$('#navbar ul.cart_display li.notification span.cart-bubbleqty').addClass('shrink');
					$('.logo img').css({"transform": "scale(0.8)", "margin-top":"3px",  "margin-left":"-10px"});
					$('#navbar #alertdisp').addClass('shrink');
					$('#cartdisp').addClass('shrink');
					$('#wishlistdisp').addClass('shrink');
					$('.navbar-search').addClass('shrink');
					$('.navbar-search li div.searchboxnew input').addClass('shrink');
					$('.navbar-search li div.searchboxnew .searchfontawesome').addClass('shrink');
				}
				$('#recentView').addClass('hidden');
				$('.filterNav').removeClass('hidden');
				$('.filterNav').css({'top':'0px','min-height':Number($('#top').height())+5,'z-index':'10000'});
			}
			else {
				if(0 < ($("body").height() - $(window).height()) && ($("body").height() - $(window).height())<100)
					$('#FooterContent').attr('style','padding-top:100px');
				else
					$('#FooterContent').attr('style','padding-top:0px');
				$("ul[id='announcemetul']").removeAttr('style');
				$('#top').removeClass('affix').addClass('affix-top');
				if(!isNewHeader){
					$('#navbar #alertdisp').removeClass('shrink');
					$('.navbar-header').removeClass('shrinklogo');
					$('.headNav').removeClass('shrink');					
					$('.product_catlog').removeClass('shrink');
					$('.navbar-search').removeClass('shrink');
					$('.navbar-search li div.searchboxnew input').removeClass('shrink');
					$('.navbar-search li div.searchboxnew .searchfontawesome').removeClass('shrink');
					$('.logo img').css({"transform": "scale(1)", "margin-top":"9px", "margin-left":"2px"});
					$('#cartdisp').removeClass('shrink');
					$('#wishlistdisp').removeClass('shrink');
					$('#navbar ul.cart_display li.notification span.cart-bubbleqty').removeClass('shrink');
				}
				$(".scroll_top").hide();
				$("#fixed_srch").removeClass("fixsearch_filter");
				$('.filterNav').css('top','-90px');
				$('.filterNav').addClass('hidden');
			}
			if (scrollerTop >= 500) {
				$('.courseNav').addClass('show');
			} else {
				$('.courseNav').removeClass('show');
			}
			if(micrositeCheck && $('#micrositeHeadContent div.courseNav').length>0){
				jQuery.each( micrositeHeaderArray , function( i, val ) {
					var scroll_pos_test = micrositeHeaderHeightArray[i] - Number($('#micrositeHeadContent div.courseNav').height()) + 10;
					var scroll_pos_testh = micrositeHeaderHeightArray[i] - Number($('#micrositeHeadContent div.courseNav').height() + 10);
					if( i + 1 < micrositeHeaderArray.length)
						scroll_pos_testh = micrositeHeaderHeightArray[i+1] - Number($('#micrositeHeadContent div.courseNav').height() + 10);
					else if(i + 1==micrositeHeaderArray.length)
						scroll_pos_testh = Number(micrositeHeaderHeightArray[i])+ 1000;
					if(scrollerTop >= scroll_pos_test && scrollerTop <= scroll_pos_testh) {
						var a = $('.courselist_link').has('a[data-hashid="'+val+'"]');
						$('.courselist_link').removeClass('courselist_activelink');
						a.addClass('courselist_activelink');
					}
				});
			}
		}
		else{
			if (scrollerTop >10) {
				$('#top').removeClass('affix-top').addClass('affix');
				$('.filterNav').removeClass('hidden');
				$('.filterNav').css('top',$('#top').height());
				$('.filterNav').css({'top':'0px','min-height':Number($('#top').height())+5,'z-index':'1000'});
				$(".scroll_top").show();
				$('#recentView').addClass('hidden');
			}
			else{
				$('#top').removeClass('affix').addClass('affix-top');
				$('.filterNav').css('top','-90px');
				$('.filterNav').addClass('hidden');
				$(".scroll_top").hide();
			}
		}
	});
}
function postCatalogueScript(){
	$('#accordion').on('show.bs.collapse', function (e) {
		$(e.target).prev('.panel-heading').addClass('ss');
		$(e.target).prev('.panel-heading').find('.fa-minus').show();
		$(e.target).prev('.panel-heading').find('.fa-plus').hide();
	});
	$('#accordion').on('hidden.bs.collapse', function (e) {
		$(e.target).prev('.panel-heading').find('.fa-minus').hide();
		$(e.target).prev('.panel-heading').find('.fa-plus').show();
	});
	$(".hide_filterM").on("click",function(){
		$(".filters_hide").show();
		$("#overlay.modal-backdrop").show();
	});
	$("#overlay.modal-backdrop").on("click",function(){
		$(this).hide();
		$(".filters_hide").hide();
	});
	$('#search_filter').on("click",function() {
		$(this).hide();
		$('#filter_s').slideDown();
	});
	$('.close_btn').on("click",function() {
		$('#filter_s').slideUp();
		$('#search_filter').show();
	});
	$('.products').on("click",function(){
		var checkBoxes=$(this).find('input[type=checkbox]');
		checkBoxes.prop("checked", !checkBoxes.prop("checked"));
		filterSearch();
	});
	$('.loadmore_btn').on("click",function() {
		$(this).hide();
		$(this).parents('.sched_cont').find('.showmore').slideDown('slow');
	});
	$(document).on("click",".customindi",function(){
		var pos=$(this).position();
		var left = Math.round(pos.left+60);
		var top = Math.round(pos.top-170);
		log(top,left);
		$('.flyout_cont').show();
		$('.flyout_cont').css({"top":top,"left":left}) ;
		checkFromMinJs=false;		   
	});
	$(document).on("click",".cancel",function(){
		$('.flyout_cont').hide();
	});
	$(document).on("click",".flyout_cont .apply-btn",function(){
		filterSearch();
		$('.flyout_cont').hide();
	});	
	var ts = Math.round((new Date()).getTime() / 1000);
	$('html').on("mouseover",function(e){
		if(!$(e.target).closest('.flyout_cont').length){          
			$('.flyout_cont').hide();
		}
	});
	$('.schedule-filter>li').on("click",function() {
		$('#txtItemScheduledStartDate').val('');
		$('#txtItemScheduledEndDate').val('');
		$('.schedule-filter>li').removeClass('active');
		$(this).addClass('active');
		var currSchName=$(this).attr('data-search').toLowerCase();
		var sv = $(this).attr('data-div');
		if(currSchName!="custom")
			$('.listtime').hide();
		$('.' + sv).show();		
		if(currSchName=="upcoming schedules" || currSchName=="this week" || currSchName=="custom")
			showCalenderView=false;
		if(sv=="upcoming-schedule")
			filterSearch();
	});
	$('.showschfilter').on("click",function() {
		$('.cal-filter').show();
	});
	$('.diffviews>li:first-child').on("click",function() {
		$('.cal-filter').hide();
	});
	if(typeof $('.custom_datetime').datetimepicker == 'function' && $('.custom_datetime').length!=0){
		try{
			$('.custom_datetime').datetimepicker({
				format: 'DD/MM/YYYY',
				inline: true,
				ignoreReadonly:true
			});
		}
		catch(err) {
			log(err);
		}
	}
	/* Direct Licence code Activation - start */		
	$(document).on('click', '.code-link', function() {		
		$(".licence-input").addClass('in');		
		$(".licence-input").removeClass('hidden');
		$(".licence-div").css({"opacity": "0", "height": "28px"});
		/* if($(window).width()>568)
			$(".licence-div").addClass('hidden'); */		
		$('#licenceCodeValue').val('');		
	});		
	$(document).on('click', '.code-link1', function() {		
		$(this).parent('.actCont').hide();		
		$(".licence-input1").addClass('in');		
	});		
	$("#licencecode").on("click", function() {		
		isDirectLA=true;		
		var LCV=$.trim($('#licenceCodeValue').val());		
		if(LCV!="" && LCV!=null && LCV!=undefined){
			activateLicenseEventHandler("","",LCV);		
		}			
		else{		
			$('.licence-success span:first').text('');
			/* Please enter Licence code : 41 */
			$('.licence-success span:first').text(multilingualKeyValue('41','34'));		
			$(".licence-success").addClass('insuc');
			$(".licence-success").children('span:first').attr('style','width:95%');
			setTimeout(function() {
				$(".licence-success").removeClass('insuc');
			}, 3000);
		}		
	});		
	$(".licence-success-clr").on("click", function() {		
		$(this).parent().removeClass('insuc');
		if($(this).siblings('span').text()!=multilingualKeyValue('41','34'))
			$(".licence-div").css({"opacity": "1", "height": "28px"});
	});		
	/* Direct Licence code Activation - end */
	$(".paid").on('click',function(){
		$(".slider_range").fadeIn();
		$(".free1").prop('checked', false);
	}) ;
	$(".free1").on('click',function(){
		$(".slider_range").fadeOut();
		$(".paid").prop('checked', false);
	}) ;
	$('.hide_filterM').on('click',function(){
		$('#filterScreen, #filterscreen').css('overflow-y','auto');
		$('#filterScreen a.undrlinelink').attr('onclick','noScheduledDate();$("#overlay.modal-backdrop").click();');
		$('#filterScreen .scroll_bar *').removeAttr('onclick');	
		$('#txtItemScheduledStartDate').siblings('div:first').attr('onclick','$("#txtItemScheduledStartDate").val("")');
		$('#txtItemScheduledStartDate').siblings('div').children('i').parent().attr('onclick','$("#txtItemScheduledStartDate").focus();');
		$('#txtItemScheduledEndDate').siblings('div:first').attr('onclick','$("#txtItemScheduledEndDate").val("")');
		$('#txtItemScheduledEndDate').siblings('div').children('i').parent().attr('onclick','$("#txtItemScheduledEndDate").focus();');		
	});
	$('.clearAll').on('click',function(){
		$('.diffviews li').removeClass('active');
		$('.diffviews li:nth-child(1)').addClass('active');
		$('.schedule-filter li').removeClass('active');
		clearAllFilter();
	});
	if($('#catalogueNavigation').val()!=undefined){
		if($.trim($('#catalogueNavigation').val()).toLowerCase()=="true")
			catalogueNavigation=true;
	}
	if(!($('.media-middle:visible').length>0) && (calendar==undefined || calendar=="")){
		var myArray=[];
		dynamicCalender(myArray,'month',new Date().toISOString().split('T')[0]);
		log('1St time Calendar initiated');
		$('.monthly-schedule').find('.media-middle').text('');
		$('.schedule-filter li').removeClass('active');
		/* added for jobs CR */
		try{
			calendar.options.views.day.enable=0;
		}
		catch(err) {
			log(err);
		}
		/* added for jobs CR */
	}
	$('.click_box[data-calendar-nav]').each(function() {
		var $this = $(this);
		$this.click(function() {
			isCurrentSchedule=false;
			if($this.parent().parent().hasClass("dately-schedule"))
				checkFromMinJs=true;
			
			calendar.navigate($this.data('calendar-nav'));
			filterSearch();
		});
	});		
	$('.schedule-filter li[data-calendar-view]').each(function() {
		var $this = $(this);
		$this.click(function() {
			$('.schedule-filter>li').removeClass('active');
			$this.addClass('active');
			var sv = $this.attr('data-div');
			if(sv!="custom-schedule")
				$('.listtime').hide();
			isCurrentSchedule=true;
			var currentViewStart=$('.diffviews li.active a').attr('href').replace('#','').split('view')[0];
			if(($this.data('calendar-view')=="week" || $this.data('calendar-view')=="day") && currentViewStart=="calender"){
			}
			else if($this.data('calendar-view')=="day"){
				log('day view');
				calendar.options.day=new Date().toISOString().split('T')[0];
				calendar.view($this.data('calendar-view'));
			}
			if(sv!="custom-schedule"){
				filterSearch();
			}
			$('.' + sv).show();
		});
	});
	$('.diffviews li a').on('click',function() {
		var sv=$(this).attr('href');
		if(sv=="#calenderview")
			showCalenderView=true;
		else
			showCalenderView=false;
		$(".diffviews li").removeClass('active');
		$(this).parent().addClass('active');	
		$('#openSchedule').find('.schedule-filter li').removeClass('active');
		filterSearch();
	});	
	setTimeout(function(){
		if($(window).width()<480){
			$(".changeMiddle").attr('style','display:block;padding-top:4px;');
		}
	},1500);
}
function callAlways(){
	custom_marketplace();
	if(typeof WOW == 'function'){
		new WOW().init();
	}
	$('#FooterContent').removeClass('hidden');
	fireResize();	
	$('body').on({'touchmove': function(e) {
			$('.tooltip-for-password i').tooltip('hide');
			$("[data-tooltip='tooltip']").tooltip('hide');
			$(".input-group-btn").removeClass('open');			
			$(document).click();
		}
	});
	$(window).on("resize",function(){
		setHeightofDropDown();
		$('.tooltip-for-password i').tooltip('hide');
		$("[data-tooltip='tooltip']").tooltip('hide');
		$(".input-group-btn").removeClass('open');
		$(document).click();
		if($(".hide_filterM:visible").length==0 && $(window).width()>991){
			$(".filters_hide").show();
			$("#overlay.modal-backdrop").hide();
		}
		else{
		}
	}); 
	$('.form-control.searchheight.whiteBg').on("mouseout",function(){$(this).blur();})
	/* showNotification();	 */
	tooltipHoverFocus();		
	/* from master page */
	$(function(){
		$(document).ready(function() {
			/* $('#myPreLoginCart').val(''); */
			if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
				$("[data-tooltip='tooltip']").attr('data-trigger','focus');
			}
			else{
				$("[data-tooltip='tooltip']").attr('data-trigger','hover');
			}	
			$('[data-tooltip="tooltip"]').tooltip();
			
			$('#txtPassword').on('click focus',function(){
				$('#customTooltip[data-tooltip="tooltip"]').tooltip("show");
			});
			$('#txtPassword').on('focusout',function(){
				$('#customTooltip[data-tooltip="tooltip"]').tooltip("hide");
			});
		});
		var wrapper = jQuery('.url-wrapper');
		if(navigator.userAgent.match(/(iPod|iPhone|iPad)/)){
			wrapper.addClass('ios');
			var scrolling = 'no';
		}else{
			var scrolling = 'yes';
		}
	});
	$(document).ready(function() {
		/* added for jobs CR */
		try{
			if($('#txtDateOfBirth').length > 0 && typeof $('#txtDateOfBirth').datetimepicker == 'function'){
				$('#txtDateOfBirth').datetimepicker({
					format: 'DD/MM/YYYY',
					maxDate: new Date(),
					ignoreReadonly:true
					/* format:'d/m/Y',
					defaultDate:'01/01/1990',
					timepicker:false, */
				});
			}
		}
		catch(err) {
			log(err);
		}
		/* added for jobs CR */
	});
	/* from master page */
	return true;
}
/* from master page */
function showSignUp(){
	$(".logInCont").hide();
	$(".signUpcont").show();
}
function showLogin(){
	$(".logInCont").show();
	$(".signUpcont").hide();
}
function ShowHidePassword(ID) {
	var currContainer = $("#" + ID).parents(".pwdShowHideContainer").find(".selectOpt");
	if (currContainer.attr('type') == "password") {
		$("#" + ID).attr("data-hint", "Hide");
		$("#" + ID).find("i").removeClass("fa-eye-slash").addClass("fa-eye");
		currContainer.attr('type','text');
	}
	else {
		$("#" + ID).attr("data-hint", "Show");
		$("#" + ID).find("i").removeClass("fa-eye").addClass("fa-eye-slash");
		currContainer.attr('type','password');
	}
}
/* from master page */


function miniCart(){
	if($('#sessChk').val()=="" || $('#sessChk').val()==null){
		var cartN=[],cartD=[];
		for(var i=0;i<$.trim($('#txtCart').val()).split(',').length;i++){
			var flagMe=true;
			var tmpPrId=$.trim($('#txtCart').val()).split(',')[i].split('~')[0];
			for(var j=i+1;j<$.trim($('#txtCart').val()).split(',').length;j++){
				if(tmpPrId==$.trim($('#txtCart').val()).split(',')[j].split('~')[0]){
					flagMe=false;
				}
			}
			if(flagMe){
				cartN.push($.trim($('#txtCart').val()).split(',')[i]);
				cartD.push(tmpPrId);
			}	
		}
		$('#txtCart').val(cartN.toString());
		$('#productsInCart').val(cartD.toString());
	}
	store.set('prelogincart',$('#myPreLoginCart').val());
	if($('#txtCart').val()!=undefined && $('#txtCart').val()!="null" && $('#txtCart').val()!=null){
		if($.trim($('#txtCart').val()).split(",")[0]!="")/* changed by jobs CR */{
			$('.minicart').text($('#txtCart').val().split(",").length);
			$('.minicart').removeClass('hidden');
			var productsInCart=[];
			$.each($('#txtCart').val().split(","), function(i, el){				
				productsInCart.push(el.split('~')[0]);
			});
			$('#productsInCart').val(productsInCart.toString());
		}
		else{
			$('.minicart').text('0');
			$('.minicart').addClass('hidden');
			$('#productsInCart').val("");
		}			
	}
}
function activateLicenseModalButton(a){
	$('.licenseCodeActivation'+a).on('click',function(){
		if($('#activationCode').val()==null || $('#activationCode').val()==""){
			$('#activationCode-H').text(multilingualKeyValue('41','34'));    /* Please enter Licence Code */
			$('#activationCode-H').removeClass('hidden');
			$('#activationCode').css("border-color","red");	
		}
		else{
			var productId=$(this).attr("data-id");
			var productName=$(this).attr("data-productname");
			var licenceCode=$('#activationCode').val();
			isDirectLA=false;
			activateLicenseEventHandler(productId,productName,licenceCode);			
			$('#activemodal').modal('hide');
		}
	});
}

function subscribeModalButton(a){
	$('.confirmSubscribe'+a).on('click',function(){
		var productId=$(this).attr("data-id");
		var productName=$(this).attr("data-name");
		subscribeEventHandler(productId,productName);
		/* $('#subscribemodal').click(); */
	});
}

function MyCartAct(a){
	if($.trim($("#txtUsrRole").val()).toLowerCase()!='publisher'){
		$('.addToCart'+a).on('click',function(){
			var productId=$(this).attr("data-id");
			var productPrice=$(this).attr("data-price");
			var productName=$(this).attr("data-productname");
			var loginType= $.trim($('#txtUsrRole').val());
			var isMultiSlot=$(this).attr("data-multipleSlot");
			var digitalContractRequired=$.trim(window.store.get('digitalContractRequired'));
			var customFormId=$(this).attr("data-customFormId");
			var acceptedTextStatus = $(this).attr("data-acceptedtext");
			store.set(productId+'_customFormId',customFormId);
			
			addtoCartEventHandler(productId,productName,productPrice,'','',isMultiSlot,customFormId,acceptedTextStatus);
		});
		$('.buyNow'+a).on('click',function(){
			var productId=$(this).attr("data-id");
			var productName=$(this).attr("data-productname");
			var productPrice=$(this).attr("data-price");
			var slotId=$.trim($('input[name=optradio]:checked').attr('data-slotid'));
			var loginType= $.trim($('#txtUsrRole').val());
			var isMultiSlot=$(this).attr("data-multipleSlot");
			var digitalContractRequired=$.trim(window.store.get('digitalContractRequired'));
			var customFormId=$(this).attr("data-customFormId");
			var acceptedTextStatus = $(this).attr("data-acceptedtext");
			console.log("acceptedTextStatus ="+acceptedTextStatus);
			store.set(productId+'_customFormId',customFormId);			
			buyNowEventHandler(productId,productName,productPrice,slotId,'',isMultiSlot,customFormId,acceptedTextStatus);
		});
		$('.activate'+a).on('click',function(){
			if(profileCompletionFlag){
				var productId=$(this).attr("data-id");
				var productName=$(this).attr("data-productname");
				var productPrice=$(this).attr("data-price");
				var productCurrency=$(this).attr("data-currency");
				var publisherName=$(this).attr("publisher-name");
				var publisherId=$(this).attr("publisher-id");
				var customFormId=$(this).attr("data-customFormId");
				store.set(productId+'_customFormId',customFormId);
				if (typeof getTncStatus == 'function')
					getTncStatus(productId,productName,productPrice,productCurrency,publisherId,publisherName,false,customFormId,"activateCall");
				else
					activateLicenseInitiateEventHandler(productId,productName,productPrice,productCurrency,publisherId,publisherName,false,customFormId);
			}
			else{
				$('#toaster').html('');
				iHUB.toaster.blackMessageToaster(multilingualKeyValue('187','34'));   /* "Please complete your profile" */
			}
		});
		$('.subscribeFreeProducts'+a).on('click',function(){
			var productId=$(this).attr("data-id");
			var productName=$(this).attr("data-name");
			var customFormId=$.trim($(this).attr("data-customFormId"));
			if (typeof getTncStatus == 'function')
				getTncStatus(productId,productName,"","","","",false,customFormId,"subscribeCall");
			else
				subscribeInitiateEventHandler(productId,productName,false,customFormId);
		});
		$('.connectToPublisher'+a).on('click',function(){
			var productId=$(this).attr("data-id");
			var productName=$(this).attr("data-productname");
			var publisherName=$(this).attr("data-publishername");
			var publisherId=$(this).attr("data-publisherid");
			connectToPublisher(productId,productName,publisherName,publisherId);
		});
		viewMicrositeEventHandler();
		$('.btn').on("mouseout",function(){ 
			  $('.tooltip').hide();
			});
			$('.btn').on("mouseover",function(){ 
			  $('.tooltip').show();
		}); 
		$('.addToCart'+a).on("mouseout",function(){
			$('.addToCart'+a).blur();
		});
		$('.diffviews li').on("mouseout",function(){
			$('.diffviews li').blur();
		});
		$('#Cart').on("mouseout",function(){
			$('#Cart').blur();
			$('body').click();
		});
		$('.addToWishlist'+a).on('click',function(){
			var productId=$(this).attr("data-id");
			var productPrice=$(this).attr("data-price");
			var productCurrency=$(this).attr("data-currency");
			var productName=$(this).attr("data-productname");
			var productdesc=$(this).attr("data-productdesc");
			var productimg=$(this).attr("data-productimg");
			var productType=$(this).attr("data-producttype");
			var productDuration=$(this).attr("data-productduration");
			var decideChangeClass="";
			if($('#sessChk').val()!="" && $('#sessChk').val()!=null){
				decideChangeClass=purchaseActivity("addToWishlist",productId,"1","",productPrice,productName);
			}
			else{
				checkMyPage();/* $('#loginmodal').modal(); */	
			}
			if(decideChangeClass.toLowerCase()=="added to wishlist."){
				$('#toaster').html('');
				iHUB.toaster.blackMessageToaster(productName+" "+multilingualKeyValue('42','34'));/* "Added To Wishlist */
				$("[id='"+productId+"']").find('.wishlistbtn').addClass('active');
				$("[id='"+productId+"']").find('.wishlistbtn').children('a.ATW').addClass('hidden');
				$("[id='"+productId+"']").find('.wishlistbtn').children('a.RFW').removeClass('hidden');
			}
			else if(decideChangeClass.toLowerCase()=="not added to wishlist."){
				$('#toaster').html('');
				iHUB.toaster.blackMessageToaster(productName+" "+multilingualKeyValue('43','34'));/* "Not Added To Wishlist"*/
			}
			else if(decideChangeClass.toLowerCase()=="already present in wishlist."){
				$('#toaster').html('');
				iHUB.toaster.blackMessageToaster(productName+" "+multilingualKeyValue('44','34'));/* "Already Present In Wishlist*/
			}	
		});
		$('.removeFromWishlist'+a).on('click',function(){
			var productId=$(this).attr("data-id");
			var productPrice=$(this).attr("data-price");
			var productCurrency=$(this).attr("data-currency");
			var productName=$(this).attr("data-productname");
			var productdesc=$(this).attr("data-productdesc");
			var productimg=$(this).attr("data-productimg");
			var productType=$(this).attr("data-producttype");
			var productDuration=$(this).attr("data-productduration");
			var decideChangeClass=purchaseActivity("removeFromWishlist",productId,"1","",productPrice,productName);
			if(decideChangeClass=="removed from Wishlist."){
				$('#toaster').html('');
				iHUB.toaster.blackMessageToaster(productName+" "+multilingualKeyValue('45','34'));/* Removed From Wishlist. */
				$("[id='"+productId+"']").find('.wishlistbtn').removeClass('active');
				$("[id='"+productId+"']").find('.wishlistbtn').children('a.ATW').removeClass('hidden');
				$("[id='"+productId+"']").find('.wishlistbtn').children('a.RFW').addClass('hidden');
			}
			else if(decideChangeClass=="not removed from Wishlist."){
				$('#toaster').html('');
				iHUB.toaster.blackMessageToaster(productName+" "+multilingualKeyValue('46','34'));/* Not Removed From Wishlist. */
			}	
		});
		if($('#viewMicrosite').length>0){
			var shortUrl=$.trim($(this).attr('data-shortUrl'));
			var isIframe=$.trim($(this).attr('data-iframe'));
			$('button:button[id="viewMicrosite"]').on('click',function() {
				dataLink=$(this).attr("data-link");
				productName=$(this).attr("data-name");
				productId=$(this).attr("data-id");
				if(dataLink!=undefined && productName!=undefined && productId!=undefined)
					viewMicrositeEventHandlerForMicrosite(productId,productName,dataLink,shortUrl,isIframe);
			});
			$('a[id="viewMicrosite"]').on('click',function() {
				dataLink=$(this).attr("data-link");
				productName=$(this).attr("data-name");
				productId=$(this).attr("data-id");
				if(dataLink!=undefined && productName!=undefined && productId!=undefined)
					viewMicrositeEventHandlerForMicrosite(productId,productName,dataLink,shortUrl,isIframe);
			});
		}
		$('.viewMicrosite'+a).on('click',function() {
			if($('#micrositeContent').length>0){
				if(!$('#micrositeContent').hasClass('hidden'))
					$('#micrositeContent').addClass('hidden');
			}
			dataLink=$(this).attr("data-link");
			productName=$(this).attr("data-name");
			productId=$(this).attr("data-id");
			var shortUrl=$.trim($(this).attr('data-shortUrl'));
			var isIframe=$.trim($(this).attr('data-iframe'));
			if(dataLink!=undefined && productName!=undefined && productId!=undefined)
				viewMicrositeEventHandlerForMicrosite(productId,productName,dataLink,shortUrl,isIframe);
		});
		$('.onhoverout').on("mouseenter",function(){
			$(this).hide();
			$(this).parent('.lblContainer .sub_content').find('.onhoverin').show();;
		});
		$('.onhoverin').on("mouseleave",function(){
			$(this).hide();
			$(this).parent('.lblContainer .sub_content').find('.onhoverout').show();
		});
	}
}
function removeFromWishlist(){
	if($.trim($("#txtUsrRole").val()).toLowerCase()!='publisher'){
		$('.removeFromWishlist').on('click',function(){
			var productId=$(this).attr("data-id");
			var productPrice=$(this).attr("data-price");
			var productCurrency=$(this).attr("data-currency");
			var productName=$(this).attr("data-productname");
			var productdesc=$(this).attr("data-productdesc");
			var productimg=$(this).attr("data-productimg");
			var productType=$(this).attr("data-producttype");
			var productDuration=$(this).attr("data-productduration");		
			var decideChangeClass=purchaseActivity("removeFromWishlist",productId,"","",productPrice,productName);
			if(decideChangeClass=="removed from Wishlist."){
				$('#toaster').html('');
				iHUB.toaster.blackMessageToaster(productName+" "+multilingualKeyValue('45','34'));/* Removed From Wishlist. */
				$("[id='"+productId+"']").find('.wishlistbtn').removeClass('active');
				$("[id='"+productId+"']").find('.wishlistbtn').children('a.ATW').removeClass('hidden');
				$("[id='"+productId+"']").find('.wishlistbtn').children('a.RFW').addClass('hidden');
			}
			else if(decideChangeClass=="not removed from Wishlist."){
				$('#toaster').html('');
				iHUB.toaster.blackMessageToaster(productName+" "+multilingualKeyValue('46','34'));/* Not Removed From Wishlist. */
			}		
		});
	}
}
function removeFromCartEventHandler(productId,productName){
	cartProducts=$('#txtCart').val().split(',');
	myPreLoginCartProducts=$('#myPreLoginCart').val().split(',');
	var txtCartArray = [];
	var myPreLoginCartArray = [];
	if($('#sessChk').val()=="" || $('#sessChk').val()==null){	
		$('#txtCart').val('');
		$('#myPreLoginCart').val('');
		for(var i=0;i<cartProducts.length;i++){
			if(cartProducts[i].split('~')[0]==productId)
				$('#'+productId+'-R').remove();
			else
				txtCartArray.push(cartProducts[i]);
			
			if(myPreLoginCartProducts[i].split('~')[0]!=productId)
				myPreLoginCartArray.push(myPreLoginCartProducts[i]);
		}
		
		$('#txtCart').val($.trim(txtCartArray));
		$('#myPreLoginCart').val($.trim(myPreLoginCartArray));
		
		if (typeof organizeCartOffline == 'function')
			organizeCartOffline();
		
		store.set('krt',$('#txtCart').val());
		store.set('prelogincart',$('#myPreLoginCart').val());
		miniCart();
		
		$('#toaster').html('');
		/* removed from Cart. : 47 */
		iHUB.toaster.blackMessageToaster(productName+' '+multilingualKeyValue('47','34'));
		var message=multilingualKeyValue('47','34');
		if($('#myRequestMicrosite').length>0){
			document.getElementById('myRequestMicrosite').contentWindow.postMessage("removeFromCartForMicrositeResponse@~@"+productId+"@~@"+message+"@~@"+$('#productsInCart').val(),"*");
		}
		else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
			if(productId!="" && message!="" && $.trim($('#productsInCart').val())!=""){
				$('#productsInCart').val($.trim($('#productsInCart').val()));
				if (typeof createCustomRemoveFromCartResponseHandler == 'function'){ 
					createCustomRemoveFromCartResponseHandler(productId, message);
				}else{
					createRemoveFromCartResponseHandler(productId, message);
				}
			}
		}
		$(".tooltip.fade.top.in").remove();
	}
	if($('#sessChk').val()!="" && $('#sessChk').val()!=null){
		showLoader();
		purchaseActivity("removeFromCart",productId,"","","",productName);
	}
	hitAnalyticsCheck("Purchase","Remove from cart",productId+" - "+productName);
}
function removefromCart(){
	if($.trim($("#txtUsrRole").val()).toLowerCase()!='publisher'){
		$('.removeFromCart').on('click',function(){
			var productId=$(this).attr("data-id");
			var productName=$(this).attr("data-name");
			removeFromCartEventHandler(productId,productName);
		});
		
		var prdctOriginalPrice = Number($(".changeQuantity").parents().find(".rate_div .offer_rate span span").text().replace(/,/g, '').toString());
		
		//$(".changeQuantity").parents().find(".rate_div .offer_rate span span").text($(".changeQuantity").val()*prdctOriginalPrice);
		$(".changeQuantity").parents().find(".rate_div .offer_rate span span").text(($(".changeQuantity").val()*prdctOriginalPrice).toFixed(2).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ','));

		
		
		$('.changeQuantity').on('keyup',function(){
			showLoader();
			var productId=$(this).attr("data-id");
			var productName=$(this).attr("data-name");
			var productQuantity=$(this).val();
			var unitPrice=$(this).attr("data-pricebuynow");
			
			if(!isNaN(prdctOriginalPrice)&&prdctOriginalPrice!=null && productQuantity>0){
				
			//$(this).parents().find(".rate_div .offer_rate span span").text(productQuantity*prdctOriginalPrice);
			$(this).parents().find(".rate_div .offer_rate span span").text((productQuantity*prdctOriginalPrice).toFixed(2).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ','));
			
			
			}
			
			if(!isNaN(productQuantity)){
				if(productQuantity%1==0){
					if(productQuantity<=0){
					}
					else if(Number(productQuantity)<=10000){				
						changeQuantityEventHandler(productId,productName,productQuantity,unitPrice);	
					}
					else{
						cartProducts=$('#txtCart').val().split(',');
						for(var i=0;i<cartProducts.length;i++){
							if(cartProducts[i].split("~")[0]==productId){
								$(this).val(cartProducts[i].split("~")[1]);
								iHUB.toaster.blackMessageToaster(multilingualKeyValue('48','34')+' '+productQuantity+' '+multilingualKeyValue('49','34'));
								/* 48: Cannot purchase      49: units in one transaction.	 */						
							}
						}
					}
				}				
				else{
				}				
			}			
			else{
			}
			hideLoader_iDH();
		});
		$('.changeQuantity').on('change',function(){
			var productId=$(this).attr("data-id");
			var productName=$(this).attr("data-name");
			var productQuantity=$(this).val();
			cartProducts=$('#txtCart').val().split(',');
			for(var i=0;i<cartProducts.length;i++){
				if(cartProducts[i].split("~")[0]==productId){
					previousQuantity=cartProducts[i].split("~")[1];
				}
			}
			if(productQuantity<=0)
				$(this).val(previousQuantity);
			if(Number(productQuantity)>1000){
				$(this).val(previousQuantity);
				iHUB.toaster.blackMessageToaster(multilingualKeyValue('48','34')+' '+productQuantity+' '+multilingualKeyValue('49','34'));
				/* 48: Cannot purchase   49: units in one transaction. */
			}
		});
		$('.proceedToPay').off().on('click',function(){
			// changed for new payment approach by prajna
			if($.trim($('#txtUsrRole').val()).toLowerCase()=="distributor" &&  profileCompletionFlag){
				var orderDetails = "";
				var productName = "", productPrice = "";
				if ($(this).attr('data-onlineCart') != undefined) {
					var myCart = $.trim($('#txtCart').val());
					if (myCart != "" && myCart != "null" && myCart != "undefined") {
						for (var j = 0; j < myCart.split(',').length; j++) {
							orderDetails += myCart.split(',')[j].split('~')[0]+ '~'+ myCart.split(',')[j].split('~')[1]+ '~'+ myCart.split(',')[j].split('~')[2];
							productPrice += myCart.split(',')[j].split('~')[2];
							productName += getProductName(myCart.split(',')[j].split('~')[0]);
							if (j != myCart.split(',').length - 1){
								orderDetails += '@@';
								productName += ',';
								productPrice += ",";
							}
						}
					}
					//log('orderDetails..'+ orderDetails);
					//log('productName..' + productName);
					//log('productPrice..'+ productPrice);					
					var productDetails=$(this).attr('data-onlineCart');					
					if(myCart.split(',').length!=productDetails.split(',').length){
						var productNames="";
						for(var i=0;i<productDetails.split(',').length;i++){
							if($.trim(productNames)=="")
								productNames=getProductName(productDetails.split(',')[i].split('~')[0]);
							else
								productNames+=", "+getProductName(productDetails.split(',')[i].split('~')[0]);
						}
						log("productNames.."+productNames);
						/* Only:383     are available for online purchases. Do you want to proceed?:446*/
						var message = multilingualKeyValue('383','34')+" "+productNames+" "+multilingualKeyValue('446','34');
						confirmMessage=confirm(message);
						if(!confirmMessage){
							$('body').css('overflow','auto');
							return false;
						}
					}
				}
				checkTransaction(orderDetails,"cart");	
			}
			else if( profileCompletionFlag){
				/* if(paymentWindowInFrameYNCheck && $('#sessChk').val()!="" && $('#sessChk').val()!=null && profileCompletionFlag){
					openOrderWindow = window.open('',  'popup_window', 'height='+screen.height+',width='+screen.width+',scrollbars=yes,resizable=yes,dependent=yes');
					/* openOrderWindow.document.write('<div style="text-align: center; color: rgb(0, 0, 0); position: fixed; z-index: 5000; background: rgba(25, 25, 55, 0.4) none no-repeat scroll 50% 50%; width: 100%; height: 100%; display: ;" id="loader"><span style="margin-right: 5px; position: relative;"><i class="fa fa-circle-o-notch fa-spin fa-4x"></i><br><strong>Please wait</strong></span></div>'); 
				}
				else{
					$('body').css('overflow','hidden');
				} */
				proceedToPayEventHandler();
			}
			else
				iHUB.toaster.blackMessageToaster(multilingualKeyValue('447','34'));  /*  "Please complete your profile to make payment" */
		});
	}
}
function setMyPreLoginParameter(){
	store.set('prelogincart',$('#myPreLoginCart').val());
	store.set('preLoginState',location.hash);
}
function goToCatalog(){
	if($.trim($('#CatalogueContent').html())==""){
		filterSearch();
	}else{
		callOnSearch();
		if($.trim($('#openCategory .list-group').html())==""){
			var categoryLevelDetails=$('#product_catlog').data('levelDetails');
			eval('getCategoryDetails(categoryLevelDetails)');
		}
		SetBreadCrumbCatalogue();
		$('#CatalogueContent').removeClass('hidden');
		$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
		$('#openSchedule').find('.schedule-filter li').removeClass('active');
		
		showLoader();
		var searchType="";		
		var searchText="";		
		$('.yourSearch span').each(function() {		
		  if($(this).attr('data-filtered')=="txtSearchText"){		
			searchType="search"; 
			searchText=$.trim($(this).text());
		  }		
		  else{		
			  searchType="filter";		
		  }		
		});		
		if(searchType=="filter"){		
			filterSearch();	
		}		
		else{		
			$('input:radio[id="txtorderby"]:checked').each(function() {
				filterSearch();
			});		
		}
		hideLoader_iDH();
	}
}
function differentOwlCarousel(){
	$('.owl-carouselclient').owlCarousel({
		loop:false,
		margin:10,
		nav:true,
		lazyLoad:true,
		responsive:{
			0:{
				items:2
			},
			600:{
				items:3
			},
			1000:{
				items:5
			}
		}
	});
	$('.owl-carousel6').owlCarousel({
		loop: false,
		margin: 10,
		nav: true,
		lazyLoad:true,
		slideBy: 6,
		navSpeed: 500,
		responsive: {
			0: {
				items: 1
			},
			400: {
				items: 2
			},
			600: {
				items: 4
			},
			900: {
				items: 5
			},
			1000: {
				items: 6
			}
		}
	});
	$('.owl-carousel4').owlCarousel({
		loop:false,
		margin:10,
		nav:true,
		lazyLoad:true,
		responsive:{
			0:{
				items:1
			},
			600:{
				items:2
			},
			800:{
				items:3
			},
			1200:{
				items:4
			}
		}
	});
	$('.owl-carousel3').owlCarousel({
		loop:false,
		margin:10,
		nav:true,
		lazyLoad:true,
		responsive:{
			0:{
				items:1
			},
			600:{
				items:2
			},
			900:{
				items:3
			}
		}
	});
	$('.owl-carousel2').owlCarousel({
		loop:false,
		margin:10,
		nav:true,
		lazyLoad:true,
		responsive:{
			0:{
				items:1
			},
			600:{
				items:2
			},
			1000:{
				items:2
			}
		}
	});
	$('.owl-carousel1').owlCarousel({
		loop:false,
		margin:10,
		nav:true,
		lazyLoad:true,
		responsive:{
			0:{
				items:1
			},
			600:{
				items:1
			},
			1000:{
				items:1
			}
		}
	});
	$('#notification').on('shown.bs.modal', function () {
		$('.owl-carousel-1').owlCarousel({
			loop:false,
			margin:0,
			nav:true,
			lazyLoad:true,
			responsive:{
				0:{
					items:1
				},
				600:{
					items:1
				},
				1100:{
					items:1
				}
				
			}
		});
	});
}
function init(opts) {
	var $menu = $(this),
		activeRow = null,
		mouseLocs = [],
		lastDelayLoc = null,
		timeoutId = null,
		options = $.extend({
			rowSelector: "> li",
			submenuSelector: "*",
			submenuDirection: "right",
			tolerance: 75,
			enter: $.noop,
			exit: $.noop,
			activate: $.noop,
			deactivate: $.noop,
			exitMenu: $.noop
		}, opts);
	var MOUSE_LOCS_TRACKED = 3,
		DELAY = 300;
	var mousemoveDocument = function(e) {
			mouseLocs.push({x: e.pageX, y: e.pageY});
			if (mouseLocs.length > MOUSE_LOCS_TRACKED) {
				mouseLocs.shift();
			}
		};
	var mouseleaveMenu = function() {
			if (timeoutId) {
				clearTimeout(timeoutId);
			}
			if (options.exitMenu(this)) {
				if (activeRow) {
					options.deactivate(activeRow);
					return true;
				}
				activeRow = null;
			}
		};
	var mouseenterRow = function() {
			if (timeoutId) {
				clearTimeout(timeoutId);
			}
			options.enter(this);
			possiblyActivate(this);
		},
		mouseleaveRow = function() {
			options.exit(this);
		};
	var clickRow = function() {
			activate(this);
		};
	var activate = function(row) {
			if (row == activeRow) {
				return;
			}
			if (activeRow) {
				options.deactivate(activeRow);
			}
			options.activate(row);
			activeRow = row;
		};
	var possiblyActivate = function(row) {
			var delay = activationDelay();
			if (delay) {
				timeoutId = setTimeout(function() {
					possiblyActivate(row);
				}, delay);
			} else {
				activate(row);
			}
		};
	var activationDelay = function() {
			if (!activeRow || !$(activeRow).is(options.submenuSelector)) {
				return 0;
			}
			var offset = $menu.offset(),
				upperLeft = {
					x: offset.left,
					y: offset.top - options.tolerance
				},
				upperRight = {
					x: offset.left + $menu.outerWidth(),
					y: upperLeft.y
				},
				lowerLeft = {
					x: offset.left,
					y: offset.top + $menu.outerHeight() + options.tolerance
				},
				lowerRight = {
					x: offset.left + $menu.outerWidth(),
					y: lowerLeft.y
				},
				loc = mouseLocs[mouseLocs.length - 1],
				prevLoc = mouseLocs[0];

			if (!loc) {
				return 0;
			}
			if (!prevLoc) {
				prevLoc = loc;
			}
			if (prevLoc.x < offset.left || prevLoc.x > lowerRight.x ||
				prevLoc.y < offset.top || prevLoc.y > lowerRight.y) {
				return 0;
			}
			if (lastDelayLoc &&
				loc.x == lastDelayLoc.x && loc.y == lastDelayLoc.y) {
				return 0;
			}
			function slope(a, b) {
				return (b.y - a.y) / (b.x - a.x);
			};
			var decreasingCorner = upperRight,
				increasingCorner = lowerRight;
			if (options.submenuDirection == "left") {
				decreasingCorner = lowerLeft;
				increasingCorner = upperLeft;
			} else if (options.submenuDirection == "below") {
				decreasingCorner = lowerRight;
				increasingCorner = lowerLeft;
			} else if (options.submenuDirection == "above") {
				decreasingCorner = upperLeft;
				increasingCorner = upperRight;
			}
			var decreasingSlope = slope(loc, decreasingCorner),
				increasingSlope = slope(loc, increasingCorner),
				prevDecreasingSlope = slope(prevLoc, decreasingCorner),
				prevIncreasingSlope = slope(prevLoc, increasingCorner);
			if (decreasingSlope < prevDecreasingSlope && increasingSlope > prevIncreasingSlope) {
				lastDelayLoc = loc;
				return DELAY;
			}
			lastDelayLoc = null;
			return 0;
		};
	$menu
		.mouseleave(mouseleaveMenu)
		.find(options.rowSelector)
			.mouseenter(mouseenterRow)
			.mouseleave(mouseleaveRow)
			.click(clickRow);
	$(document).mousemove(mousemoveDocument);
}
function custom_marketplace(){
	if(micrositeCheck)
		differentOwlCarousel();
	$('#CreateModal').on('shown.bs.modal', function () {
		$('.demo1').bootstrapResponsiveTabs({
			minTabWidth: 30,
			maxTabWidth: 220
		});
	});
	$('.tabDropdowns').on('show.bs.dropdown', function() {
		$('.project-overlay').show();
	});
	$('.tabDropdowns').on('hidden.bs.dropdown', function() {
		$('.project-overlay').hide();
	});
	$('.notify .close').on("click",function() {
		$('.notify').removeClass('shownoti');
	});
}
/* function flashfunc(){
	setTimeout(function() { 
		$('#flashpopup').modal('show');
		$('<div class="modal-backdrop in"></div>').appendTo(document.body); }
	, 500);
} */
function initiateLoader(){
	if(getwidth<70 && 70>(Math.floor(Number($('.nanoln').width() / $('.nanoln').parent().width() * 100)))){
		$('.nanoln').css('transition','all 0.5s');
		widthper=getwidth+'%';
		$('.nanoln').width(widthper);
		getwidth=getwidth+20;
		setTimeout(function() {
			initiateLoader();
		},200);
	} 
	else if(getwidth<90 && 90>(Math.floor(Number($('.nanoln').width() / $('.nanoln').parent().width() * 100)))){
		widthper=getwidth+'%';
		$('.nanoln').css('transition','all 1.5s');
		$('.nanoln').width(widthper);
		getwidth=getwidth+10;
		setTimeout(function() {
			initiateLoader();
		},200);
	}
	else if(getwidth<95 && 95>(Math.floor(Number($('.nanoln').width() / $('.nanoln').parent().width() * 100)))){ 
		widthper=getwidth+'%';
		$('.nanoln').css('transition','all 1.5s');
		$('.nanoln').width(widthper);
		getwidth=getwidth+5;
		setTimeout(function() {
			initiateLoader();
		},200);
	}
	else if(getwidth==100){
		$('.nanoln').css('transition','all 0s');
		$('.nanoln').width('100%');
		setTimeout(function() {
			$(".nanoln").css('visibility','hidden');
		},100);
	}
}
function showLoader(){
	getwidth=30;
	$('.nanoln').width('30%');
	$(".nanoln").css('visibility','visible');		
	initiateLoader();
	setTimeout(function() {
		if($('#loader').text()!="Your session expired. Click to relogin")
			$("#loader").hide();
	},30000);
}
function hideLoader_iDH(){
	getwidth=100;
	initiateLoader();
	$("#loader").hide();
	manageFooter();
}
function hideLoader(){
	getwidth=100;
	initiateLoader();
	$("#loader").hide();
	manageFooter();
}
function hideMicrosite(){
	$('#myRequestMicrosite').addClass('hidden');
	$('#myRequestMicrositeParent').html('');
}
function goBackButton(){
	$(this).parent().parent().parent().find('i').show();
}
function getLanguageForMicrosite(){
	if(languageDetails==undefined)
		languageDetails=getLanguageDetails();
	var language={};
	if(languageDetails==undefined){
		language["languageId"]='1';
		language["languageName"]='English';
	}else{
		language["languageId"]=languageDetails[languageId]["lanid"];
		language["languageName"]=languageDetails[languageId]["lanname"];
	}
	var a=[{action:"getLanguageResponse"},{languageDetails:language}];
	if($('#myRequestMicrosite').length>0){
		document.getElementById('myRequestMicrosite').contentWindow.postMessage(a,'*');
	}
	else
		return a;
}
$(window).on('message', function(e){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	var messageReceived=e.originalEvent.data;
	log(messageReceived);
	if(typeof messageReceived[0] == "object" && $.trim(messageReceived[0])!=""){
		if(messageReceived[0].action=="micrositeHeader"){
			if(messageReceived[1]!=null && messageReceived[1]!="" && messageReceived[1]!=undefined && messageReceived[2]["headerHTML"]!=undefined && messageReceived[2].headerHTML!="" && messageReceived[2]["headerHTML"]!=null){
				$('#micrositeHeadContent').html('');
				$('#micrositeHeadContent').html($.trim(messageReceived[2]["headerHTML"]));
				micrositeHeaderArray=[],micrositeHeaderHeightArray=[];
				for(label in messageReceived[1]){
					if(label.toLowerCase().indexOf('height') > -1)
						micrositeHeaderHeightArray.push(messageReceived[1][label]);
					else
						micrositeHeaderArray.push(messageReceived[1][label]);
				}
				setMyPosition();
			}
		}
		else if(messageReceived[0].action=="redirectToCatalogue"){
			if(messageReceived[1].fields!=null && messageReceived[1].fields!=undefined && messageReceived[2].variables!=undefined && messageReceived[2].variables!=null){
				createMySearchLabels(messageReceived[1].fields,messageReceived[2].variables);
				createCatalogueDataRequest(messageReceived[1].fields,messageReceived[2].variables);
			}
		}
		else if(messageReceived[0].action=="micrositeCatalogueRequest"){
			if(messageReceived[1].fields!=null && messageReceived[1].fields!=undefined && messageReceived[2].variables!=undefined && messageReceived[2].variables!=null && messageReceived[3].recordCount!=null && messageReceived[3].recordCount!=undefined && messageReceived[3].recordCount!=""){
				micrositeCatalogueRequest(messageReceived[1].fields,messageReceived[2].variables,messageReceived[3].recordCount);
			}
		}
		else if(messageReceived[0].action=="micrositeAnalytics"){
			if(messageReceived[1].micrositeAction!=null && messageReceived[1].micrositeAction!=undefined && messageReceived[2].productId!=undefined && messageReceived[2].productId!=null && messageReceived[3].productName!=null && messageReceived[3].productName!=undefined && messageReceived[3].productName!=""){
				hitAnalytics("Microsite",messageReceived[1].micrositeAction,messageReceived[2].productId+" - "+messageReceived[3].productName);
			}
		}
		else if(messageReceived[0].action=="refundCheck"){
			if(messageReceived[1].productId!=null && messageReceived[1].productId!=undefined){
				refundCheck('microsite',messageReceived[1].productId);
			}
		}
		else if(messageReceived[0].action=="parentURL"){
			MicrositeParentURLResponse();
		}
		else if(messageReceived[0].action=="getLanguage"){
			var language={};
			language["languageId"]=languageDetails[languageId]["lanid"];
			language["languageName"]=languageDetails[languageId]["lanname"];
			var a=[{action:"getLanguageResponse"},{languageDetails:language}];
			if($('#myRequestMicrosite').length>0){
				document.getElementById('myRequestMicrosite').contentWindow.postMessage(a,'*');
			}
			else
				return a;
		}
		else if(messageReceived[0].action=="communicateWithParent"){
			if(typeof customCommunicateWithParent == 'function')
				customCommunicateWithParent(messageReceived[1],messageReceived[2]);
			else
				communicateWithParent(messageReceived[1],messageReceived[2]);
		}
		else if(messageReceived[0].action=="3093DATA"){
			if(currencyDetails==null || currencyDetails!=undefined || $.trim(currencyDetails)=="")
				currencyDetails=getCurrencyDetails();
			var eformsLinks="";
				if($('#eformsLinks').length > 0){
					eformsLinks=$.trim($('#eformsLinks').val());
				}
			if(messageReceived[1].frame=="1"){			
				document.getElementById('myOrderFrame').contentWindow.postMessage([{action:"3093DATAResponse",currencyDetails:currencyDetails,languageDetails:languageDetails,eformsLinks:eformsLinks}], "*");
			}
			else{
				openOrderWindow.postMessage([{action:"3093DATAResponse",currencyDetails:currencyDetails,languageDetails:languageDetails,eformsLinks:eformsLinks}], "*");
			}
		}
		else if(messageReceived[0].action=="closeOrderForm"){
			log("closeOrderForm txtUsrRole..."+messageReceived);
			closeOrderForm(messageReceived);
		}
		else if(messageReceived[0].action=="3093SuccessDATA"){
			if(messageReceived[1].frame=="1"){
				document.getElementById('myOrderFrame').contentWindow.postMessage([{action:"3093SuccessDATAResponse",orgID:orgID,instanceId:instanceId}], "*");
			}
			else{
				openOrderWindow.postMessage([{action:"3093SuccessDATAResponse",orgID:orgID,instanceId:instanceId}], "*");
			}
		}
		else if(messageReceived[0].action=="getCustomHTMLformInstance"){
			if(messageReceived[1].htmlName!=null && messageReceived[1].htmlName!=undefined && $.trim(messageReceived[1].htmlName)!="" && messageReceived[2].newWindow!=null && messageReceived[2].newWindow!=undefined && $.trim(messageReceived[2].newWindow)!="" && messageReceived[3].orgID!=null && messageReceived[3].orgID!=undefined && $.trim(messageReceived[3].orgID)!="" && messageReceived[4].instanceID!=null && messageReceived[4].instanceID!=undefined && $.trim(messageReceived[4].instanceID)!=""){
				getCustomHTMLformInstance($.trim(messageReceived[0].htmlName),$.trim(messageReceived[1].newWindow));
			}		
		}
		else if(messageReceived[0].action=="isDisPubHC"){
			document.getElementById('helpCenterManagement').contentWindow.postMessage([{action:"isDisPubHCResponse"},{distributor:isDisAvailable},{publisher:isPubAvailable}], "*");
		}
		else if(messageReceived[0].action=="helpCenterHeight"){
			if(messageReceived[1].height!="" && messageReceived[1].height!=undefined){
				$('#helpCenterManagement').attr('style','height:'+(Number(messageReceived[1].height)+15)+'px');
				manageFooter();
			}
		}
		else if(messageReceived[0].action=="fetchProductsTaggedToPublisher"){
			if(messageReceived[1].txtOrgId!="" && messageReceived[1].txtOrgId!=undefined){
				fetchProductsTaggedToPublisher(messageReceived[1].txtOrgId,messageReceived[2].recordCount);
			}
		}	
		else if(messageReceived[0].action=="fetchProductsTaggedToDistributor"){
			if(messageReceived[1].txtOrgId!="" && messageReceived[1].txtOrgId!=undefined){
				fetchProductsTaggedToDistributor(messageReceived[1].txtOrgId,messageReceived[2].recordCount);
			}
		}	
		else if(messageReceived[0].action=="showRefundInformation"){
			if(messageReceived[1].productId!="" && messageReceived[1].productId!=undefined){
				showRefundInformation(messageReceived[1].productId);
			}
		}	
		else if(messageReceived[0].action=="distributorUserPurchasesForProduct"){
			if(messageReceived[1].productId!="" && messageReceived[1].productId!=undefined){
				distributorUserPurchasesForProduct(messageReceived[1].productId);
			}
		}
		else if(messageReceived[0].action=="connectToPublisherFromMicrosite"){
			if(messageReceived[1].productId!="" && messageReceived[1].productId!=undefined && messageReceived[2].productName!="" && messageReceived[2].productName!=undefined && messageReceived[3].publisherId!="" && messageReceived[3].publisherId!=undefined && messageReceived[4].publisherName!="" && messageReceived[4].publisherName!=undefined){
				connectToPublisher(messageReceived[1].productId,messageReceived[2].productName,messageReceived[3].publisherId,messageReceived[4].publisherName);
			}
		}
		else if(messageReceived[0].action=="postEformSubmission"){
			if(typeof postEformSubmission == 'function')
				postEformSubmission();
		}
	}
	else if(typeof messageReceived == 'string'){
		var createDataPattern=messageReceived.split('@~@');
		if(createDataPattern[0]=="addToCart" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined && createDataPattern[3]!=undefined)
			addtoCartEventHandler(createDataPattern[1],createDataPattern[2],createDataPattern[3]);
		if(createDataPattern[0]=="removeFromCart" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined)
			removeFromCartEventHandler(createDataPattern[1],createDataPattern[2]);
		if(createDataPattern[0]=="buyNow" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!=""  && createDataPattern[2]!=undefined && createDataPattern[3]!=undefined)
			buyNowEventHandler(createDataPattern[1],createDataPattern[2],createDataPattern[3]);
		if(createDataPattern[0]=="subscribeFreeProducts" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined)
			subscribeInitiateEventHandler(createDataPattern[1],createDataPattern[2]);
		if(createDataPattern[0]=="activateLicense" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined)
			activateLicenseInitiateEventHandler(createDataPattern[1],createDataPattern[2]);
		if(createDataPattern[0]=="proceedToPayPostBuyNow" && createDataPattern[1]!=""  && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined)
			proceedToPayPostBuyNow(createDataPattern[1],createDataPattern[2],createDataPattern[3]);
		if(createDataPattern[0]=="recommendedProductsForMicrosite" && createDataPattern[1]!="")
			recommendedProductsForMicrosite(createDataPattern[1]);
		if(createDataPattern[0]=="fetchPublisher" && createDataPattern[1]!="" && createDataPattern[1]!=undefined)
			fetchPublisher(createDataPattern[1]);
		if(createDataPattern[0]=="fetchDistributor" && createDataPattern[1]!="" && createDataPattern[1]!=undefined)
			fetchDistributor(createDataPattern[1]);
		if(createDataPattern[0]=="viewMicrositeEventHandlerForMicrosite" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined)
			viewMicrositeEventHandlerForMicrosite(createDataPattern[1],createDataPattern[2],createDataPattern[3],createDataPattern[4],createDataPattern[5]);
		if(createDataPattern[0]=="requestUserDetailsForMicrosite")
			requestUserDetailsForMicrosite();
		if(createDataPattern[0]=="requestUserDetails")		
			requestUserDetails();
		if(createDataPattern[0]=="requestCompleteUserDetailsForMicrosite")
			requestCompleteUserDetailsForMicrosite();
		if(createDataPattern[0]=="fetchChildProductsForMicrosite" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined && createDataPattern[3]!="" && createDataPattern[3]!=undefined)
			fetchChildProducts(createDataPattern[1],createDataPattern[2].replace(/,/g,"@~@"),createDataPattern[3].replace(/,/g,"@~@"));
		if(createDataPattern[0]=="fetchSimilarProductsForMicrosite" && createDataPattern[1]!="" && createDataPattern[1]!=undefined)
			fetchSimilarProductsForMicrosite(createDataPattern[1],createDataPattern[2].replace(/,/g,"@~@"),createDataPattern[3].replace(/,/g,"@~@"));
		if(createDataPattern[0]=="micrositeHeight"  && createDataPattern[1]!=""){
			$('#myRequestMicrosite').attr('style','height:'+(Number(createDataPattern[1])+15)+'px');
			manageFooter();
		}
		if(createDataPattern[0]=="micrositeNavigation" && createDataPattern[1]!="" && createDataPattern[2]!="")		
			$('html, body').animate({scrollTop: Number(createDataPattern[1])}, ((Number(createDataPattern[2]) / 100) * 150));
		if(createDataPattern[0]=="userLogin")
			checkMyPage();
		if(createDataPattern[0]=="goToCart")		
			$('.generateCart').click();
		if(createDataPattern[0]=="addToWishlist" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined && createDataPattern[3]!=undefined){
			if($('#sessChk').length>0){
				var decideChangeClass=purchaseActivity("addToWishlist",createDataPattern[1],"","",createDataPattern[3],createDataPattern[2]);
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("addToWishlistResponse"+"@~@"+createDataPattern[1]+"@~@"+decideChangeClass,"*");
				}
			}
			else
				checkMyPage();
		}
		if(createDataPattern[0]=="removeFromWishlist" && createDataPattern[1]!="" && createDataPattern[1]!=undefined && createDataPattern[2]!="" && createDataPattern[2]!=undefined && createDataPattern[3]!=undefined){
			if($('#sessChk').length>0){
				var decideChangeClass=purchaseActivity("removeFromWishlist",createDataPattern[1],"","",createDataPattern[3],createDataPattern[2]);
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("removeFromWishlistResponse"+"@~@"+createDataPattern[1]+"@~@"+decideChangeClass,"*");
				}
			}
			else
				checkMyPage();
		}
		if(createDataPattern[0]=="requestOrderDetails"){		
			var orgID1=document.getElementsByName("orgId")[0].value;
			createMyOrderPage();
		}
		if(createDataPattern[0]=="distributorPriceForAProduct" && createDataPattern[1]!="" && createDataPattern[1]!="undefined"){
			if($('#txtUsrRole').val()=="Distributor"){
				var price = getMeDiscountPercentageForMyProduct($.trim(createDataPattern[1]));
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("distributorPriceForAProductResponse"+"@~@"+createDataPattern[1]+"@~@"+price,"*");
				}
			}
			else
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("distributorPriceForAProductResponse"+"@~@"+createDataPattern[1]+"@~@Not in a distributor role","*");
				}
		}
		if(createDataPattern[0]=="getUserTypeForMicrosite"){
			if($('#txtUsrRole').val()=="Distributor"){
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("getUserTypeForMicrositeResponse@~@distributor","*");
				}
			}
			else{
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("getUserTypeForMicrositeResponse@~@learner","*");
				}
			}
		}
		if(createDataPattern[0]=="defaultPageRedirection"){
			log("defaultPageUK called");
			store.set('defaultPage',createDataPattern[1]);
		}
		if(createDataPattern[0]=="requestProductDetails" && $.trim(createDataPattern[1])!="" ){
			if($.trim(masterform_id)=="")
				masterform_id=$('#userFormId').val();
			if($('#sessChk').length==0)
				sessChk="";
			else
				sessChk=$('#sessChk').val();
			productIds=$.trim(createDataPattern[1]);
			$.ajax({
				type: "POST",
				url: url,
				data: {
					orgID:orgID,
					masterform_id:masterform_id,
					sessChk:sessChk,
					txtInstanceId:instanceId,
					languageId:languageId,
					productId:productIds,
					subAction:"getListofproducts"
				},
				dataType: "json",
				/* async:false, */
				success: function(result){
					var condn=iHUB.checkSessionOrToken(result);
					if(eval(condn)){
						if($('#myRequestMicrosite').length>0){
							document.getElementById('myRequestMicrosite').contentWindow.postMessage("requestProductDetailsResponse"+"@~@"+createDataPattern[1]+"@~@"+JSON.stringify(result),"*");
						}
					}
				},
				error: function(x, e){
					if(e=="parsererror" && x.responseText=="session is not avaliable"){
						$('#toaster').html('');
						iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
						createLoginLoader();
						fnLogoutICMP('1');
						return false;
					}
				}
			});
		}
		if(createDataPattern[0]=="requestRatingDetails" && $.trim(createDataPattern[1])!="" ){
			var productId=$.trim(createDataPattern[1]);
			if($.trim(masterform_id)=="")
				masterform_id=$('#userFormId').val();
			$.ajax({
				type: "POST",
				url: url,
				data: {
					orgID:orgID,
					txtInstanceId:instanceId,
					languageId:languageId,
					productId:productId,
					app_seq_no:app_seq_no,
					subAction:"requestRatingDetails"
				},
				dataType: "json",
				/* async:false, */
				success: function(result){
					var condn=iHUB.checkSessionOrToken(result);
					if(eval(condn)){
						if($('#myRequestMicrosite').length>0){
							document.getElementById('myRequestMicrosite').contentWindow.postMessage("requestRatingDetailsResponse"+"@~@"+createDataPattern[1]+"@~@"+JSON.stringify(result),"*");
						}
					}
				},
				error: function(x, e){
					if(e=="parsererror" && x.responseText=="session is not avaliable"){
						$('#toaster').html('');
						iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
						createLoginLoader();
						fnLogoutICMP('1');
						return false;
					}
				}
			});
		}
		if(createDataPattern[0]=="saveRatingDetailToForm" && $.trim(createDataPattern[1])!="" && $.trim(createDataPattern[2])!="" ){
			var ratingDetails=$.trim(createDataPattern[1]).toString();
			log("ratingDetails..."+ratingDetails);
			var productId=$.trim(createDataPattern[2]);
			saveRatingDetailToForm(productId,ratingDetails);
		}
		if(createDataPattern[0]=="requestReviewDetails" && $.trim(createDataPattern[1])!="" ){
			var productId=$.trim(createDataPattern[1]);
			var recordsPerPage=$.trim(createDataPattern[2]);
			var pageNo=$.trim(createDataPattern[3]);
			if($.trim(masterform_id)=="")
				masterform_id=$('#userFormId').val();
			$.ajax({
				type: "POST",
				url: url,
				data: {
					orgID:orgID,
					txtInstanceId:instanceId,
					languageId:languageId,
					productId:productId,
					app_seq_no:app_seq_no,
					recordsPerPage:recordsPerPage,
					pageNo:pageNo,
					subAction:"requestReviewDetails"
				},
				dataType: "json",
				/* async:false, */
				success: function(result){
					var condn=iHUB.checkSessionOrToken(result);
					if(eval(condn)){
						if($('#myRequestMicrosite').length>0){
							document.getElementById('myRequestMicrosite').contentWindow.postMessage("requestReviewDetailsResponse"+"@~@"+createDataPattern[1]+"@~@"+JSON.stringify(result),"*");
						}
					}
				},
				error: function(x, e){
					if(e=="parsererror" && x.responseText=="session is not avaliable"){
						$('#toaster').html('');
						iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
						createLoginLoader();
						fnLogoutICMP('1');
						return false;
					}
				}
			});
		}
		if(createDataPattern[0]=="getOrderDataForPrint" && $.trim(createDataPattern[1])!="" ){
			orderReceiptPage.postMessage([{action:"getOrderDataForPrintResponse"},{orderData:orderArray}],"*");
		}
		if(createDataPattern[0]=="helpCenter" && $.trim(createDataPattern[1])!="" && $.trim(createDataPattern[2])!=""){
			openHelpCenterModal(app_seq_no,$.trim(createDataPattern[1]),'','2016-11-21 18:20:23.0',$.trim(createDataPattern[2]));
		}
	}
});
function saveRatingDetailToForm(productId,ratingDetails){	
	var tokenId=iHUB.token.get();/* $('#tokenId').val(); */
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			languageId:languageId,
			txtproductId:productId,
			app_seq_no:app_seq_no,
			tokenId:tokenId,
			ratingDetails:ratingDetails,
			subAction:"saveRatingDetailToForm"
		},
		dataType: "json",
		/* async:false, */
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				iHUB.token.set(JSON.parse(JSON.stringify(result)).responseDetails.token);/* $('#tokenId').val(JSON.parse(JSON.stringify(result)).responseDetails.token); */
				$('#toaster').html('');
				var splitDet=ratingDetails.split('~@~');
				if(JSON.parse(JSON.stringify(result)).responseDetails.message=="Rating data saved successfully"){
					if(splitDet.length==2 && splitDet[1].indexOf('isRecommended') > -1){
						iHUB.toaster.blackMessageToaster(multilingualKeyValue('50','34'));/*Thank you for your recommendation. Your recommendation will be added shortly.:50 */
					}
					else if(splitDet.length==2 && splitDet[1].indexOf('rating') > -1){
						iHUB.toaster.blackMessageToaster(multilingualKeyValue('51','34'));/*Thank you for providing your Rating:51 */
					}
					else{
						iHUB.toaster.blackMessageToaster(multilingualKeyValue('52','34'));/*Review saved successfully:52 */
					}
				}
				else{
					iHUB.toaster.blackMessageToaster(JSON.parse(JSON.stringify(result)).responseDetails.message);
				}
				/* if(JSON.parse(JSON.stringify(result)).responseDetails.message=="Rating data saved successfully"){ */
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("refreshRatingDetails","*");
				}
				else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					requestRatingDetails();
				}
				if (typeof postReviewSave == 'function'){  
					postReviewSave(result);
				}
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		},
		complete:function(){
			
		}
	});
}
function requestUserDetailsForMicrosite(){
	if($('#sessChk').val()!="" && $('#sessChk').val()!=null){
		var cart="";
		productIds=$('#txtCart').val().split(',');
		for(var i=0;i<productIds.length;i++){
			if(cart=="")
				cart=productIds[i].split('~')[0];
			else
				cart+=","+productIds[i].split('~')[0];
		}
		$('#userId').val($('#app_seq_no').val());
		$('#cart').val(cart);
		if($('#myRequestMicrosite').length>0){
			document.getElementById('myRequestMicrosite').contentWindow.postMessage("requestUserDetailsForMicrositeResponse"+"@~@"+"userId="+$('#app_seq_no').val()+"@~@cart="+cart,"*");
		}else{
			if (typeof getUserDetailsForMicrositeCustom == 'function'){
				getUserDetailsForMicrositeCustom("userId="+$('#app_seq_no').val()+"@~@cart="+cart);
			}else{
				getUserDetailsForMicrosite("userId="+$('#app_seq_no').val()+"@~@cart="+cart);
			}
		}
	}
	else{
		if($('#myRequestMicrosite').length>0){
			document.getElementById('myRequestMicrosite').contentWindow.postMessage("requestUserDetailsForMicrositeResponse@~@No logged in user available.","*");
		}
		else{
			if (typeof getUserDetailsForMicrositeCustom == 'function'){
				getUserDetailsForMicrositeCustom("No logged in user available.");
			}else{
				getUserDetailsForMicrosite("No logged in user available.");
			}
		}
	}
}
function requestUserDetails(){		
	if($('#sessChk').val()!="" && $('#sessChk').val()!=null){		
		var cart="";		
		productIds=$('#txtCart').val().split(',');		
		for(var i=0;i<productIds.length;i++){		
			if(cart=="")		
				cart=productIds[i].split('~')[0];		
			else		
				cart+=","+productIds[i].split('~')[0];		
		}
		if($('#myRequestMicrosite').length>0){		
			document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"requestUserDetailsResponse"},{message:"logged in"},{userId:$('#app_seq_no').val()},{cart:cart}],"*");		
		}
		else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
			var messageReceived=[{action:"requestUserDetailsResponse"},{message:"logged in"},{userId:$('#app_seq_no').val()},{cart:cart}];
			if (typeof customRefundCheckResponse == 'function')  
				customRequestUserDetailsResponse(messageReceived);
			else
				requestUserDetailsResponse(messageReceived);
		}
	}		
	else{
		var cart="";		
		productIds=$('#txtCart').val().split(',');		
		for(var i=0;i<productIds.length;i++){		
			if(cart=="")		
				cart=productIds[i].split('~')[0];		
			else		
				cart+=","+productIds[i].split('~')[0];		
		}
		if($('#myRequestMicrosite').length>0){
			document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"requestUserDetailsResponse"},{message:"No logged in user available."},{cart:cart}],"*");		
		}
		else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
			var messageReceived=[{action:"requestUserDetailsResponse"},{message:"No logged in user available."},{cart:cart}];
			if (typeof customRefundCheckResponse == 'function')  
				customRequestUserDetailsResponse(messageReceived);
			else
				requestUserDetailsResponse(messageReceived);
		}
	}		
}
function requestCompleteUserDetailsForMicrosite(){
	if($('#sessChk').val()!="" && $('#sessChk').val()!=null){
		var fieldList=["app_seq_no","txtFirstName","txtLastName","txtCountry","txtProfileId","txtEmail","txtPincode","txtPhoneNumber","txtDateOfBirth","txtSalutation","txtGender","txtMiddleName","txtDisplayName","txtSpecialization","txtInstanceId","txtLoginId","txtOrgId"];
		var userdetails="";
		userdetails=userdetails.concat("cart<value>"+$('#txtCart').val());
		for(var i=0;i<fieldList.length;i++){
			if(fieldList[i]=="txtOrgId")
				userdetails=userdetails.concat("@-@"+fieldList[i]+"<value>"+$('#'+fieldList[i]+'_div').val());
			else
				userdetails=userdetails.concat("@-@"+fieldList[i]+"<value>"+$('#'+fieldList[i]+'_div').html());
		}
		if($('#myRequestMicrosite').length>0){
			document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"requestCompleteUserDetailsForMicrositeResponse"},{message:"logged in"},{userdetails:userdetails}],"*");
		}
		else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
			var response=[{action:"requestCompleteUserDetailsForMicrositeResponse"},{message:"logged in"},{userdetails:userdetails}];
			if (typeof getCompleteUserDetailsForMicrositeCustom == 'function'){ 
				getCompleteUserDetailsForMicrositeCustom(response);
			}else{
				setCompleteUserDetailsForMicrosite(response);
			}
		}
	}
	else{
		if($('#myRequestMicrosite').length>0){
			var userdetails="";
			userdetails=userdetails.concat("cart<value>"+$('#txtCart').val());
			document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"requestCompleteUserDetailsForMicrositeResponse"},{message:"No logged in user available."},{userdetails:userdetails}],"*");
		}
		else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
			var response=[{action:"requestCompleteUserDetailsForMicrositeResponse"},{message:"No logged in user available."},{userdetails:userdetails}];
			if (typeof getCompleteUserDetailsForMicrositeCustom == 'function'){ 
				getCompleteUserDetailsForMicrositeCustom(response);
			}else{
				setCompleteUserDetailsForMicrosite(response);
			}
		}
	}
}
function getFullShortURLPath(shortUrl){
	var path="";
	if($.trim(shortUrl)!=""){
		if(shortUrl.indexOf("https:")>-1 || shortUrl.indexOf("http:")>-1)
			path=shortUrl;
		else{
			var arr=shortUrl.split("/");
			for(var i = 0; i < arr.length; i++) {
				if(arr[i]!="") {
					if(path=="")
						path += arr[i];
					else
						path += "/" + arr[i];
				}
			}
			/* path=window.location.protocol+"//"+window.location.host+"/"+path; */
			path="/"+path+"/";
		}
	}
	return path;
}
function viewMicrositeEventHandler(){
	if($('.viewMicrosite').length>0){
		$('button:button[id="viewMicrosite"]').on('click',function() {
			viewMicrositeEventHandlerForMicrositeNew($(this).attr("data-id"),$(this).attr("data-name"),$(this).attr("data-link"),$(this).attr("data-shortUrl"),$(this).attr("data-iframe"));
			/* if(!(($.trim($(this).attr('data-iframe'))=="0" || $.trim($(this).attr('data-iframe'))=="3") && $.trim($(this).attr('data-shortUrl'))!="")){
				if($(this).attr("data-link")!=""){
					callOnSearch();
					if($('#micrositeContent').length>0){
						if(!$('#micrositeContent').hasClass('hidden'))
							$('#micrositeContent').addClass('hidden')
					}
					$('.bredcrum').removeClass('hidden');
					$('#myRequestMicrositeParent').removeClass('hidden');
					$('#micrositeHeadContent').removeClass('hidden');
					$('#micrositeHeadContent').html('');
					micrositeCheck=true;
					if($(this).attr("data-name").length>100)
						$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="mkpc1" data-b="Home" style="cursor:pointer;">'+iHUB.multilingual.gmv('mkpc1')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i><a onclick="goToCatalog();" style="cursor:pointer;" data-a="mkpc13" data-b="Catalogue">'+iHUB.multilingual.gmv('mkpc13')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>'+$(this).attr("data-name").substring(0,100)+'...');
					else
						$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="mkpc1" data-b="Home" style="cursor:pointer;">'+iHUB.multilingual.gmv('mkpc1')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i><a onclick="goToCatalog();" style="cursor:pointer;" data-a="mkpc13" data-b="Catalogue">'+iHUB.multilingual.gmv('mkpc13')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>'+$(this).attr("data-name")+'');
					$('#myRequestMicrositeParent').html('<iframe src="'+$(this).attr("data-link")+'" id="myRequestMicrosite" style="background : #eee url(\'/iDH/dashboard/images/iHUBLoader.gif\') no-repeat scroll 50% 27%;" allowfullscreen="allowfullscreen" mozallowfullscreen="mozallowfullscreen" msallowfullscreen="msallowfullscreen" oallowfullscreen="oallowfullscreen" webkitallowfullscreen="webkitallowfullscreen" frameborder="0"></iframe>');
					$('#myRequestMicrosite').attr('data-name',$(this).attr("data-name"));
					$('#myRequestMicrosite').attr('data-desc',$(this).attr("data-desc"));
					$('#myRequestMicrosite').attr('data-id',$(this).attr("data-id"));
					$('#myRequestMicrosite').removeClass('hidden');
					setLinkHash(instanceId+"@IID@Home/Catalogue=redirectTo~@~&subAction=viewMicrosite&Link="+$(this).attr("data-link")+"&id="+$(this).attr("data-id")+"&name="+$(this).attr("data-name").replace(/ /g, '+'));
					$(window).scrollTop(0);
				}
			}
			else if(($.trim($(this).attr('data-iframe'))=="0" || $.trim($(this).attr('data-iframe'))=="3") && $.trim($(this).attr('data-shortUrl'))!=""){
				var prodId=$(this).attr("data-name");
				var shortUrl=$.trim($(this).attr('data-shortUrl'));
				var path=getFullShortURLPath(shortUrl);
				window.location = path;
			}
			hitAnalyticsCheck("View","View microsite",$(this).attr("data-id")+" - "+$(this).attr("data-name")); */
		});
		$('.viewMicrosite').on('click',function() {
			viewMicrositeEventHandlerForMicrositeNew($(this).attr("data-id"),$(this).attr("data-name"),$(this).attr("data-link"),$(this).attr("data-shortUrl"),$(this).attr("data-iframe"));
			/* if(!(($.trim($(this).attr('data-iframe'))=="0" || $.trim($(this).attr('data-iframe'))=="3") && $.trim($(this).attr('data-shortUrl'))!="")){
				if($(this).attr("data-link")!=""){
					callOnSearch();
					if($('#micrositeContent').length>0){
						if(!$('#micrositeContent').hasClass('hidden'))
							$('#micrositeContent').addClass('hidden')
					}
					$('.bredcrum').removeClass('hidden');
					$('#myRequestMicrositeParent').removeClass('hidden');
					$('#micrositeHeadContent').removeClass('hidden');
					$('#micrositeHeadContent').html('');
					micrositeCheck=true;
					if($(this).attr("data-name").length>100)
						$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="mkpc1" data-b="Home" style="cursor:pointer;">'+iHUB.multilingual.gmv('mkpc1')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i><a onclick="goToCatalog();" style="cursor:pointer;" data-a="mkpc13" data-b="Catalogue">'+iHUB.multilingual.gmv('mkpc13')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>'+$(this).attr("data-name").substring(0,100)+'...');
					else
						$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="mkpc1" data-b="Home" style="cursor:pointer;">'+iHUB.multilingual.gmv('mkpc1')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i><a onclick="goToCatalog();" style="cursor:pointer;" data-a="mkpc13" data-b="Catalogue">'+iHUB.multilingual.gmv('mkpc13')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>'+$(this).attr("data-name")+'');
					$('#myRequestMicrositeParent').html('<iframe src="'+$(this).attr("data-link")+'" id="myRequestMicrosite" style="background : #eee url(\'/iDH/dashboard/images/iHUBLoader.gif\') no-repeat scroll 50% 27%" allowfullscreen="allowfullscreen" mozallowfullscreen="mozallowfullscreen" msallowfullscreen="msallowfullscreen" oallowfullscreen="oallowfullscreen" webkitallowfullscreen="webkitallowfullscreen" frameborder="0"></iframe>');
					$('#myRequestMicrosite').removeClass('hidden');
					$('#myRequestMicrosite').attr('data-name',$(this).attr("data-name"));
					$('#myRequestMicrosite').attr('data-desc',$(this).attr("data-desc"));
					$('#myRequestMicrosite').attr('data-id',$(this).attr("data-id"));
					setLinkHash(instanceId+"@IID@Home/Catalogue=redirectTo~@~&subAction=viewMicrosite&Link="+$(this).attr("data-link")+"&id="+$(this).attr("data-id")+"&name="+$(this).attr("data-name").replace(/ /g, '+'));
					$(window).scrollTop(0);
				}
			}
			else if(($.trim($(this).attr('data-iframe'))=="0" || $.trim($(this).attr('data-iframe'))=="3") && $.trim($(this).attr('data-shortUrl'))!=""){
				var prodName=$(this).attr("data-name");
				var shortUrl=$.trim($(this).attr('data-shortUrl'));
				var path=getFullShortURLPath(shortUrl);
				window.location = path;
				
			}
			hitAnalyticsCheck("View","View microsite",$(this).attr("data-id")+" - "+$(this).attr("data-name")); */
		});
	}
}
function fetchPublisher(txtOrgId){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if(txtOrgId=="" || txtOrgId=="undefined" || txtOrgId=="null"){
		if($('#myRequestMicrosite').length>0){
			document.getElementById('myRequestMicrosite').contentWindow.postMessage("fetchPublisherResponse@~@Publisher ID not Entered","*");
		}
		else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
			if (typeof customFetchPublisherResponse == 'function'){
					customFetchPublisherResponse('Publisher ID not Entered');
			}
			else{
				fetchPublisherResponse('Publisher ID not Entered');
			}
		}
	}
	else{
		$.ajax({
			type: "POST",
			url: url,
			data: {
				orgID:orgID,
				txtInstanceId:instanceId,
				languageId:languageId,
				txtdistributerId:txtOrgId,
				subAction:"getListOfPublishers"
			},
			dataType: "json",
			/* async:false, */
			success: function(result){
				log(result);
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("fetchPublisherResponse@~@"+JSON.stringify(result),"*");
				}
				else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					if (typeof customFetchPublisherResponse == 'function'){
						customFetchPublisherResponse(JSON.stringify(result));
					}
					else{
						fetchPublisherResponse(JSON.stringify(result));
					}
				}
				/* return "fetchPublisherResponse@~@"+JSON.stringify(result); */
			},
			error: function(x, e){
				if(e=="parsererror" && x.responseText=="session is not avaliable"){
					$('#toaster').html('');
					$.toaster({ priority : 'danger', title : '', message : multilingualKeyValue('1','34')});  /* session expired, relogin to continue */
					createLoginLoader();
					fnLogoutICMP('1');
					return false;
				}
			}
		}); 
	}
	log("executingPublisher");
}
function fetchDistributor(txtOrgId){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if(txtOrgId=="" || txtOrgId=="undefined" || txtOrgId=="null"){
		if($('#myRequestMicrosite').length>0){
			document.getElementById('myRequestMicrosite').contentWindow.postMessage("fetchPublisherResponse@~@Distributer ID not Entered","*");
		}
		else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
			if (typeof customFetchDistributorResponse == 'function'){
				customFetchDistributorResponse('Distributer ID not Entered');
			}
			else{
				fetchDistributorResponse('Distributer ID not Entered');
			}
		}
	}
	else{
		$.ajax({
			type: "POST",
			url: url,
			data: {
				orgID:orgID,
				txtInstanceId:instanceId,
				languageId:languageId,
				txtpublisherId:txtOrgId,
				subAction:"getListOfDistributors"
			},
			dataType: "json",
			/* async:false, */
			success: function(result){
				log(result);
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage("fetchDistributorResponse@~@"+JSON.stringify(result),"*");
				}
				else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					if (typeof customFetchDistributorResponse == 'function'){
						customFetchDistributorResponse(JSON.stringify(result));
					}
					else{
						fetchDistributorResponse(JSON.stringify(result));
					}
				}
			},
			error: function(x, e){
				if(e=="parsererror" && x.responseText=="session is not avaliable"){
					$('#toaster').html('');
					$.toaster({ priority : 'danger', title : '', message : multilingualKeyValue('1','34')}); /* session expired, relogin to continue */
					createLoginLoader();
					fnLogoutICMP('1');
					return false;
				}
			}
		});
	}
}
function viewMicrositeEventHandlerForMicrosite(productId,productName,datalink,shortUrl,isIframe){
	viewMicrositeEventHandlerForMicrositeNew(productId,productName,datalink,shortUrl,isIframe);
	/* log("viewMicrositeEventHandlerForMicrosite");
	if(!(($.trim(isIframe)=="0" || $.trim(isIframe)=="3") && $.trim(shortUrl)!="")){
		if($.trim(datalink)!=""){
			callOnSearch();
			setTimeout(function() {	
				if($('#micrositeContent').length>0){
					if(!$('#micrositeContent').hasClass('hidden'))
						$('#micrositeContent').addClass('hidden')
				}
				$('.bredcrum').removeClass('hidden');
				$('#myRequestMicrositeParent').removeClass('hidden');
				$('#micrositeHeadContent').removeClass('hidden');
				$('#micrositeHeadContent').html('');
				micrositeCheck=true;
				if(productName.length>100)
					$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="mkpc1" data-b="Home" style="cursor:pointer;">'+iHUB.multilingual.gmv('mkpc1')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i><a onclick="goToCatalog();" style="cursor:pointer;" data-a="mkpc13" data-b="Catalogue">'+iHUB.multilingual.gmv('mkpc13')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>'+productName.substring(0,100)+'...');
				else
					$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="mkpc1" data-b="Home" style="cursor:pointer;">'+iHUB.multilingual.gmv('mkpc1')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i><a onclick="goToCatalog();" style="cursor:pointer;" data-a="mkpc13" data-b="Catalogue">'+iHUB.multilingual.gmv('mkpc13')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>'+productName+'');
				$('#myRequestMicrositeParent').html('<iframe src="'+datalink+'" id="myRequestMicrosite" style="background : #eee url(\'/iDH/dashboard/images/iHUBLoader.gif\') no-repeat scroll 50% 27%" allowfullscreen="allowfullscreen" mozallowfullscreen="mozallowfullscreen" msallowfullscreen="msallowfullscreen" oallowfullscreen="oallowfullscreen" webkitallowfullscreen="webkitallowfullscreen" frameborder="0"></iframe>');
				$('#myRequestMicrosite').attr('data-id',productId);
				$('#myRequestMicrosite').removeClass('hidden');
				setLinkHash(instanceId+"@IID@Home/Catalogue=redirectTo~@~&subAction=viewMicrosite&Link="+datalink+"&id="+productId+"&name="+productName.replace(/ /g, '+'));
				hitAnalyticsCheck("View","View microsite",productId+" - "+productName);
			},500);
		}
	}
	else if(($.trim(isIframe)=="0" || $.trim(isIframe)=="3") && $.trim(shortUrl)!=""){
		var path=getFullShortURLPath(shortUrl);
		window.location = path;
		hitAnalyticsCheck("View","View microsite",productId+" - "+productName);
	} */
}

function viewMicrositeEventHandlerForMicrositeNew(productId,productName,datalink,shortUrl,isIframe){
	/* log("viewMicrositeEventHandlerForMicrosite");
	if($('#myRequestMicrositeParent').length > 0){
		// already in Microsite routing
		openMicrosite(productId,productName,datalink,shortUrl,isIframe);
	}
	else{ */
		if(!(($.trim(isIframe)=="0" || $.trim(isIframe)=="3") && $.trim(shortUrl)!="")){
			if($.trim(datalink)!=""){
				var extraPart = ('open#'+instanceId+"@IID@Home/Catalogue=redirectTo~@~&subAction=viewMicrosite&Link="+datalink+"&id="+productId+"&name="+productName.replace(/ /g, '+')).replace(/\//g,'%2F');
				if($('#micrositeHiddenField').length > 0){
					$('#micrositeHiddenField a').attr('href',returnRouteLink("/iDH/Microsite")+"/"+extraPart);
					document.getElementById('micrositeHiddenField').firstElementChild.click();
				}
			}
			else if ($.trim(shortUrl)!="" && $.trim(isIframe)=="2"){
				hitAnalyticsCheck("View","View microsite",productId+" - "+productName);
				var path=getFullShortURLPath(shortUrl);
				window.location = path;
			}
		}
		else if(($.trim(isIframe)=="0" || $.trim(isIframe)=="3") && $.trim(shortUrl)!=""){		
			hitAnalyticsCheck("View","View microsite",productId+" - "+productName);
			var path=getFullShortURLPath(shortUrl);
			window.location = path;
		}
	/* } */
}

function openMicrosite(productId,productName,datalink,shortUrl,isIframe){
	if(!(($.trim(isIframe)=="0" || $.trim(isIframe)=="3") && $.trim(shortUrl)!="")){
		if($.trim(datalink)!=""){
			callOnSearch();
			setTimeout(function() {	
				if($('#micrositeContent').length>0){
					if(!$('#micrositeContent').hasClass('hidden'))
						$('#micrositeContent').addClass('hidden')
				}
				$('.bredcrum').removeClass('hidden');				
				$('#micrositeHeadContent').removeClass('hidden');
				$('#micrositeHeadContent').html('');
				micrositeCheck=true;
				setMicrositeBredcrum(productId,productName,datalink,shortUrl,isIframe);				
				$('#myRequestMicrositeParent').html('<iframe src="'+datalink+'" id="myRequestMicrosite" style="background : #eee url(\'/iDH/dashboard/images/iHUBLoader.gif\') no-repeat scroll 50% 27%" allowfullscreen="allowfullscreen" mozallowfullscreen="mozallowfullscreen" msallowfullscreen="msallowfullscreen" oallowfullscreen="oallowfullscreen" webkitallowfullscreen="webkitallowfullscreen" frameborder="0"></iframe>');
				$('#myRequestMicrosite').attr('data-id',productId);
				$('#myRequestMicrosite').removeClass('hidden');
				$('#myRequestMicrositeParent').removeClass('hidden');
				/* setLinkHash(instanceId+"@IID@Home/Catalogue=redirectTo~@~&subAction=viewMicrosite&Link="+datalink+"&id="+productId+"&name="+productName.replace(/ /g, '+')); */
				hitAnalyticsCheck("View","View microsite",productId+" - "+productName);
			},500);
		}
	}
	else if(($.trim(isIframe)=="0" || $.trim(isIframe)=="3") && $.trim(shortUrl)!=""){		
		hitAnalyticsCheck("View","View microsite",productId+" - "+productName);
		var path=getFullShortURLPath(shortUrl);
		window.location = path;
	}
}

function setMicrositeBredcrum(productId,productName,datalink,shortUrl,isIframe){
	if(productName.length>100)
		$('.micrositeProductName').html(productName.substring(0,100)+'...');
	else
		$('.micrositeProductName').html(productName);
}

function openLoginEventHandler(){
	var url=document.location.href;
	if(url.indexOf("login.html")!=-1){
		setMyPreLoginParameter();
		var txtLoginLink=$("#txtLoginLink_div").text();
		if(txtLoginLink!=="null" && txtLoginLink!=="")
			document.location.href=txtLoginLink;
		else		
			checkMyPage();/* $('#loginmodal').modal(); */
	}
	else{
		orgID=document.getElementsByName("orgId")[0].value;
		masterform_id=document.getElementsByName("formId")[0].value;
		if($.trim(masterform_id)=="")
			masterform_id=$('#userFormId').val();
		instanceId=$("#txtInstanceId_div").text()==""?$("#txtInstanceId").val():$("#txtInstanceId_div").text();
		document.location.href = "/EForms/configuredHtml/"+orgID+"/"+masterform_id+"/login.html?instanceId="+instanceId+"&toggle";
	}
	hitAnalyticsCheck("Login","Open Login"," - ");
}
function createLoginLoader(){
	/* setLinkHash(instanceId+'@IID@Home/'); */ /* commented as now no hash in jobs */
	/* $('.mylogo').click(); */
	callMylogoOnclick();
	$('#sessChk').val('');
	$('#txtCart').val('');
	$('#txtWishlist').val('');
	miniCart();
	myWishlistProducts="";
	store.set('myWishlistProducts','');
	if(prdIdsAndName!=undefined && prdIdsAndName!=""){
		for(i=0;i<prdIdsAndName.split('@@~@@').length;i++){
			$("[id='"+prdIdsAndName.split('@@~@@')[i].split('~')[0]+"']").find('.removeFromWishlistI').addClass('hidden');
			$("[id='"+prdIdsAndName.split('@@~@@')[i].split('~')[0]+"']").find('.removeFromWishlistI').siblings(".addToWishlistI").removeClass('hidden');
			$("[id='"+prdIdsAndName.split('@@~@@')[i].split('~')[0]+"']").find('.removeFromWishlistC').addClass('hidden');
			$("[id='"+prdIdsAndName.split('@@~@@')[i].split('~')[0]+"']").find('.removeFromWishlistC').siblings(".addToWishlistC").removeClass('hidden');		
		}
	}
	/* log('createLoginLoader'); */
	$('#loader').html("<span style='margin-right: 5px; position: relative; top: 65px;color:white;cursor:pointer;'><strong></strong><div style=\"color: black\" onclick='openLoginEventHandler();'><strong data-a='53' data-b='Your session expired. Click to relogin'>"+multilingualKeyValue('53','34')+"</strong><br><i class='fa fa-sign-in fa-rotate-90 fa-4x'></i></div></span>");
	$("#loader").show();
	$('.postLogin').addClass('hidden');	
	$('.showMySubscriptionsWeb').addClass('hidden');	
	$('.mmMysubscribe').addClass('hidden');	
	$('.roleSelectionWeb').addClass('hidden');
	$('.roleSelectionMob').addClass('hidden');
	$('.preLogin').removeClass('hidden');
	setTimeout(function(){		
		location.reload();		
	},1500);
	  throw new MyError();
}
function MyError(message) {
	this.name = 'MyError';
	this.message = message || 'Default Message';
	this.stack = (new Error()).stack;
}

function generateIndexPage(){
	var returnval=true;	
	if (typeof getAllInstanceDetails == 'function'){
		allInstanceDetails=getAllInstanceDetails();
		if(allInstanceDetails!=undefined){
			globalModuleVisibility=allInstanceDetails.moduleVisibility;
			isEmailVerificationReq=allInstanceDetails.isEmailVerificationReq;
			if($.trim(allInstanceDetails.defaultLanguageId)!="")
				languageId=allInstanceDetails.defaultLanguageId;
			else
				languageId="1";
		}
	}
	/* var groupID=$.trim($('#instanceJsonPath').val()).indexOf("/per/") > -1 ? $.trim($('#instanceJsonPath').val()).split("/per/")[1].split('/')[0] : "g01";
	var url="/per/"+groupID+"/pub/"+orgID+"/EForms/iHUB/instance/"+instanceId+"/"+instanceId+"_newIndex.json";
	$.getJSON(url, function( data ) {
		newIndexCall(data,"Popular Free,Popular Paid,Recommended by iON","Yes");
	}); */
	if (typeof createCustomIndexPageCall == 'function'){  
		createCustomIndexPageCall();
	}
	else{
		var createIndexPageCalltemp = true;
		if (typeof createIndexCube == 'function')  
			createIndexPageCalltemp=createIndexCube("txtItemPurchaseType,txtItemPurchaseType,IsRecommendedByiON","Free,Paid,Yes","Popular Free Products,Popular Paid Products,Recommended by iON","Yes");
		returnval=createIndexPageCalltemp;
	}
	indexDetailsStatus=true;
	return returnval;
}
function RedirectTofilteredCatalogue(check){
	var returnValue=false;
	var sPageURL = window.location.search.substring(1),
	sURLVariables = sPageURL.split('&'),
	sParameterName,
	i;
	var redirectString="",redirectionLink="";
	for(var d=0;d < sURLVariables.length;d++){
		if(sURLVariables[d].split('=')[0].toUpperCase()=="HASHCONTENT")
			redirectString=decodeURIComponent(sURLVariables[d].split('=')[1]);
	}
	isRedirectionRequired=$.trim(redirectString.split('~@~')[0]);
	if(isRedirectionRequired.toUpperCase()=="REDIRECTTO")
		redirectionLink=$.trim(redirectString.split('~@~')[1]);
	redirectionLinkParams=redirectionLink.split('&');
	requestSubAction="";
	for(var i=0;i<redirectionLinkParams.length;i++){
		if(redirectionLinkParams[i].split('=')[0].toUpperCase()=="SUBACTION" && redirectionLinkParams[i].split('=')[1]!="")
			requestSubAction=redirectionLinkParams[i].split('=')[1];
	}
	if(requestSubAction!="" && requestSubAction.toUpperCase()=="CREATECATALOGUE" && check==false){
		hideMicrosite();
		field="";
		variables="";
		for(var i=0;i<redirectionLinkParams.length;i++){
			if(redirectionLinkParams[i].split('=')[0]=="field")
				field=redirectionLinkParams[i].split('=')[1];
			if(redirectionLinkParams[i].split('=')[0]=="variable")
				variables=redirectionLinkParams[i].split('=')[1];
		}
		createCatalogueDataRequest(field,variables);
		setTimeout(function(){
			$('input:checkbox[data-id="txtLevels"]').prop('checked',false);
			for(var i=0;i<field.split('@~@').length;i++){
				var applyfilter=field.split('@~@')[i];
				if(applyfilter=="txtItemScheduledStartDate"){
					showAccordion('openDuration');
					$('#CatalogueContent').find('#txtItemScheduledStartDate').val(variables.split('@~@')[i].replace(/'/g,""));
				}
				else if(applyfilter=="txtItemScheduledEndDate"){
					showAccordion('openDuration');
					$('#CatalogueContent').find('#txtItemScheduledEndDate').val(variables.split('@~@')[i].replace(/'/g,""));
				}
				else if(applyfilter=="txtItemPrice"){
					var myName=variables.split('@~@')[i];
					$('input:checkbox[data-id="txtItemPrice"]').each(function() {
						myfield=$.trim($(this).attr('data-txtitemprice'));
						for(var j=0;j<myName.split(',').length;j++){
							if(myfield==myName.split(',')[j])
								$(this).prop('checked',true);
						}
					});
				}
				else if(applyfilter=="txtItemPurchaseType"){
					showAccordion('openPrice');
					if(variables.split('@~@')[i].replace(/'/g,"").toUpperCase()=="PAID"){
						$($('input:radio[id="txtItemPurchaseType"]')[1]).prop('checked',true);
						$($('input:radio[id="txtItemPurchaseType"]')[0]).prop('checked',false);
						$($('input:radio[id="txtItemPurchaseType"]')[2]).prop('checked',false);
					}
					else if(variables.split('@~@')[i].replace(/'/g,"").toUpperCase()=="FREE"){						
						$($('input:radio[id="txtItemPurchaseType"]')[1]).prop('checked',false);
						$($('input:radio[id="txtItemPurchaseType"]')[2]).prop('checked',false);
						$($('input:radio[id="txtItemPurchaseType"]')[0]).prop('checked',true);
						$('input:checkbox[data-id="txtItemPrice"]').each(function() {
							$(this).prop('checked',false);
						});
					}
					else if(variables.split('@~@')[i].replace(/'/g,"").toUpperCase()=="LICENCE"){						
						$($('input:radio[id="txtItemPurchaseType"]')[0]).prop('checked',false);
						$($('input:radio[id="txtItemPurchaseType"]')[1]).prop('checked',false);
						$($('input:radio[id="txtItemPurchaseType"]')[2]).prop('checked',true);
						$('input:checkbox[data-id="txtItemPrice"]').each(function() {
							$(this).prop('checked',false);
						});
					}
				}
				else if(applyfilter=="txtProductCreationType"){
					var myLevel="txtProductCreationType";
					var myName=variables.split('@~@')[i];
					$('input:checkbox[data-id="txtProductCreationType"]').each(function() {
						myfield=$.trim($(this).attr('data-level'));
						if($.trim($(this).attr('data-level'))==myLevel){
							for(var j=0;j<myName.split(',').length;j++){
								if($.trim($(this).attr('data-typeId'))==myName.split(',')[j]){
									$(this).prop('checked',true);
									showAccordion('openType');
								}
							}
						}
					});
				}
				else if(applyfilter.indexOf("txtLevel")>-1){
					var myLevel=applyfilter;
					var myName=variables.split('@~@')[i];
					$('input:checkbox[data-id="txtLevels"]').each(function() {
						myfield=$.trim($(this).attr('data-level'));
						for(var j=0;j<myName.split(',').length;j++){
							if($(this).attr('value')==myName.split(',')[j] && $.trim($(this).attr('data-level'))==myLevel){
								$(this).prop('checked',true);
								/* $('.collapseAllLink').click(); */
								openNextlevels($(this));
								showAccordion('openCategory');
							}
						}
					});
				}
				else if(applyfilter=="txtOrgId"){
					var myLevel=applyfilter;
					var myName=variables.split('@~@')[i];
					$('input:checkbox[data-id="txtOrgId"]').each(function() {						
						for(var j=0;j<myName.split(',').length;j++){
							if($(this).attr('data-value')==myName.split(',')[j]){
								$(this).prop('checked',true);
								showAccordion('publisherclass');
							}
						}						
					});
				}
				else if(applyfilter=="txtorderby"){
					var myLevel=applyfilter;
					var myName=variables.split('@~@')[i];
					$('.sortBy').each(function() {
						$(this).parent().removeClass('active');
						if ($(this).attr('data-search') == myName.replace('Up','')) {
							$(this).parent().addClass('active');
						}
					})
					$('input:radio[id="txtorderby"]').each(function() {
						if ($(this).attr('data-id') == myName)
							$(this).prop('checked', true);
						else
							$(this).prop('checked', false);
					});
				}
				else if(applyfilter=="isAssigned"){
					var myLevel=applyfilter;
					var myName=variables.split('@~@')[i];
					$('.disAssigned').each(function() {
						$(this).parent().removeClass('active');
						if ($(this).attr('data-search').toLowerCase() == myName.toLowerCase()) {
							$(this).parent().addClass('active');
						}
					});
				}
			}
			createMySearchLabels(field,variables);
		},1000);
		callOnSearch();
		/* changed by Kiran */
		if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
			var categoryLevelDetails=$('#product_catlog').data('levelDetails');
			eval('getCategoryDetails(categoryLevelDetails)');
		}
		SetBreadCrumbCatalogue();
		$('#CatalogueContent').removeClass('hidden');
		$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
		returnValue=true;
	}
	else if(requestSubAction!="" && requestSubAction.toUpperCase()=="GETLISTOFPRODUCTDETAILS" && check==false){
		hideMicrosite();
		for(var i=0;i<redirectionLinkParams.length;i++){
			if(redirectionLinkParams[i].split('=')[0]=="productIds")
				productIds=redirectionLinkParams[i].split('=')[1];
		}
		createCatalogueDataRequestForProductIds(productIds);
		callOnSearch();
		/* changed by Kiran */
		if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
			var categoryLevelDetails=$('#product_catlog').data('levelDetails');
			eval('getCategoryDetails(categoryLevelDetails)');
		}
		SetBreadCrumbCatalogue();
		$('#CatalogueContent').removeClass('hidden');
		$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
		returnValue=true;
	}
	else if(requestSubAction!="" && requestSubAction.toUpperCase()=="CREATESEARCHCATALOGUE"){
		hideMicrosite();
		for(var i=0;i<redirectionLinkParams.length;i++){
			if(redirectionLinkParams[i].split('=')[0]=="txtSearchText")
				txtSearchText=redirectionLinkParams[i].split('=')[1];
			if(redirectionLinkParams[i].split('=')[0]=="variable")
				variable=redirectionLinkParams[i].split('=')[1];
		}
		callOnSearch();
		/* changed by Kiran */
		if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
			var categoryLevelDetails=$('#product_catlog').data('levelDetails');
			eval('getCategoryDetails(categoryLevelDetails)');
		}
		SetBreadCrumbCatalogue();
		$('#CatalogueContent').removeClass('hidden');
		$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
		showLoader();
		filterSearch();
		$('.yourSearch span').remove();
		var strSearch = "";
		strSearch+="<span></span><span data-filtered=\"txtSearchText\">"+txtSearchText.toString()+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
		if(txtSearchText.toString()==""){
			strSearch="<span data-a='31' data-b='All Products'>"+multilingualKeyValue('31','34')+"</span>";
			$('.clearAll').addClass('hidden');
		}
		$('.yourSearch').append(strSearch);
		deleteMyFilter();
		hideLoader_iDH();
		returnValue=true;
	}
	else if(requestSubAction!="" && requestSubAction.toUpperCase()=="VIEWMICROSITE" && check==true){
		var productId="",datalink="",productName="";
		for(var i=0;i<redirectionLinkParams.length;i++){	
			if(redirectionLinkParams[i].split('=')[0].toUpperCase()=="ID")		
				productId=redirectionLinkParams[i].split('=')[1];		
			if(redirectionLinkParams[i].split('=')[0].toUpperCase()=="LINK")		
				datalink=redirectionLinkParams[i].split('=')[1];		
			if(redirectionLinkParams[i].split('=')[0].toUpperCase()=="NAME")		
				productName=redirectionLinkParams[i].split('=')[1];		
		}		
		viewMicrositeEventHandlerForMicrosite(productId,productName,datalink)		
		returnValue=true;
	}
	manageFooter();
	if($('#sessChk').val()=="" || $('#sessChk').val()==null){
		returnValue=true;
	}
	return returnValue;
}
/* this function is kept as it is in production */
function goTofilteredCatalogue(myPageLocation){
	var delay=0;
	if($('#CatalogueContent').html() == ""){
		delay=1000;
		$('#micrositeContent').addClass('hidden');
		if($.trim(globalUrl)==""){
			instanceId=$('#instanceId').val();
			var url=$.trim($('#instanceJsonPath').val()).replace('/ionstore','');
			globalUrl=url.replace(instanceId+'_A.json','');
		}
		var path=globalUrl+'catalogue.html';
		if(path!=''){
			$('#CatalogueContent').load(path, function( response, status, xhr ) {
				if ( status == "success" ) {
					getCatalougeData();
					setTimeout(function() {
						postCatalogueScript();
					},1000);
				}
			});
		}
	}
	setTimeout(function(){
		redirectionLink="";
		var redirectString=myPageLocation;
		isRedirectionRequired=$.trim(redirectString.split('~@~')[0]);
		if(isRedirectionRequired.toUpperCase()=="REDIRECTTO")
			redirectionLink=$.trim(redirectString.split('~@~')[1]);
		redirectionLinkParams=redirectionLink.split('&');
		requestSubAction="";
		for(var i=0;i<redirectionLinkParams.length;i++){
			if(redirectionLinkParams[i].split('=')[0].toUpperCase()=="SUBACTION" && redirectionLinkParams[i].split('=')[1]!="")
				requestSubAction=redirectionLinkParams[i].split('=')[1];
		}
		$('input:checkbox[data-id="txtLevels"]').prop('checked',false);		
		$('input:radio[id="txtItemPurchaseType"]').prop('checked',false);		
		$('input:checkbox[data-id="txtProductCreationType"]').prop('checked',false);		
		$('input:checkbox[data-id="txtOrgId"]').prop('checked',false);		
		$('#CatalogueContent').find('#txtItemScheduledStartDate').val('');		
		$('#CatalogueContent').find('#txtItemScheduledEndDate').val('');
		if(requestSubAction!="" && requestSubAction.toUpperCase()=="CREATECATALOGUE"){
			hideMicrosite();
			field="";
			variables="";
			pageNo="";
			for(var i=0;i<redirectionLinkParams.length;i++){
				if(redirectionLinkParams[i].split('=')[0]=="field")
					field=redirectionLinkParams[i].split('=')[1];
				if(redirectionLinkParams[i].split('=')[0]=="variable")
					variables=redirectionLinkParams[i].split('=')[1];
				if(redirectionLinkParams[i].split('=')[0]=="pageNo")
					currentPageOfcatalogue=redirectionLinkParams[i].split('=')[1];
			}
			variables=$.trim(variables.replace(/</g, "").replace(/>/g, "").replace(/'/g, "").replace(/"/g, "").replace(/\\/g, '').replace(/\//g, '').replace(/%/g, ''));
			field=$.trim(field.replace(/</g, "").replace(/>/g, "").replace(/'/g, "").replace(/"/g, "").replace(/\\/g, '').replace(/\//g, '').replace(/%/g, ''));
			createCatalogueDataRequest(field,variables,true);
			setTimeout(function(){
				for(var i=0;i<field.split('@~@').length;i++){
					var applyfilter=field.split('@~@')[i];
					if(applyfilter=="txtItemScheduledStartDate"){
						showAccordion('openDuration');
						$('#CatalogueContent').find('#txtItemScheduledStartDate').val(variables.split('@~@')[i].replace(/'/g,""));
					}
					else if(applyfilter=="txtItemScheduledEndDate"){
						showAccordion('openDuration');
						$('#CatalogueContent').find('#txtItemScheduledEndDate').val(variables.split('@~@')[i].replace(/'/g,""));
					}
					else if(applyfilter=="txtItemPrice"){
						var myName=variables.split('@~@')[i];
						$('input:checkbox[data-id="txtItemPrice"]').each(function() {
							myfield=$.trim($(this).attr('data-txtitemprice'));
							for(var j=0;j<myName.split(',').length;j++){
								if(myfield==myName.split(',')[j])
									$(this).prop('checked',true);
							}
						});
					}
					else if(applyfilter=="txtItemPurchaseType"){
						showAccordion('openPrice');					
						if(variables.split('@~@')[i].replace(/'/g,"").toUpperCase()=="PAID"){
							$($('input:radio[id="txtItemPurchaseType"]')[1]).prop('checked',true);
							$($('input:radio[id="txtItemPurchaseType"]')[0]).prop('checked',false);
							$($('input:radio[id="txtItemPurchaseType"]')[2]).prop('checked',false);
							$(".slider_range").fadeIn();
						}
						else if(variables.split('@~@')[i].replace(/'/g,"").toUpperCase()=="FREE"){						
							$($('input:radio[id="txtItemPurchaseType"]')[1]).prop('checked',false);
							$($('input:radio[id="txtItemPurchaseType"]')[2]).prop('checked',false);
							$($('input:radio[id="txtItemPurchaseType"]')[0]).prop('checked',true);
							$('input:checkbox[data-id="txtItemPrice"]').each(function() {
								$(this).prop('checked',false);
							});
							$(".slider_range").fadeOut();
						}
						else if(variables.split('@~@')[i].replace(/'/g,"").toUpperCase()=="LICENCE"){						
							$($('input:radio[id="txtItemPurchaseType"]')[0]).prop('checked',false);
							$($('input:radio[id="txtItemPurchaseType"]')[1]).prop('checked',false);
							$($('input:radio[id="txtItemPurchaseType"]')[2]).prop('checked',true);
							$('input:checkbox[data-id="txtItemPrice"]').each(function() {
								$(this).prop('checked',false);
							});
							$(".slider_range").fadeOut();
						}
					}
					else if(applyfilter=="txtProductCreationType"){
						var myLevel="txtProductCreationType";
						var myName=variables.split('@~@')[i];
						$('input:checkbox[data-id="txtProductCreationType"]').each(function() {
							myfield=$.trim($(this).attr('data-level'));
							if($.trim($(this).attr('data-level'))==myLevel){
								for(var j=0;j<myName.split(',').length;j++){
									if($.trim($(this).attr('data-typeId'))==myName.split(',')[j]){
										$(this).prop('checked',true);
										showAccordion('openType');
									}
								}
							}
						});
					}
					else if(applyfilter.indexOf("txtLevel")>-1){
						var myLevel=applyfilter;
						var myName=variables.split('@~@')[i];
						$('input:checkbox[data-id="txtLevels"]').each(function() {
							myfield=$.trim($(this).attr('data-level'));
							for(var j=0;j<myName.split(',').length;j++){
								if(!isNaN(myName.split(',')[j]) && !isNaN($(this).attr('value'))){
									if($(this).attr('value')==myName.split(',')[j] && $.trim($(this).attr('data-level'))==myLevel){
										$(this).prop('checked',true);
										/* $('.collapseAllLink').click(); */
										openNextlevels($(this));
										showAccordion('openCategory');
									}
								}
							}
						});
					}
					else if(applyfilter=="txtOrgId"){
						var myLevel=applyfilter;
						var myName=variables.split('@~@')[i];
						$('input:checkbox[data-id="txtOrgId"]').each(function() {						
							for(var j=0;j<myName.split(',').length;j++){
								if($(this).attr('data-value')==myName.split(',')[j]){
									$(this).prop('checked',true);
									showAccordion('publisherclass');
								}
							}						
						});
					}
					else if(applyfilter=="txtorderby"){
						var myLevel=applyfilter;
						var myName=variables.split('@~@')[i];
						$('.sortBy').each(function() {
							$(this).parent().removeClass('active');
							if ($(this).attr('data-search') == myName.replace('Up','')) {
								$(this).parent().addClass('active');
							}
						})
						$('input:radio[id="txtorderby"]').each(function() {
							if ($(this).attr('data-id') == myName)
								$(this).prop('checked', true);
							else
								$(this).prop('checked', false);
						});
					}
					else if(applyfilter=="isAssigned"){
						var myLevel=applyfilter;
						var myName=variables.split('@~@')[i];
						$('.disAssigned').each(function() {
							$(this).parent().removeClass('active');
							if ($(this).attr('data-search').toLowerCase() == myName.toLowerCase()) {
								$(this).parent().addClass('active');
							}
						});
					}
					else if(applyfilter=="txtItemTags"){
						itemTags=variables.split('@~@')[i];
					}
					else if(applyfilter=="ProductIdList"){
						if($('#txtUsrRole').val()=="Distributor")
							txtProductIDs=variables.split('@~@')[i];
							store.set('txtProductIDs',variables.split('@~@')[i]);
					}
				}
				createMySearchLabels(field,variables);
			},1000);
			callOnSearch();
			/* changed by Kiran */
			if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
				var categoryLevelDetails=$('#product_catlog').data('levelDetails');
				eval('getCategoryDetails(categoryLevelDetails)');
			}
			SetBreadCrumbCatalogue();
			$('#CatalogueContent').removeClass('hidden');
			$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
		}
		else if(requestSubAction!="" && requestSubAction.toUpperCase()=="GETLISTOFPRODUCTDETAILS"){
			hideMicrosite();
			for(var i=0;i<redirectionLinkParams.length;i++){
				if(redirectionLinkParams[i].split('=')[0]=="productIds")
					productIds=redirectionLinkParams[i].split('=')[1];
			}
			createCatalogueDataRequestForProductIds(productIds);
			callOnSearch();
			/* changed by Kiran */
			if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
				var categoryLevelDetails=$('#product_catlog').data('levelDetails');
				eval('getCategoryDetails(categoryLevelDetails)');
			}
			SetBreadCrumbCatalogue();
			$('#CatalogueContent').removeClass('hidden');
			$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
		}
		else if(requestSubAction!="" && requestSubAction.toUpperCase()=="CREATESEARCHCATALOGUE"){
			hideMicrosite();
			var txtSearchText="",variable="",pageNo="";
			for(var i=0;i<redirectionLinkParams.length;i++){
				if(redirectionLinkParams[i].split('=')[0]=="txtSearchText")
					txtSearchText=redirectionLinkParams[i].split('=')[1];
				if(redirectionLinkParams[i].split('=')[0]=="variable")
					variable=redirectionLinkParams[i].split('=')[1];
				if(redirectionLinkParams[i].split('=')[0]=="pageNo")
					currentPageOfcatalogue=redirectionLinkParams[i].split('=')[1];
			}
			callOnSearch();
			/* changed by Kiran */
			if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
				var categoryLevelDetails=$('#product_catlog').data('levelDetails');
				eval('getCategoryDetails(categoryLevelDetails)');
			}
			SetBreadCrumbCatalogue();
			$('#CatalogueContent').removeClass('hidden');
			$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
			showLoader();
			filterSearch();
			$('.yourSearch span').remove();
			var strSearch = "";
			strSearch+="<span></span><span data-filtered=\"txtSearchText\">"+txtSearchText.toString()+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i> </span>";
			if(txtSearchText.toString()==""){
				strSearch="<span data-a='31' data-b='All Products'>"+multilingualKeyValue('31','34')+"</span>";
				$('.clearAll').addClass('hidden');
			}
			$('.yourSearch').append(strSearch);
			deleteMyFilter();
			hideLoader_iDH();
		}
		else if(requestSubAction!="" && requestSubAction.toUpperCase()=="VIEWMICROSITE"){
			var productId="",datalink="",productName="";
			for(var i=0;i<redirectionLinkParams.length;i++){	
				if(redirectionLinkParams[i].split('=')[0].toUpperCase()=="ID")		
					productId=redirectionLinkParams[i].split('=')[1];		
				if(redirectionLinkParams[i].split('=')[0].toUpperCase()=="LINK")		
					datalink=redirectionLinkParams[i].split('=')[1];		
				if(redirectionLinkParams[i].split('=')[0].toUpperCase()=="NAME")		
					productName=redirectionLinkParams[i].split('=')[1].replace(/\+/g, ' ');		
			}		
			viewMicrositeEventHandlerForMicrosite(productId,productName,datalink)		
		}
		else if($('#sessChk').val()!="" && $('#sessChk').val()!=null){
			hideMicrosite();
			var txtSearchText=[];
			txtSearchText.push("");
			if(txtSearchText.length>0){
				callOnSearch();
				/* changed by Kiran */
				if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
					var categoryLevelDetails=$('#product_catlog').data('levelDetails');
					eval('getCategoryDetails(categoryLevelDetails)');
				}
				SetBreadCrumbCatalogue();
				$('#CatalogueContent').removeClass('hidden');
				$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
				showLoader();
				filterSearch();
				$('.yourSearch span').remove();
				var strSearch = "";
				strSearch+="<span></span><span data-filtered=\"txtSearchText\">"+txtSearchText.toString()+"&nbsp;<i class=\"delete_crs marginrgt5 dMF\"></i></span>";
				if(txtSearchText.toString()==""){
					strSearch="<span data-a='31' data-b='All Products'>"+multilingualKeyValue('31','34')+"</span>";
					$('.clearAll').addClass('hidden');
				}
				$('.yourSearch').append(strSearch);
				deleteMyFilter();
				hideLoader_iDH();
			}
		}
		manageFooter();
	},delay);
	return true;
}
/* this function is kept as it is in production */
function memberverification(IsMemberVerificationRqd,txtUserAttribute,txtUserAttrubuteValue){
	if($('#sessChk').val()!="" && $('#sessChk').val()!=null){
		if(IsMemberVerificationRqd=="Yes"){
			var cond=txtUserAttribute+"_div";
			if($('#'+cond).length > 0 && txtUserAttrubuteValue!=undefined && txtUserAttrubuteValue!=null){
				if($('#'+cond).text().toLowerCase().indexOf(txtUserAttrubuteValue.toLowerCase()) > -1){
					return true;
				}
				else
					return false;
			}
			else
				return false;
		}
		else
			return false;
	}
	else
		return false;
}
function togglePaid(){
	$(".slider_range").fadeIn();
	$(".free1").prop('checked', false);
	filterSearch();
	}
function toggleFree1(){
	$('input:checkbox[data-id="txtItemPrice"]').each(function() {
		$(this).prop('checked',false);
	});
	$(".slider_range").fadeOut();
	$(".paid").prop('checked', false);
	filterSearch();
}
function mmenuInsideCall(){
	if($('nav#menu').hasClass('mm-menu')){
	}
	else{
		$("a[href='#menu']").remove();
		if(!isNewHeader){
			$('body').prepend('<a class="nav-toggle visible-xs visible-sm navbar-toggle marginleft25" href="#menu"><span></span></a>');
		}
		else{
			$('body').prepend('<a class="nav-toggle navbar-toggle marginleft25" href="#menu"><span></span></a>');/* visible-xs visible-sm */
		}
		  /* $('nav#menu').addClass('hidden'); */
		$('nav#menu').mmenu({
			"offCanvas": {
				"position": "right",
			},
			navbar: {
				title: "",
			},
			zposition: "front",
		});
		if($('.displayName .disWrap').length > 1 && $.trim(externalId)==""){
			$('.userNameMob').text($('.displayName .disWrap').text());				
		}
		$('.nav-toggle').on('click',function(){		
			$('nav#menu').removeClass('hidden');		
		});
		if(isNewHeader){
			/* added new */
			$(".nav-toggle").on('click',function(){
				setTimeout(function(){
					var tabWidth = $(".mm-panel").width();
					var smallwidth  = tabWidth / 4;
					$(".role_selections .tab").width(tabWidth-17);
					$(".role_selections  .tab button").css("width", smallwidth-5);
				}, 300)   
			});
			$(document).on("click", ".nav-toggle", function () {
				$('html').removeClass('mm-right');
			});
		}
	}
	if($('nav#menu').hasClass('mm-menu')){
		/* $('.mm-listview').css('margin-top','16px'); */
		var api = $('nav#menu').data( "mmenu" );
		/* api.bind( "openPanel", function( $panel ) {
		}); */
		api.bind("openPanel", function($panel) {
			if(!isNewHeader){
				setTimeout(function() {
					if ($(".mm-panels .mm-panel").hasClass("mm-subopened")) {
						$(".closemenu").show();
						
					} else if ($(".mm-panels .mm-panel").hasClass("mm-current")) {
						$(".userName").show();
						$(".closemenu").hide();
					}
				}, 100);
			}
		});
		if(isNewHeader){
			/* added new */
			$(document).on('click', '.mmMenumain.active', function () {
				api.closeAllPanels($("#my-panel"));
			});
		}
	
		$('.closemenu').on('click',function(){
			api.closeAllPanels( $("#my-panel") );
		})
		/* var count=0; */
		$(document).on('click', '.nav-toggle', function() {
			api.close();
		/* 	if (count <= 0) { */
				appendMobileSubscription('0');
				/* count++;
			} */
		})
		api.bind('closed', function () {
			$(".nav-toggle").removeClass("active");
		});
		if(document.querySelector( ".nav-toggle" )!=null){
			document.querySelector( ".nav-toggle" ).addEventListener( "click", function() {
				$(".nav-toggle").addClass("active");
				if(isNewHeader){
					$("#menu ul").css("display", "block");/* added new */
				}
			});
		}
		$(document).on('click','.mmenuTabs li',function(){
			$(".mmenuTabs li").removeClass('active');
			$(this).addClass('active');
			$(".spacePanel").hide();
			$("#" + $(this).data('tabs')).show();
		});
		if(isNewHeader){
			/* added new */
			$('.mmenu_Bordr').click(function () {
				setTimeout(function () {
					if ($(".mm-panels .mm-opened").hasClass("mm-subopened")) {
						$(".mm-panels .mm-opened").addClass('mMenuHide');
						$('.back_menu').hide();
						$('body .nav-toggle.active').addClass('dNone');
						$('.mm-navbar').addClass('shwMmwnu');
					}

					if ($('.spacePanel').hasClass('loggedInUser')) {
						$('.userProfile').hide();
					}

				}, 100)

			});
			$(document).on('click', '.mm-navbar', function () {
				if ($(".mm-panels .mm-opened").hasClass("mm-current")) {
					if($("#mm-1").hasClass("mm-current")){
						$(".mm-panels .mm-opened").removeClass('mMenuHide');
						$('.back_menu').show();
						$('body .nav-toggle.active').removeClass('dNone');
						$('.mm-navbar').removeClass('shwMmwnu');
					}
				}

				if ($('.spacePanel').hasClass('loggedInUser')) {
					if ($(".mm-panels .mm-opened").hasClass("mm-current")) {
						if($("#mm-1").hasClass("mm-current")){
							$('.userProfile').css('display', 'block');	
						}else{
							$('.userProfile').css('display', 'none');	
						}	
					}
				}
			});
			$('.tab button.active').addClass('semibold');  
	
			$('.change_organization').on('click', function(){
				var selected_text = $('#selected_company').text();
				$('.selected_organization li').each(function () {
					if ($(this).text() == selected_text) {
						$(this).addClass('mm-selected');
					}
				});
			});
			$('.selected_organization  li a').on('click', function(){
				$(this).parent().addClass('mm-selected').siblings().removeClass('mm-selected');
				$('#selected_company').text($(this).text()) ;

			});

			 // clicking on role in desktop starts here
			 $('.tablinks').on('click',function(){				
				var cityName = $(this).attr('data-type');
				/* hideTabsForLearner(cityName); */
				selectTabLinks(cityName);
				/* var i, tabcontent, tablinks;
				tabcontent = document.getElementsByClassName("tabcontent");
				for (i = 0; i < tabcontent.length; i++) {
					tabcontent[i].style.display = "none";
				}
				tablinks = document.getElementsByClassName("tablinks");
				for (i = 0; i < tablinks.length; i++) {
					tablinks[i].className = tablinks[i].className.replace(" active", "");
				}
				var ID = '#'+cityName.split(" ")[1];
				$(ID).css({'display':'block'});
				$(this).addClass('active');	 */
				
				if($.trim(cityName).toLowerCase()=="learner"){
					if($.trim($("#txtUsrRole").val())!="learner"){
						learnerView();
					}
					
					// change upper title role starts
					$('.multiple').text(multilingualKeyValue('54','34')); /* 54 : learner */
					// change upper title role ends
					$(".selectPubDet").removeClass("active");
					$(".selectDistDet").removeClass("active");
					/* added for jobs CR */
					clickRespectiveDashboard(); /* fixing this for iDH dashboard change */
					/* added for jobs CR */
				}				
			});
				
			$('.namesDesktop').on('hover',function(){
				selectTabLinks($.trim($("#txtUsrRole").val()));
				/* hideTabsForLearner($.trim($("#txtUsrRole").val())); */
			});
			 // Get the element with id="defaultOpen" and click on it
			//document.getElementById("defaultOpen").click();
			// clicking on role in desktop ends here

			// clicking on role in mobile starts here
			$('.smalltablinks').on('click',function(){
				var cityname = $.trim($(this).attr('data-type'));
				// cityname = $(this).text().toLowerCase();
				selectTabLinksMob(cityname);				
				if($.trim(cityname).toLowerCase()=="learner"){
					if($.trim($("#txtUsrRole").val())!="learner"){
						learnerView();
					}
					/* added for jobs CR */
					$('nav#menu').data("mmenu").close();
					clickRespectiveDashboard(); /* fixing this for iDH dashboard change */
					/* added for jobs CR */
				}
			});
			// Get the element with id="defaultSmallOpen" and click on it
			//document.getElementById("defaultSmallOpen").click();
			
			if($('#sessChk').val()!="" && $('#sessChk').val()!=null && $('#sessChk').val()!=undefined)
				openHeaderPostLogin();
		}
	}
}
function buildMmenu(){
	if($('nav#menu').length > 0){
		if(!($('head').html().indexOf('/EForms/css/onlineApplicationForm/form3090/jquery.mmenu.all.css')>-1 || $('body').html().indexOf('/EForms/css/onlineApplicationForm/form3090/jquery.mmenu.all.css')>-1))
			$('head').append("<link rel='stylesheet' type='text/css' href='"+window.location.protocol+"//"+window.location.host+"/EForms/css/onlineApplicationForm/form3090/jquery.mmenu.all.css?v=iHUB5.0.30'>");
		if(!($('head').html().indexOf('/EForms/js/onlineAppForm/jquery.mmenu.min.all_iHUB_body.js')>-1 || $('body').html().indexOf('/EForms/js/onlineAppForm/jquery.mmenu.min.all_iHUB_body.js')>-1)){
			$.get(window.location.protocol+'//'+window.location.host+'/EForms/js/onlineAppForm/jquery.mmenu.min.all_iHUB_body.js?v=iHUB5.0.28', function() {
				mmenuInsideCall();
			});
		}
		else
			mmenuInsideCall();
	}/* changed by Kiran */
	else if($('.staticMenu').length > 0){
		/* if(!isNewHeader){
			$('form').prepend('<a class="nav-toggle visible-xs visible-sm navbar-toggle marginleft25" href="#menu"><span></span></a>');
		}
		else{ */
		if($('a.nav-toggle').length==0)
			$('body').prepend('<a class="nav-toggle navbar-toggle marginleft25"><span></span></a>');
		/* } */
		if($('.displayName .disWrap').length > 1 && $.trim(externalId)==""){
			$('.userNameMob').text($('.displayName .disWrap').text());				
		}
		/* if(isNewHeader){ */
			$(".nav-toggle").on('click',function(){
				if(isNewLoginSignUp){
					onClickNavToggle();
				}
				else{
					if ($(window).width() < 815) {
						setNewMobMenu();
						$(".staticMenu").show();
						$("body").css("overflow", "hidden");
					}
					setTimeout(function(){
						var tabWidth = $(".staticMenu").width();
						var smallwidth  = tabWidth / 4;
						$(".role_selections .tab").width(tabWidth-17);
						$(".role_selections .tab button").css("width", smallwidth-5);
					}, 300);
					setTimeout(function(){
						$(document).on("click", ".nav-toggle", function () {
							$('html').removeClass('mm-right');
						});
						$(".staticMenu .closeIco").on("click", function () {
							$(".staticMenu").hide();
							$("body").css("overflow", "auto");
						});
						$(".menuBody ul li").on("click", function () {
							$(this).find(".downArrow").toggleClass("arrowUp");
						});
						$(".staticMenu .blueListMenu").on("click", function (e) {
							e.stopPropagation();
						});

						var windowH = $(window).height() - 82;
						$('.menuBody').slimScroll({
							height: windowH,
							alwaysVisible: true,
							railVisible: true
						});
						if($('#sessChk').val()!="" && $('#sessChk').val()!=null && $('#sessChk').val()!=undefined){
							if(!($('.userProfile').hasClass('shwImp')))
								$('.userProfile').addClass('shwImp');
						}
					},200);
				}
			});
			$('.tab button.active').addClass('semibold');  
			/* setTimeout(function(){
				$('.change_organization').on('click', function(){
					var selected_text = $('#selected_company').text();
					$('.selected_organization li').each(function () {
						if ($(this).text() == selected_text) {
							$(this).addClass('mm-selected');
						}
					});
				});
				$('.selected_organization  li a').on('click', function(){
					$(this).parent().addClass('mm-selected').siblings().removeClass('mm-selected');
					$('#selected_company').text($(this).text());

				});
			},200); */
			setTimeout(function(){
				$('.staticMenu .role_selections .getMyProductLists').on('click', function(){
					log($(this).text());
					$('.subtitle').text(multilingualKeyValue('381','34')); 
					$(this).parents('.smalltabcontent:first').find('#selected_company').text($(this).text());
					/* $('#selected_company').text($(this).text()); */
					$('.staticMenu').hide();
					var typeId=$.trim($(this).attr('data-type'));
					$('.staticMenu .role_selections .tab .smalltablinks').each(function() {
						if($(this).attr('data-type')==typeId){
							$(this).addClass('active');
							$('#'+typeId+'List').show();
						}
					});
				});
				$(".staticMenu .smalltabcontent").on("click", function () {
					$(this).find(".downArrow").toggleClass("arrowUp");
				});
			},1000);
			$('.staticMenu #menuList.mobilePLTabsN li').on('click', function(){
				if($.trim($(this).attr('data-toggle'))==""){
					$('.staticMenu').hide();
				}
			});
			$('.staticMenu #menuList.mobilePLTabsN li a').on('click', function(){
				if($.trim($(this).attr('data-toggle'))==""){
					$('.staticMenu').hide();
				}
			});
			 // clicking on role in desktop starts here
			 $('.tablinks').on('click',function(){				
				var cityName = $(this).attr('data-type');
				
				selectTabLinks(cityName);
				
				if($.trim(cityName).toLowerCase()=="learner"){
					if($.trim($("#txtUsrRole").val())!="learner"){
						learnerView();
					}
					// change upper title role starts
					$('.multiple').text(multilingualKeyValue('54','34')); /* 54 : learner */
					// change upper title role ends
					$(".selectPubDet").removeClass("active");
					$(".selectDistDet").removeClass("active");
					/* added for jobs CR */
					clickRespectiveDashboard(); /* fixing this for iDH dashboard change */
					/* added for jobs CR */
				}				
			});
			$('.namesDesktop').on('hover',function(){
				selectTabLinks($.trim($("#txtUsrRole").val()));
				/* hideTabsForLearner($.trim($("#txtUsrRole").val())); */
			});
			 // Get the element with id="defaultOpen" and click on it
			//document.getElementById("defaultOpen").click();
			// clicking on role in desktop ends here

			// clicking on role in mobile starts here
			$('.smalltablinks').on('click',function(){
				var cityname = $.trim($(this).attr('data-type'));
				// cityname = $(this).text().toLowerCase();
				selectTabLinksMob(cityname);				
				if($.trim(cityname).toLowerCase()=="learner"){
					if($.trim($("#txtUsrRole").val())!="learner"){
						learnerView();
						$(".staticMenu").hide();
					}
					/* added for jobs CR */
					clickRespectiveDashboard(); /* fixing this for iDH dashboard change */
					/* added for jobs CR */
				}
				var matchOne = $(this).attr("target");
				$(".staticMenu .smalltabcontent").each(function () {
					$(this).hide();
					if ($(this).attr('id') == matchOne) {
						$(this).show();
					}
				});
			});
			// Get the element with id="defaultSmallOpen" and click on it
			//document.getElementById("defaultSmallOpen").click();
			if($('#sessChk').val()!="" && $('#sessChk').val()!=null && $('#sessChk').val()!=undefined){
				openHeaderPostLogin();
			}
				
		/* } */
	}/* changed by Kiran */
	postHeaderScript();
}
function setNewMobMenu(){
	$(".staticMenu").show();
	if($('#sessChk').val()!="" && $('#sessChk').val()!=null && $('#sessChk').val()!=undefined){
		var userRole=$.trim($('#txtUsrRole').val()).toLowerCase();
		$('.smalltabcontent').each(function() {
			$(this).css('display','none');
		});
		setTimeout(function(){
			$('.smalltablinks').each(function() {
				$(this).removeClass('active');
				if($.trim($(this).attr('data-type')).toLowerCase()==userRole){
					$(this).addClass('active');
					$('#'+$.trim($(this).attr('data-type'))+'List').show();
				}
			});
		},100);
		if(userRole!="learner"){
			if($.trim(store.get('disPubDetails'))!=""){
				var disPubDetails=store.get('disPubDetails');
				var splitDisPubDetails=disPubDetails.split('~~');
				$('.subtitle').text(multilingualKeyValue('381','34'));   /* 'Select an Organization' */
				$('#'+userRole.toLowerCase()+'List').find('#selected_company').text(splitDisPubDetails[1]);
			}
			else{
				var selectedOrgName=userRole=="corporate"?$.trim($('#txtCorporateName').val()):userRole=="distributor"?$.trim($('#txtDistributorName').val()):$.trim($('#txtPublisherName').val());
				$('.subtitle').text(multilingualKeyValue('381','34'));  /*  'Select an Organization' */
				$('#'+userRole.toLowerCase()+'List').find('#selected_company').text(selectedOrgName);
			}
		}
	}
}
window.onhashchange=(function() {
	if(location.hash.length==0 && typeof historyCheck != 'undefined' && historyCheck==false){
			location.reload();
	}
	else if(location.hash.length!=0 && typeof historyCheck == 'undefined'){
		log('out');
		hashStatusVariable=false;
		navigateMyPage();		
	}
	else		
		navigateMyPage();		
	historyCheck=false;
});
function navigateMyPage(){
	if(!hashStatusVariable){
		showLoader();
	    var hash = decodeURIComponent(location.hash);
	    var myPage = hash.substr(1,hash.length);
	    var myPageLocation ;
	    if(hash.indexOf('=')!=-1){
	    	myPage = hash.substr(1,hash.indexOf('=')-1);
	    	myPageLocation = hash.substr(hash.indexOf('=')+1);
	    }
	    if(myPage == instanceId+"@IID@Home/"){
			if($('#micrositeContent').length>0){
				if($('#micrositeContent').hasClass('hidden'))
					callMylogoOnclick();
			}
			else
				callMylogoOnclick();
	    }
	    if(myPage.indexOf(instanceId+'@IID@Home/partnerManagement')>-1){
	    	showAsDistributors();
	    }
	    if(myPage.indexOf(instanceId+"@IID@Home/MyOrganization")>-1){
	    	showMyOrganization();
	    }
	    if(myPage.indexOf(instanceId+"@IID@Home/ManageProducts")>-1){
	    	productClose();
	    	showManageProducts();
	    }
	    if(myPage == instanceId+"@IID@Home/ManageUsers"){
	    	showManageUsers();
	    }
	    if(myPage == instanceId+"@IID@Home/MySubscriptions"){
	    	listing.subscription.showMySubscriptions();
	    }
	    if(myPage == instanceId+"@IID@Home/Announcements"){
	    	listing.dynamicTabs.showTabs(1);
	    }
	    if(myPage == instanceId+"@IID@Home/MySubscriptions/MyCommunities"){
	    	$('.myCommunities').click();
	    }
	    if(myPage == instanceId+"@IID@Home/MySubscriptions/MyCourses"){
	    	$('.myCourses').click();
	    }
		if(myPage == instanceId+"@IID@Home/MySubscriptions/QuestionPaper"){		
	    	$('.QuestionPaper').click();		
	    }
	    if(myPage == instanceId+"@IID@Home/MySubscriptions/OnlineAssessment"){
	    	$('.onlineAssessments').click();
	    }
	    if(myPage == instanceId+"@IID@Home/ViewDistributerLicences"){
	    	showDistributorLicenses();
	    }
	    if(myPage == instanceId+"@IID@Home/MyTransactionHistory"){
	    	showMyTransactionHistory();
	    }
	    if(myPage == instanceId+"@IID@Home/MyAccounts"){
	    	showMyAccount();
	    }
	    if(myPage == instanceId+"@IID@Home/MyCart"){
			if($.trim(externalId)=="" && $.trim($("#txtUsrRole").val()).toLowerCase()!="publisher")
				callGenerateCart();
	    }
		if(myPage.indexOf(instanceId+'@IID@Home/Dashboard&requestFor')>-1){
			var splitMyPage = myPage.split('&');
			var obj = new Object();
			for(var i=0; i<splitMyPage.length;i++){
				if(splitMyPage[i].indexOf('=') > -1){
					obj[splitMyPage[i].split('=')[0]]=splitMyPage[i].split('=')[1];
				}				
			}
			var usrtype=$.trim(obj["usersType"]).toLowerCase();
			var id=$.trim(obj["id"]);
			if(usrtype=="distributor" && id!="")
				selectRespectedDistributor(id);
			else if(usrtype=="Publisher")
				selectRespectedPublisher('firstCall');
	    }
		if(myPage.indexOf(instanceId+'@IID@Home/LearnerDashboard&pageNo')>-1){
			callOnSearch();
			$('#userDashboard').removeClass('hidden');
			fetchLearnerDashboardDetails(myPageLocation);
	    }
		
		if(myPage.indexOf(instanceId+'@IID@Home/HelpCenter')>-1){
			var id=myPage.replace(instanceId+'@IID@Home/HelpCenter','');
	    	redirectHelpCenterPage();
	    }
	    if(myPage == instanceId+"@IID@Home/Catalogue"){
		    if(myPageLocation!="" && myPageLocation!=undefined){
		    	if($.trim(myPageLocation.split('~@~')[0]).toUpperCase()=="REDIRECTTO")
		    		goTofilteredCatalogue(myPageLocation);
		    }
	    }
	}
	hashStatusVariable=false;
	var hashLength=location.hash.length;
	if(!(hashLength > 11) && !(location.href.toLowerCase().indexOf('&hashcontent=') > -1)){
		hashStatusVariable=true;
		if($('#micrositeContent').hasClass('hidden')){
			if($('#sessChk').val()=="" || $('#sessChk').val()==null || $('#sessChk').val()==undefined){
				location.hash=instanceId+"@IID@Home/";
				$('.bredcrum .container .pull-left').html('Home');
				callOnSearch();
				$('#IndexContent').removeClass('hidden');
				$('#search1').addClass('hidden');
				$('.bredcrum').addClass('hidden');
			}
			if($('#sessChk').val()!="" && $('#sessChk').val()!=null && $('#sessChk').val()!=undefined){
			}
		}
	}
	hideLoader_iDH();
	manageFooter();
}
function setLinkHash(hashText){
	var oldHash=location.hash;
	if(oldHash!="")
		oldHash=oldHash.substr(1,oldHash.length);
	if(decodeURIComponent(oldHash)!=decodeURIComponent(hashText)){
		hashStatusVariable=true;
		/* var encodedHash=encodeURIComponent(hashText); */
		var encodedHash=hashText.replace(/\//g,'%2F');
		location.hash=encodedHash;
	}
	hitAnalyticsCheck("","","");
}
function setHeightofDropDown(){
	if($.trim(externalId)==""){
		$(".courseMenu_drop").removeAttr('style');
		$(".mega-dropdown-menu").removeAttr('style');
		var menu_ht=$(".courseMenu_drop").outerHeight();
		var submenu_ht=$(".mega-dropdown-menu").outerHeight();
		if(menu_ht>submenu_ht){
			$(".mega-dropdown-menu").outerHeight(menu_ht);
			$(".courseMenu_drop").outerHeight(menu_ht);
			$(".mega-dropdown-menu").css('min-height',menu_ht);
			$(".courseMenu_drop").css('min-height',menu_ht);
		}
		else{
			$(".courseMenu_drop").outerHeight(submenu_ht);
			$(".mega-dropdown-menu").outerHeight(submenu_ht);
			$(".mega-dropdown-menu").css('min-height',submenu_ht);
			$(".courseMenu_drop").css('min-height',submenu_ht);
		}
	}
}	
function getNameForValue(splitFields,splitVariables){
	var appArray=$('#'+$.trim(splitFields)+'V').val().split(',');
	var valArray=$('#'+$.trim(splitFields)+'N').val().split(',');
	return valArray[appArray.indexOf($.trim(splitVariables))];
}
function getMicrositeHost(){
	var imgEles = "https://rcpi-microsite.s3.amazonaws.com/e725a767f6d3c161331468894211f0eaa866ec30",
    pattern = /^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i;
	var matches = imgEles.match(pattern);
	var domain = matches && matches[1];
	return window.location.protocol+"//"+domain;
}
function getMePriceRange(PriceRange){
	if(PriceRange!=null){
		var min=$.trim(PriceRange.split(':')[0]);
		var max=$.trim(PriceRange.split(':')[1]);
		if($('.slider_range').html()==""){
			if(min!=max && max!=0){
				var maxLength=max.toString().length;
				var firstDigit=Number(max.toString().split('')[0]);
				var lastNo=0;
				var status1=true;
				for(var t=1;t<maxLength;t++){
					if(max%Math.pow(10,t)!=0){
						status1=false;
						break;
					}
				}
				if(status1){
					lastNo=max;			
				}
				else{
					lastNo=(firstDigit+1)*Math.pow(10,(maxLength-1));
				}		
				var first1=0;
				var first2=lastNo*0.1;
				var second1=first2;
				var second2=second1*2;
				var third1=second2;
				var third2=third1*2;
				var fourth1=third2;
				var fourth2=fourth1*2;
				var fifth1=fourth2;
				var fifth2=lastNo;
				var str="";
				str+="<div class='checkbox'><label><input type='checkbox' data-id='txtItemPrice' onclick='filterSearch();' data-txtitemprice='"+first1+":"+first2+"' value=''><span class='addCentre'><i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+first2+"&nbsp;and&nbsp;below</span></label></div>";
				str+="<div class='checkbox'><label><input type='checkbox' data-id='txtItemPrice' onclick='filterSearch();' data-txtitemprice='"+second1+":"+second2+"' value=''><span class='addCentre'><i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+second1+"&nbsp;to&nbsp;<i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+second2+"</span></label></div>";
				str+="<div class='checkbox'><label><input type='checkbox' data-id='txtItemPrice' onclick='filterSearch();' data-txtitemprice='"+third1+":"+third2+"' value=''><span class='addCentre'><i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+third1+"&nbsp;to&nbsp;<i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+third2+"</span></label></div>";
				str+="<div class='checkbox'><label><input type='checkbox' data-id='txtItemPrice' onclick='filterSearch();' data-txtitemprice='"+fourth1+":"+fourth2+"' value=''><span class='addCentre'><i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+fourth1+"&nbsp;to&nbsp;<i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+fourth2+"</span></label></div>";
				str+="<div class='checkbox'><label><input type='checkbox' data-id='txtItemPrice' onclick='filterSearch();' data-txtitemprice='"+fifth1+":"+fifth2+"' value=''><span class='addCentre'><i class=\"fa "+globalCurrencySymbol+"\"></i>&nbsp;"+fifth1+"&nbsp;and&nbsp;above</span></label></div>";
				$('.slider_range').append(str);
			}		
		}
	}
}

function checkPurchaseOptions(productId){
	
	return true;
}
function SetBreadCrumbCatalogue(){
	$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="55" data-b="Home" style="cursor:pointer;">'+multilingualKeyValue('55','34')+'</a><i data-a="56" data-b="Catalogue" aria-hidden="true" class="fa fa-angle-double-right fade_txt" style="padding-right:5px;"></i><strong>'+multilingualKeyValue('56','34')+'</strong>');
}
function SetBreadCrumb(parentTabName,ParentTabOnClickFunctionName,CurrentTabName){
	$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="55" data-b="Home" style="cursor:pointer;">'+multilingualKeyValue('55','34')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i><a onclick="'+ParentTabOnClickFunctionName+';" style="cursor:pointer;">'+parentTabName+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt" style="padding-right:5px;"></i><strong>'+ CurrentTabName+'</strong>');	
}
function getMeDiscountPercentageForMyProduct(productId){
	var discount=0;
	if(distributorProductDiscountQtyDetails!="" && distributorProductDiscountQtyDetails!=undefined){
		var globalVar=distributorProductDiscountQtyDetails.split(',');
		for(var i=0;i<globalVar.length;i++){
			if($.trim(globalVar[i].split('~')[0])==productId){
				discount=globalVar[i].split('~')[1];
				break;
			}
		}
	}	
	return discount;
}
function checkForCollapseAll(){
	var count=0;
	$('#course_list .list-group input[type="checkbox"]').each(function(){
		if(!($(this).parent().parent().parent().next().hasClass('hidden')) && $(this).parent().siblings('i').hasClass('fa-minus')){
			count=count+1;
		}
	});
	if(count>0){
		$('.collapseAllLink').removeClass('hidden');
	}
	else{
		$('.collapseAllLink').addClass('hidden');
	}
}
function getCookieValue(name){
	var nameEQ = name + "=";
	var ca = document.cookie.split(';');
	for(var i=0;i < ca.length;i++) {
		var c = ca[i];
		while (c.charAt(0)==' ') c = c.substring(1,c.length);
		if (c.indexOf(nameEQ) == 0) {
			ret = c.substring(nameEQ.length,c.length);
			switch (ret) {
			case 'true': 
				return true;
			case 'false':
				return false;
			default:
				return ret;
			}
		}
	}
}
function fireResize(){		
    if (document.createEvent) {  /* W3C */
        var ev = document.createEvent('Event');		
        ev.initEvent('resize', true, true);		
        window.dispatchEvent(ev);		
    }		
    else { /*  IE */
        element=document.documentElement;		
        var event=document.createEventObject();		
        element.fireEvent("onresize",event);		
    }
	/* window.dispatchEvent(new Event('resize')); */
}
function hitAnalyticsCheck(category,action,productDetail){
	if(googleAnalyticsId!=""){
			hitAnalytics(googleAnalyticsId,category,action,productDetail);
	}
}
function hitAnalytics(googleAnalyticsId,category,action,productDetail) { 
	  /*(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');*/
    try{
    	ga('create', googleAnalyticsId, {'siteSpeedSampleRate': 100});
	    if($('#app_seq_no').length>0 && $('#app_seq_no').val()!=""){
	    	app_no=$('#app_seq_no').val();
	    	ga('set', 'userId', $('#app_seq_no').val()); /*  Set the user ID using signed-in user_id. */
	    }
	    if(category!="" && action!="" && productDetail!="")
	        ga('send', 'event', category, action, productDetail, true);
	    else{
			ga('set', 'page', "/"+decodeURIComponent(window.location.hash).split("=redirectTo")[0].replace("#1@IID@","/"));
	        ga('send', 'pageview');
	    /* track hash */
		}
    }catch(e){
    	console.log("regenerate");
    }
}
function getMeInstancePubNameId(response){		
	var obj;
	if(typeof indexDetailsTempListICMP == 'object'){
		/* //log("indexDetailsTempListICMP in getMeInstancePubNameId.."+indexDetailsTempListICMP); */
		obj=indexDetailsTempListICMP;
	}
	else{
		var newResponse=JSON.stringify(response);		
		obj = JSON.parse(newResponse); 		
	} 		
	for(label in obj){		
		var val=obj[label];		
		for(label in val){
			if(label=="categories"){
				globalCategories=val[label];                   
			}			
			if(label=="publishers"){		
				instancePubNameId=[];		
				var p=val[label]		
				for(label in p){		
					var p1=p[label];		
					var txtOrganizationName=p1.txtOrganizationName;		
					var Publisher=p1.txtOrgType;		
					var orgID1=$.trim(p1.txtOrgId)=="" ? $.trim(p1.app_seq_no) : $.trim(p1.txtOrgId);
					instancePubNameId.push(txtOrganizationName+"~"+orgID1);		
				}		
				$('#instancePubNameId').remove();
				$('#txtLevel4V').after("<input id=\"instancePubNameId\" type=\"hidden\" name=\"instancePubNameId\" value=\""+instancePubNameId+"\">");						
			}
		}		
	}
	/* if(store.get('txtUsrRole')!="" && store.get('txtUsrRole')!=undefined){
		purchaseActivity("organizeCart","","","","","");	
	} */
}
function browserAlert(){
	var browser=navigator.appCodeName;
	var userAgent=navigator.userAgent;
	if(userAgent.indexOf('MSIE')!=-1){
	    var ie=userAgent.indexOf('MSIE')
	    var initial=parseInt(ie)+5;
	    var version=userAgent.substr(initial,3);
	    if(parseFloat(version).toFixed(2)<9.0)
	     alert(multilingualKeyValue('57','34'));/*  The browser you are using is not compatible with this website.\nRecommended browsers are Chrome, Firefox, IE 10 or above, Safari or any mobile browser. :57 */
	}
}
function showAccordion(name){
	$('#accordion .panel-collapse').each(function(){
		var id=$(this).attr('id');
		if($(this).hasClass('in')){			
			if(!(id==name)){
				$("a[data-target='#"+id+"']").click();				
			}
		}
		else{
			if(id==name){
				$("a[data-target='#"+name+"']").click();
			}
		}
	});
}
function hideAllAccordion(){
	$('#accordion .panel-collapse').each(function(){
		if($(this).hasClass('in')){
			var id=$(this).attr('id');
			$("a[data-target='#"+id+"']").click();
		}
	});
}
function openNextlevels($this){
	$('div.checkbox.nextLevel1 div').css('background','#f3f3f3');
	if($this.parent().siblings('.fa').hasClass('fa-plus'))
		$this.parent().siblings('.fa').click();
	$this.parents('.checkbox').prev().children().children('.fa').each(function(){
		if($(this).hasClass('fa-plus'))
			$(this).click();
	});
}
function checkForExpandAndCollapse($this){
	$this.parents('.checkbox').each(function(){
		if($(this).hasClass('nextLevel1') && $(this).next().find('input:checkbox:checked').length < 1 && $(this).children().find('input:checkbox:checked').length !=1){
			$(this).children().find('.fa').hasClass('fa-minus') ? $(this).children().find('.fa').click() : '';
		}
		$(this).children().children().each(function(){
			if($(this).hasClass('nextLevel1') && $(this).next().find('input:checkbox:checked').length < 1 && $(this).children().find('input:checkbox:checked').length !=1){
				$(this).children().find('.fa').hasClass('fa-minus') ? $(this).children().find('.fa').click() : '';
			}
		});
		if($(this).children().find('input:checkbox:checked').length < 1){
			$(this).closest('.checkbox').prev().children().children('.fa').each(function(){
				if($(this).hasClass('fa-minus') && $(this).parent().find('input:checkbox:checked').length!=1)
					$(this).click();
			});
		}
	});
}
function clearAllFilter(){
	showAccordion('');
	$(".slider_range").fadeOut();
	$('input[id="txtItemPurchaseType"]').removeAttr('checked');
	$('input:checkbox').prop('checked',false);			
	$('.collapseAllLink').click();
	$('#txtItemScheduledStartDate').val('');
	$('#txtItemScheduledEndDate').val('');
	$('.searchfontawesome').parent().children('input').val('');
	$('.yourSearch span[data-filtered="txtSearchText"]').remove();
	filterSearch();
}
function dynamicCalender(source,view,date){
	try{
		dynamicCalenderFinal(source,view,date)
	}
	catch(err) {
		console.log(err);
	} 
	finally {
		catalogueCheck=true;
	}
}
function dynamicCalenderFinal(source,view,date){
	var options = {
		events_source: source,
		view: view,
		tmpl_path: '/EForms/html/form3090/',
		tmpl_cache: true,
		day: date,
		weekbox: false,
		display_week_numbers: false,
		merge_holidays:false,
		modal: "#events-modal",
		modal_type:"template",
		modal_title: function(e) {
			callFnForModal(e.productTypeId,e.date,e.title);
			return e.title
		},
		holidays: {
			
		},
		onAfterEventsLoad: function(events) {
			if (!events) {
				return;
			}
			var list = $('#eventlist');
			list.html('');
			$.each(events, function(key, val) {
				$(document.createElement('li')).html('<a href="' + val.url + '">' + val.title + '</a>').appendTo(list);
			});
		},
		onAfterViewLoad: function(view) {
			log(this.getTitle());
			$('.calgrid-heading .title').text(this.getTitle());
			$('.calgrid-heading .title').attr('data-search',this.getTitle());
			if(view=="day")
				view="date";
			$('.'+view+'ly-schedule').find('.media-middle').text(this.getTitle());
			$('.schedule-filter li').removeClass('active');
			if(view=="date")
				view="day";
			$("li[data-calendar-view='"+view+"']").addClass('active');
			$('div .events-list').parent().addClass('cousorPointer');
			if(currentView=="calender" && (view=="year" || view=="month"))
				callForTransitionFromYearToMonth(view);
		},
		classes: {
			months: {
				general: 'label'
			}
		}
	};
	calendar = $('#calendar').calendar(options);
}
function openTheseFilters(field,value){
	if(field!="" && field!=null && value!="" && value!=null){
		/* var valueArray=value.split(',').filter(String).map(trim).sort(); */
		var valueArray=value.split(',').filter(String).sort();
		/* log(valueArray); */
		if(field=="L1" || field=="L2" || field=="L3" || field=="L4"){
			var searchLevel="";
			switch (field) {
				case 'L1':
					searchLevel = "txtLevel1";
					break;
				case 'L2':
					searchLevel = "txtLevel2";
					break;
				case 'L3':
					searchLevel = "txtLevel3";
					break;
				case 'L4':
					searchLevel = "txtLevel4";
					break;						
			}
			$('input[data-level="'+searchLevel+'"]').each(function(){
				if(valueArray.indexOf($.trim($(this).attr('value')))>-1){
					$(this).parent().parent().removeClass('hidden');
				}
				else{
					$(this).parent().parent().addClass('hidden');
				}
			});
		}
	}	
}
function createCalenderData(catalog,i){
	var productTypeName=catalog.productType;
	var title=catalog.products+" "+productTypeName;
	if(Number(catalog.products) > 1){
		if(productTypeName.slice(productTypeName.length-3,productTypeName.length).toLowerCase()=="ity")
			title=catalog.products+" "+productTypeName.slice(0,productTypeName.length-3)+"ities";
		else
			title=catalog.products+" "+productTypeName+"s";
	}
		
	return {"id": i,
	"title": title,
	"class": "type"+catalog.productTypeId+"-color openModal",
	"productType":productTypeName,
	"productTypeId":catalog.productTypeId,
	"date": catalog.startDate==null ? "" : catalog.startDate.split(' ')[0],
	"start": catalog.startDate==null ? "" : new Date($.trim(catalog.startDate)).valueOf(),
	"end":   ""};
}
function createListDate(catalog,dontRepeat,showYear,isChild){
	var itemPrice=Number(catalog.txtItemPrice);
	var currency=catalog.txtCurrency;
	var currencySymbol=returnMyCurrencySymbol(currency);
	var date=catalog.txtItemScheduledStartDate.split(' ')[0].split('-')[2];
	var year=catalog.txtItemScheduledStartDate.split(' ')[0].split('-')[0];
	var monthBig=monthArray[Number(catalog.txtItemScheduledStartDate.split(' ')[0].split('-')[1])-1];
	var month=monthArraySmall[Number(catalog.txtItemScheduledStartDate.split(' ')[0].split('-')[1])-1];
	var str="",parentProduct=false,expiredChildProduct=false,isExpiredClass="";
	var dateforPP=new Date(catalog.txtItemScheduledStartDate.split(' ')[0]).valueOf();	
	if(catalog.IsParentProduct.toLowerCase()=="yes")
		parentProduct=true;
	if(showYear)
		str+='<div class="cal-year semibold"><a class="btn btn-default">'+year+'</a></div> ';
	/* Product Expire Calculation - start */
	var txtItemStartDate = catalog.availabilityStartDate;
	var txtItemEndDate = catalog.availabilityEndDate;						
	var currentDate = new Date();
	var startDate = new Date();
	var endDate = new Date();
	if(txtItemStartDate!=null && txtItemStartDate!="" && txtItemStartDate!="null" ){
		var a1=txtItemStartDate.split(' ')[0].split('-');
		var a2=txtItemStartDate.split(' ')[1].split(':');
		startDate = new Date(a1[0], a1[1] - 1, a1[2], a2[0], a2[1], a2[2].split('.')[0], 0);
	}
	if(txtItemEndDate!=null && txtItemEndDate!="" && txtItemEndDate!="null" ){
		var b1=txtItemEndDate.split(' ')[0].split('-');
		var b2=txtItemEndDate.split(' ')[1].split(':');
		endDate = new Date(b1[0], b1[1] - 1, b1[2], b2[0], b2[1], b2[2].split('.')[0], 0);
	}
	if(!(startDate <= currentDate && endDate >= currentDate)){
		expiredChildProduct=true;
		isExpiredClass="expiredCurrProduct"
	}
	if(parentProduct)
		str+='<div class="row schedule-content margintop20 posRel"><div class="parentL schedule-content clearfix" id="'+catalog.productId+'-Parent-'+dateforPP+'">';
	else if(isChild)
		str+='<div class="schedule-content margintop10 childL clearfix date-'+dateforPP+' '+isExpiredClass+'">';
	else
		str+='<div class="row schedule-content margintop20 '+isExpiredClass+'">';
	str+='<div class="col-md-1 text-center removepadding">';
	if(dontRepeat)
		str+='<div class="cal-date">'+date+'</div><div class="cal-month semibold">'+month+'</div>';
	str+='</div>';
	str+='<div class="col-md-6 col-sm-7 mobspacing_algn">';
	var txtProductCreationName=catalog.txtProductCreationType;
	str+='<div class="type-circle semibold inline-block marginrgt5 type'+catalog.productTypeId+'-color">'+txtProductCreationName.substring(0,1).toUpperCase()+'<span>'+txtProductCreationName.substring(1,txtProductCreationName.length)+'</span></div>';
	str+='<div class="upcoming-courses inline-block small_width">';
	str+='<div><span class="course-title marginrgt5">'+catalog.ItemName+'</span>';
	if((catalog.countOfChildProducts!="" && catalog.countOfChildProducts!=null && catalog.countOfChildProducts!="null" && catalog.countOfChildProducts!="0") || parentProduct){
		if(Number(catalog.countOfChildProducts)>1)
			title=catalog.countOfChildProducts+' Options';
		else
			title=catalog.countOfChildProducts+' Option';
		str+='<span data-id="variation" title="'+title+'" data-tooltip="tooltip"><i class="fa fa-comments course-noti" aria-hidden="true"></i></span>';
	}
	str+='</div>';
	if($.trim(catalog.location)!="" && catalog.location!=null && catalog.location!="null"){
		var l = catalog.location == null ? '' : catalog.location;
		var showLocation='';
		var splitTempLocation=l.split(';');
		var uniqueNames = [];
		$.each(splitTempLocation, function(i, el){
			if($.inArray(el, uniqueNames) === -1 && $.trim(el)!='') 
				uniqueNames.push(el);
		});
		var joinUnique="";
		if(uniqueNames.length>2)
			joinUnique=uniqueNames[0]+"; "+uniqueNames[1]+" and "+(uniqueNames.length -2 )+" more";
		else if(uniqueNames.length==2)
			joinUnique=uniqueNames[0]+"; "+uniqueNames[1];
		else if(uniqueNames.length==1)
			joinUnique=uniqueNames[0];
		if(joinUnique!="")
			showLocation=joinUnique;
		if(showLocation!=''){
			str+='<div class="subcourse-title"><span data-a="58" data-b="Available">'+multilingualKeyValue('58','34')+'</span>&nbsp;<span data-a="59" data-b="in">'+multilingualKeyValue('59','34')+'</span>&nbsp;<span>'+showLocation+'</span>';
		}
		if(catalog.txtItemScheduledEndDate!="" && catalog.txtItemScheduledEndDate!=null && catalog.txtItemScheduledEndDate!="null" && !parentProduct){
			var endDateS=catalog.txtItemScheduledEndDate.split(' ')[0].split('-');
			var showdate=endDateS[2]+" "+monthArray[Number(endDateS[1])-1]+", "+endDateS[0];
			str+='&nbsp;<span data-a="60" data-b="until">'+multilingualKeyValue('60','34')+'</span>&nbsp;'+showdate;
		}
		str+='</div>';
	}
	else if(catalog.txtItemScheduledEndDate!="" && catalog.txtItemScheduledEndDate!=null && catalog.txtItemScheduledEndDate!="null" && !parentProduct){
		var endDateS=catalog.txtItemScheduledEndDate.split(' ')[0].split('-');
		var showdate=endDateS[2]+" "+monthArray[Number(endDateS[1])-1]+", "+endDateS[0];
		str+='<div class="subcourse-title"><span data-a="58" data-b="Available">'+multilingualKeyValue('58','34')+'</span>&nbsp;<span data-a="60" data-b="until">'+multilingualKeyValue('60','34')+'</span>&nbsp;'+showdate;
		str+='</div>';
	}
	str+='</div></div>';
	str+='<div class="col-md-5 toggleRemovePadding "> ';
	if(!parentProduct){
		if($.trim(catalog.txtItemPurchaseType).toLowerCase()=="free" || itemPrice=="" || itemPrice=='0')
			str+='<span class="orang_txt price_txt marginrgt5" data-a="35" data-b="Free">'+multilingualKeyValue('35','34')+'&nbsp;&nbsp;</span>';
		else
			str+='<span class="orang_txt price_txt marginrgt5"><i class="fa '+currencySymbol+'"></i>&nbsp;'+itemPrice.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ',')+'&nbsp;&nbsp;</span>';
	}
	else{
		str+='<span class="orang_txt price_txt marginrgt5"></span>';
	}
	str+='<div class="inline-block">';
	if(catalog.txtProductMicrositeLink!="")
		str+='<a class="btn btn-sm btn-info-outline viewMicrosite" data-iframe="'+$.trim(catalog.microsite_iframe)+'" data-shortUrl="'+$.trim(catalog.shortURL)+'" data-id="'+catalog.app_seq_no+'" data-name="'+catalog.ItemName+'" data-link="'+catalog.txtProductMicrositeLink+'" data-dismiss="modal" data-a="61" data-b="Find Out More"><i class="fa fa-chevron-right"></i>'+multilingualKeyValue('61','34')+'</a>';
	else
		str+='<a class="btn btn-sm btn-info-outline viewMicrosite" data-iframe="'+$.trim(catalog.microsite_iframe)+'" data-shortUrl="'+$.trim(catalog.shortURL)+'" data-id="'+catalog.app_seq_no+'" data-name="'+catalog.ItemName+'" data-link="'+catalog.txtProductMicrositeLink+'" data-a="61" data-b="Find Out More"><i class="fa fa-chevron-right"></i>'+multilingualKeyValue('61','34')+'</a>';
	var waitListStatus=false,registerInterestStatus=false;	
	if(catalog.waitListStatus!=undefined && catalog.waitListStatus!=null && catalog.waitListStatus!="null" && $.trim(catalog.waitListStatus)!=''){
		if($.inArray('1', catalog.waitListStatus) != -1){ /* considering value of waitListStatus as either 1 or 0 */
			waitListStatus=true;
		}
	}
	if(catalog.registerInterestStatus!=undefined && catalog.registerInterestStatus!=null && catalog.registerInterestStatus!="null" && $.trim(catalog.registerInterestStatus)!=''){
		if($.inArray('1', catalog.registerInterestStatus) != -1){ /* considering value of registerInterestStatus as either 1 or 0 */
			registerInterestStatus=true;
		}
	}
	str+='<span class="lightgreyTxt eliips_div">';
	if(expiredChildProduct && !parentProduct){
		str+='<span class="showWholeText showWholeText1" data-a="448" data-b="No longer available to book">'+multilingualKeyValue('448','34')+'</span>';
		if(waitListStatus){
			if(startDate > currentDate){
				str+='<br><span class="showWholeText showWholeText2" data-a="449" data-b="Waiting List Available">'+multilingualKeyValue('449','34')+'</span>';
			}
			if(endDate < currentDate){
				str+='<br><span class="showWholeText showWholeText3" data-a="450" data-b="Register Interest Available">'+multilingualKeyValue('450','34')+'</span>';
			}
		}
	}
	else if(!parentProduct && !isChild){
		if(catalog.isLimitedSeats=="Yes" && $.trim(catalog.seatsAvailable)!='' && $.trim(catalog.seatsAvailable)!='null' && !isNaN(catalog.seatsAvailable)){
			var tempSeatsAvailable=Number(catalog.seatsAvailable);
			if(tempSeatsAvailable==0){
				str+='<span class="showWholeText showWholeText4" data-a="62" data-b="Fully Booked">'+multilingualKeyValue('62','34')+'!</span>';
				if(waitListStatus){
					if(startDate > currentDate){
						str+='<br><span class="showWholeText showWholeText5" data-a="449" data-b="Waiting List Available">'+multilingualKeyValue('449','34')+'</span>';
					}
					if(endDate < currentDate){
						str+='<br><span class="showWholeText showWholeText6" data-a="450" data-b="Register Interest Available">'+multilingualKeyValue('450','34')+'</span>';
					}
				}
			}
			else if(tempSeatsAvailable < 11){
				str+='<span class="showWholeText showWholeText7" data-a="63" data-b="places remaining">'+multilingualKeyValue('383','34')+''+catalog.seatsAvailable+' '+multilingualKeyValue('63','34')+'!</span>';
			}
			else{
				str+='<span class="showWholeText showWholeText8" data-a="63" data-b="places remaining">'+catalog.seatsAvailable+' '+multilingualKeyValue('63','34')+'!</span>';
			}
		}
	}
	else if(parentProduct || isChild){
		if((catalog.isLimitedSeats=="Yes" && catalog.seatsAvailable!=undefined && catalog.seatsAvailable!=null && catalog.seatsAvailable!='null' && $.trim(catalog.seatsAvailable)!="") || (parentProduct && catalog.isLimitedSeats=="Yes")){			
			log("Is parentProduct.,.."+parentProduct+"catalog.seatsAvailable of "+catalog.ItemName+" "+catalog.seatsAvailable);
			var tempSeatsAvailable=catalog.seatsAvailable;
			if(tempSeatsAvailable.split(',').length > 0){
				var tempSeatsAvailableArr = tempSeatsAvailable.split(',').filter(function( a ) {  return !isNaN(a) && $.trim(a)!=''; });
				if(tempSeatsAvailableArr.every(function(inx){return Number(inx)==0})){
					str+='<span class="showWholeText showWholeText9" data-a="62" data-b="Fully Booked">'+multilingualKeyValue('62','34')+'!</span>';
					if(parentProduct){
						str+='<br><span class="showWholeText showWholeText10" data-a="449" data-b="Waiting List Available">'+multilingualKeyValue('449','34')+'</span>';
					}
				}				
				else if($.inArray('0', tempSeatsAvailableArr) != -1){
					str+='<span class="showWholeText showWholeText11" data-a="64" data-b="Limited places remaining">'+multilingualKeyValue('64','34')+'!</span>';
					if(parentProduct){
						str+='<br><span class="showWholeText showWholeText12" data-a="449" data-b="Waiting List Available">'+multilingualKeyValue('449','34')+'</span>';
					}
				}
				else if(tempSeatsAvailableArr.every(function(inx){return Number(inx)<11})){
					if(isChild){
						var totalSeats=catalog.seatsAvailable;
						str+='<span class="showWholeText showWholeText13" data-a="63" data-b="places remaining">'+multilingualKeyValue('383','34') +''+totalSeats+' '+multilingualKeyValue('63','34')+'!</span>';
					}
					else{
						str+='<span class="showWholeText showWholeText14" data-a="64" data-b="Limited places remaining">'+multilingualKeyValue('64','34')+'!</span>';
					}
					if(waitListStatus){
						str+='<br><span class="showWholeText showWholeText15" data-a="449" data-b="Waiting List Available">'+multilingualKeyValue('449','34')+'</span>';
					}
				}
				else if(tempSeatsAvailableArr.some(checkFor11) && parentProduct){
					str+='<span class="showWholeText showWholeText16" data-a="64" data-b="Limited places remaining">'+multilingualKeyValue('64','34')+'!</span>';
				}
				else{
					var totalSeats = 0;
					$.each(tempSeatsAvailableArr, function(k, v) {
						totalSeats+= Number(v);
					});
					str+='<span class="showWholeText showWholeText17" data-a="63" data-b="places remaining">'+totalSeats+' '+multilingualKeyValue('63','34')+'!</span>';
					if(waitListStatus){
						str+='<br><span class="showWholeText showWholeText18" data-a="449" data-b="Waiting List Available">'+multilingualKeyValue('449','34')+'</span>';
					}
				}
				if(parentProduct){
					if(catalog.txtItemEndDateChildArray!=undefined && catalog.txtItemEndDateChildArray!=null && catalog.txtItemEndDateChildArray!="null" && $.trim(catalog.txtItemEndDateChildArray)){
						$.each(catalog.txtItemEndDateChildArray.split(','), function(k, v) {
							var currentDate,endDate=currentDate = new Date(),txtItemEndDate=v;
							if(txtItemEndDate!=null && txtItemEndDate!="" && txtItemEndDate!="null" ){
								var b1=txtItemEndDate.split(' ')[0].split('-');
								var b2=txtItemEndDate.split(' ')[1].split(':');
								endDate = new Date(b1[0], b1[1] - 1, b1[2], b2[0], b2[1], b2[2].split('.')[0], 0);
							}
							if(endDate < currentDate){
								str+='<br><span class="showWholeText showWholeText19" data-a="450" data-b="Register Interest Available">'+multilingualKeyValue('450','34')+'</span>';
								return false;
							}
						});
					}
				}
				
			}
		}
	}
	str+='</span>';
	if(parentProduct)
		str+='<a class="greyText expandButn" role="button"></a>';
	str+='</div></div>';
	if(parentProduct)	
		str+='</div><div class="childCollps" id="'+catalog.productId+'-Child-'+dateforPP+'"></div>';
	str+='</div>';
	return str;
}
function checkFor11(x){
	return (Number(x) < 11);
}
function openViewAndSchedule(view,schedule){
	$('.diffviews li').removeClass('active');
	$('.schedule-filter li').removeClass('active');
	$("[id*='view']").removeClass('active');
	if(view!="" && schedule!=""){
		$('#'+view+'view').addClass('active');
		if(view=="catalogue"){
			$('.diffviews li:nth-child(1)').addClass('active');
			if(schedule!="none" && !schedule.indexOf('schedule')>-1){
				if(schedule.indexOf('date')>-1)
					$("li[data-calendar-view='day']").addClass('active');
				else
					$("li[data-calendar-view='"+schedule.split('list')[0]+"']").addClass('active');
			}
		}
		else if(view=="list"){
			$('.diffviews li:nth-child(2)').addClass('active');			
			if(schedule!="none" && !schedule.indexOf('schedule')>-1){
				if(schedule.indexOf('date')>-1)
					$("li[data-calendar-view='day']").addClass('active');
				else
					$("li[data-calendar-view='"+schedule.split('list')[0]+"']").addClass('active');
			}
		}
		else if(view=="calender"){
			$('.diffviews li:nth-child(3)').addClass('active');
			if(schedule!="none" && !schedule.indexOf('schedule')>-1){
				$("li[data-calendar-view='"+schedule.split('calender')[0]+"']").addClass('active');
			}
		}
		if(schedule.indexOf('schedule')>-1){
			$('.schedule-filter li:nth-child(1)').addClass('active');
		}		
	}
	else{
		$('.diffviews li:nth-child(1)').addClass('active');
		$('#catalogueview').addClass('active');
	}
}
function getToday(variable){
	var retVariable="";
	var d = new Date();
	var day = d.getDate();
	var month = d.getMonth()+1; /* January is 0! */
	var year = d.getFullYear();
	var weekno="";
	if(day<10){
		day='0'+day;
	} 
	if(month<10){
		month='0'+month;
	} 
	var today = day+'/'+month+'/'+year;
	
	var onejan = new Date(year,0,1);
	weekno=Math.ceil((((d - onejan) / 86400000) + onejan.getDay()+1)/7);
	log(weekno);
	
	if(variable=="day")
		retVariable=day;
	else if(variable=="month")
		retVariable=month;
	else if(variable=="year")
		retVariable=year;
	else if(variable=="date")
		retVariable=today;
	else if(variable=="week")
		retVariable=weekno;
	
	return retVariable;
}
function callFnForModal(productType,date,title){
	filterSearchFlag=false;
	var splitDate=date.split('-');
	var dateC=splitDate[2]+'/'+splitDate[1]+'/'+splitDate[0];
	var calView=$(".schedule-filter li.active").attr('data-calendar-view')
	if(calView=="year"){
		schedule="monthList:"+splitDate[1]+"-"+splitDate[0];
		$('#events-modal').find('.title').text(monthArray[Number(splitDate[1])-1]+" "+splitDate[0]);
	}
	else{
		schedule="date:"+dateC;
		$('#events-modal').find('.title').text(splitDate[2]+" "+monthArray[Number(splitDate[1])-1]+" "+splitDate[0]);
	}
	var modalFields="view@~@schedule@~@txtProductCreationType";
	var modalVariables="modal@~@"+schedule+"@~@"+productType;
	filterSearch(modalFields,modalVariables);
/* 	var fields="view@~@schedule@~@txtProductCreationType";
	var variables="modal@~@"+schedule+"@~@"+productType;	
	createCatalogueDataRequest(fields,variables);
 */	$('#events-modal').on('click',function(){
		$(".cal-year-box .row .cal-cell").removeClass('hoverColor');
		$(".cal-month-box .cal-row-fluid .cal-cell .cal-month-day").removeClass('hoverColor');
	});
	$('#events-modal').find('.viewMicrosite').each(function(){
		if(($.trim($(this).attr('data-iframe'))=="1") || ($.trim($(this).attr('data-iframe'))=="0" && $.trim($(this).attr('data-shortUrl'))=="") || ($.trim($(this).attr('data-iframe'))=="") || $(this).attr('data-link')!=""){
			if($(this).attr('data-link')!="")
				$(this).attr('data-dismiss','modal');
		}
		/* if($(this).attr('data-link')!="")
			$(this).attr('data-dismiss','modal'); */
	});
}
function callForTransitionFromYearToMonth(view){
	if(view=="year"){
		$(".cal-year-box .row .cal-cell.cousorPointer").on("dblclick",function(){
			isCurrentSchedule=false;
			filterSearch();
		});
		$(".cal-year-box .row .cal-cell.cousorPointer span").on('click',function(){
			isCurrentSchedule=false;
			filterSearch();
		});
		$(".cal-year-box .row .cal-cell").on('click',function(){
			if($(this).hasClass('cousorPointer')){
				if($(this).hasClass('hoverColor'))
					$(this).removeClass('hoverColor');
				else{
					$(".cal-year-box .row .cal-cell").removeClass('hoverColor');
					$(this).addClass('hoverColor');				
				}
			}
			else
				$(".cal-year-box .row .cal-cell").removeClass('hoverColor');							
		});
	}
	else if(view=="month"){
		$(".cal-month-box .cal-row-fluid .cal-cell .cal-month-day").on('click',function(){
			if($(this).hasClass('cousorPointer')){
				if($(this).hasClass('hoverColor'))
					$(this).removeClass('hoverColor');
				else{
					$(".cal-month-box .cal-row-fluid .cal-cell .cal-month-day").removeClass('hoverColor');
					$(this).addClass('hoverColor');
				}
			}
			else
				$(".cal-month-box .cal-row-fluid .cal-cell .cal-month-day").removeClass('hoverColor');
		});
	}
	$('body').on("click",function(){
		$(".cal-year-box .row .cal-cell").removeClass('hoverColor');
		$(".cal-month-box .cal-row-fluid .cal-cell .cal-month-day").removeClass('hoverColor');
	});
}
function getCopyRightYear(){
	return $('#copyrightYear').val();
}
function noScheduledDate(){
	$('input:checkbox').prop('checked',false);
	$('#txtItemScheduledStartDate').val('');
	$('#txtItemScheduledEndDate').val('');
	$(".free1").prop('checked', false);
	$(".paid").prop('checked', false);
	var fields="view@~@noScheduledDate";
	var variables="catalogue@~@none";
	createCatalogueDataRequest(fields,variables);
	createMySearchLabels(fields,variables);
}
function checkForEllipsis(){
	$('.checkForEllipsis').each(function(i) {
		if (isEllipsisActive(this)){}
		else{
			$(this).removeAttr('data-original-title');
			$(this).removeAttr('data-title');	
			$(this).removeAttr('title');	
		}			 
	});
}
function isEllipsisActive(e) {
	return (e.offsetWidth < e.scrollWidth);
}
function checkIfRedirectToCustom(fields,variables){
	var splitFields=fields.split('@~@');
	var splitVariables=variables.split('@~@');
	if(splitVariables[splitFields.indexOf('view')].toLowerCase()=="catalogue"){
		openViewAndSchedule("catalogue","none");
		$('#catalogueview').addClass('active');
		return true;
	}		
	else
		return false;	
}
function checkForFooterPosition(){
	if(!($("body").height() > $(window).height())){
		$('.sub-footer').css('position','fixed');
	}
}
(function($) {
    $.fn.goTo = function() {
        $('html, body').animate({
            scrollTop: $(this).offset().top + 'px'
        }, 'fast');
        return this;
    }
})(jQuery);
function acceptCookieConsent(){
	instanceId=$.trim($('#txtInstanceId').val())==""?$.trim($('#instanceId').val()):$.trim($('#txtInstanceId').val());
	orgID=$('#orgId').val();
	store.set('cookiePolicy_'+orgID+'_'+instanceId,'1');
	$('.policy_alert').hide();
}
function setMyPosition(){
	$('#micrositeHeadContent ul#headerContentLinks li a').click(function(){
		var position = micrositeHeaderHeightArray[micrositeHeaderArray.indexOf($(this).attr('data-hashID'))] - Number($('#micrositeHeadContent div.courseNav').height()) + 10;
		$('html, body').animate({scrollTop: position}, ((100 / 100) * 150));
	});
}
function CMA(mAction){
	var message=[{action:"micrositeAction",actionName:mAction}];
	if($('#myRequestMicrosite').length>0){
		document.getElementById('myRequestMicrosite').contentWindow.postMessage(message, "*");
	}
	else{
		if(mAction!=undefined){
			if (eval("typeof "+($.trim(mAction))+" == 'function'"))			
				eval($.trim(mAction)+"()");
		}
	}
}
function checkForCustomLoginModal(){
	if($('#customModalContent').length > 0){
		$('#customModalContent').addClass('hidden');
		$('#loginmodal').find('.modal-content').html($.trim($('#customModalContent').html()));
		$('#customModalContent').html('');
	}
	if($('#customSocialSignUpContent').length > 0){
		$('#userRegistration').find('#socialSignUpDiv').html($.trim($('#customSocialSignUpContent').html()));
		$('#orgRegistration').find('#socialSignUpDivOrg').html($.trim($('#customSocialSignUpContent').html()));
		$('#loginmodal').find('#socialLoginDiv').html($.trim($('#customSocialSignUpContent').html()));
	}
	if($('#customHeaderSignUpContent').length > 0){
		$('#userRegistration').find('#userSignUpHeader').html($.trim($('#customHeaderSignUpContent').html()));
		$('#orgRegistration').find('#orgSignUpHeader').html($.trim($('#customHeaderSignUpContent').html()));
		$('#loginmodal').find('#loginHeader').html($.trim($('#customHeaderSignUpContent').html()));
	}
	if($.trim($('#userRegistration').find('#socialSignUpDiv').html())==""){
		$('#userRegistration').find('#socialSignUp').addClass('hidden');
		$('#orgRegistration').find('#socialSignUpOrg').addClass('hidden');
		$('#loginmodal').find('#socialLogin').addClass('hidden');
		$('#userRegistration').find('#actSignUpData').addClass('col-md-11').removeClass('col-md-8');
	}
}

function getProductDetails(callback,productIds){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({ 
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			sessChk:sessChk,
			txtInstanceId:instanceId,
			languageId:languageId,
			productId:productIds,
			subAction:"getListofproductDetails"
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				/* changed by kiran for user product form bundle product view */
				if($.trim(callback)=="createBundleProductList")
					createBundleProductList(result);
				else
					callback(result);
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster("");//doubt
				//$.toaster({ priority : 'danger', title : '', message : ""});
				callback("");
				fnLogoutICMP('1');
			}
		}
	});
}
function callGenerateCart(){
	if($.trim(externalId)=="" && $.trim($("#txtUsrRole").val()).toLowerCase()!="publisher"){
		callOnSearch();
		if($('#sessChk').val()=="" || $('#sessChk').val()==null){
			if (typeof organizeCartOffline == 'function')
				organizeCartOffline();
		}
		else{
			if(typeof callCartlistData == 'function') 
				callCartlistData();
		}
		hitAnalyticsCheck("View","View cart"," - ");
	}
}
function callGenerateWishlist(){
	if($('#sessChk').val()=="" || $('#sessChk').val()==null){
		checkMyPage();/* $('#loginmodal').modal(); */
	}
	else{
		callOnSearch();
		if($('#WishListContent').html() == ""){ //microsite cart logic
			$('#micrositeContent').addClass('hidden');//hide microsite
			if($.trim(globalUrl)==""){
				instanceId=$('#instanceId').val();
				var url=$.trim($('#instanceJsonPath').val()).replace('/ionstore','');
				globalUrl=url.replace(instanceId+'_A.json','');
			}
			var path=globalUrl+'wishlist.html';
			if(path!=''){
				$('#WishListContent').load(path);
			}
			setTimeout(function() {
				$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="55 data-b="Home" "style="cursor:pointer;">'+multilingualKeyValue('55','34')+'</a><i aria-hidden="true" data-a="65" data-b="My Wishlist" class="fa fa-angle-double-right fade_txt"></i>'+multilingualKeyValue('65','34')+'');
				$('#WishListContent').removeClass('hidden');
				showLoader();
				purchaseActivity("organizeWishlist","","","","","");
			},1000);
		}
		else{
			$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="55 data-b="Home" "style="cursor:pointer;">'+multilingualKeyValue('55','34')+'</a><i aria-hidden="true" data-a="65" data-b="My Wishlist" class="fa fa-angle-double-right fade_txt"></i>'+multilingualKeyValue('65','34')+'');
			$('#WishListContent').removeClass('hidden');
			showLoader();
			purchaseActivity("organizeWishlist","","","","","");		
		}
	}
	viewMicrositeEventHandler();
	/* setLinkHash(instanceId+"@IID@Home/MyWishlist"); */ /* commented as now no hash in jobs */
}
function getCustomHTMLformInstance(htmlName,newWindow){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	/* This function is to get all the instance level HTML */
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			txtInstanceId:instanceId,
			languageId:languageId,
			instanceCols:htmlName,
			subAction:"getInstanceDetails"
		},
		dataType: "json",
		/* async:false, */
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if(newWindow=="parent")
					document.getElementById('customOrderPages').contentWindow.postMessage([{action:"getCustomHTMLformInstanceResponse"},{htmlName:htmlName},{newWindow : newWindow},{orgID:orgID},{instanceId:instanceId},{htmlDetails:JSON.stringify(result)}],'*');					
				else if(newWindow=="opener")
					openCustomOrderPage.postMessage([{action:"getCustomHTMLformInstanceResponse"},{htmlName:htmlName},{newWindow : newWindow},{orgID:orgID},{instanceId:instanceId},{htmlDetails:JSON.stringify(result)}],'*');/* save new window url in openCustomOrderPage */	
				else if(newWindow=="same")
					return JSON.stringify(result);
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		}
	});
}
function log(texttoLog){
	if(logme==true)
		log(texttoLog);
}
function helpCenter(){
	var userid="",userMessage="",subject="",complaintType="",EmailId="",userName="",mobileNumber="",distributorId="",productId="",orderid="",transactionDate="",orgnizationNames="",sessChk="",tokenId="";
	/* changed for jobs CR */
	if($('#txtDistributorId_temp').val()!=undefined)	
		distributorId=$('#txtDistributorId_temp').val();
	/* changed for jobs CR */	
	if($('#productId_temp').val()!=undefined)
		productId=$('#productId_temp').val();
	if($('#orderid_temp').val()!=undefined)
		orderid=$('#orderid_temp').val();
	if($('#transactionDate_temp').val()!=undefined)
		transactionDate=$('#transactionDate_temp').val();
	transactionDate=$.trim(transactionDate)!=""?$.trim(transactionDate).split('.')[0]:"";
	if($('#orgnizationNames').val()!=undefined)
		orgnizationNames=$('#orgnizationNames').val();
	if($('#app_seq_no_div').html()!=undefined)
		userid=$('#app_seq_no_div').html();
	if($('#remarkBy').val()!=undefined)
		userMessage=$('#remarkBy').val();
	if($('#subject').val()!=undefined)
		subject=$('#subject').val();
	if($('#complaintType').val()!=undefined)
		complaintType=$('#complaintType').val();
	if($('#sessChk').val()!=undefined)
		sessChk=$('#sessChk').val();
	/*if($('#tokenId').val()!=undefined)*/
		tokenId=iHUB.token.get();/* $('#tokenId').val(); */	
	if($('#txtEmail_div').html()!=undefined)
		EmailId=$('#txtEmail_div').html();
	else
		EmailId=$('#emailIdHC').val();
	if($('#txtFirstName_div').html()!=undefined)
		userName=$('#txtFirstName_div').html();
	else
		userName=$('#nameHC').val();
	if($('#txtPhoneNumber_div').html()!=undefined)
		mobileNumber=$('#txtPhoneNumber_div').html();
	else
		mobileNumber=$('#mobileNumberHC').val();
	if(transactionDate==""){
		transactionDate=getToday('year')+"-"+getToday('month')+"-"+getToday('day')+" "+new Date().toTimeString().split(' ')[0];
	}
	var key = "",answer = "";
	if(!($('#app_seq_no_div').length>0)){
		key = $('#captchaService_imageKey').val();/* #helpCenterCaptcha  */
		answer = $('#helpCenterCaptcha #captchaService_answer').val(); 
	}
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	$.ajax({ 
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			app_seq_no:userid,
			txtdistributerId:distributorId,
			userName:userName,
			txtEmailId:EmailId,
			txtInstanceId:instanceId,
			languageId:languageId,
			txtPhoneNumber:mobileNumber,
			userMessage:userMessage,
			complaintType:complaintType,
			productId:productId,
			orderid:orderid,
			organizationName:orgnizationNames,
			transactionDate:transactionDate,
			subject:subject,
			subAction:"helpCenter",
			sessChk:sessChk,
			tokenId:tokenId,
			captchaService_imageKey:key,
			captchaService_answer:answer
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if(result.responseDetails.token!=undefined)
					iHUB.token.set(result.responseDetails.token);
				if(!($('#app_seq_no_div').length>0)){
					if(result.responseDetails.captchaStatus!=undefined && result.responseDetails.captchaStatus!=null){
						if($.trim(result.responseDetails.captchaStatus).toLowerCase()!="true"){
							alert(multilingualKeyValue('295','34'));    /* 295:"Please enter correct text shown in image" */
							initiHUB("helpCenterCaptcha");
							return false;
						}
					}
					else{
						return false;
					}
				}
				if(result.responseDetails.message.toLowerCase()=="complaint registered"){
					/* Enquiry/Complaint registered successfully. : 66 */
					/* iHUB.toaster.blackMessageToaster(multilingualKeyValue('mkpc127')); */
					iHUB.toaster.blackMessageToaster($.trim($('select[name="complaintType"] option:selected').html())+multilingualKeyValue('66','34').replace("Complaint",""));
				}
				else{
					/* Error in submitting data. : 67 */
					iHUB.toaster.blackMessageToaster(multilingualKeyValue('67','34'));
				}
				if (typeof fnstoreFeedback == 'function')  
					fnstoreFeedback(result);
				$('#helpcentermodal').modal('hide');
			}
		},
		error: function(x, e){
			iHUB.toaster.blackMessageToaster(x.readyState + " "+ x.status +" "+ e.msg);
			fnLogoutICMP('1');
		}
	});
}
function resolveUserQueries(){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	var complaintNo="",distributorId="",publisherId="",RemarkByDistributor="",RemarkByPublisher="",sessChk="",transactionDate="",tokenId="";
	if($('#complaintNo').val()!=undefined)
		complaintNo= $('#complaintNo').val();
	/*  changed for jobs CR */	
	if($('#txtDistributorId').val()!=undefined)	
		distributorId=$('#txtDistributorId').val();
	/*  changed for jobs CR */		
	if($('#txtPublisherId').val()!=undefined)
		publisherId=$('#txtPublisherId').val();
	if($('#remarkBy').val()!=undefined)
		RemarkByDistributor=$('#remarkBy').val();
	if($('#remarkBy').val()!=undefined)
		RemarkByPublisher=$('#remarkBy').val();
	if($('#complaintStatus').val()!=undefined)
		complaintStatus=$('#complaintStatus').val();
	if($('#sessChk').val()!=undefined)
		sessChk=$('#sessChk').val();
	if($('#tokenId').val()!=undefined)
		tokenId=iHUB.token.get();/* $('#tokenId').val(); */
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({ 
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			complaintNo:complaintNo,
			txtdistributerId:distributorId,
			RemarkByDistributor:RemarkByDistributor,
			txtpublisherId:publisherId,
			RemarkByPublisher:RemarkByPublisher,
			complaintStatus:complaintStatus,
			txtInstanceId:instanceId,
			languageId:languageId,
			subAction:"resolveUserQueries",
			sessChk:sessChk,
			tokenId:tokenId
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				iHUB.token.set(result.responseDetails.token);/* $('#tokenId').val(result.responseDetails.token); */
				if (typeof fnstoreFeedback == 'function')  
					fnstoreFeedback(result,qntyCount);
			}
		},
		error: function(x, e){
			iHUB.toaster.blackMessageToaster(x.status +" "+ e.msg);
			fnLogoutICMP('1');
		}
	}); 
}
function openHelpCenterModal(distributorId,productId,orderid,transactionDate,typeOfQuery){
	$('#complaintType option:first').attr('selected','selected');
	$('#complaintType option').each(function(){
		var currName=$(this).val().toLowerCase();
		var selectedName = typeOfQuery == "" ? "" : typeOfQuery.toLowerCase();
		if($('#app_seq_no_div').length>0){			
			if(currName==selectedName){
				$(this).attr('selected','selected');
			}
		}
		else{
			if(currName=="feedback" || currName=="complaints"){
				$(this).remove();
			}
			else if(currName==selectedName && currName!="feedback" && currName!="complaints"){
				$(this).attr('selected','selected');
			}
		}
	});
	$('[id$="_temp"]').val('');
	$('#txtDistributorId_temp').val(distributorId); /* changed for jobs CR */
	$('#productId_temp').val(productId)
	$('#orderid_temp').val(orderid);
	$('#transactionDate_temp').val(transactionDate);
	openHelpModalMid();
}
function openHelpModal(){
	$('#complaintType option:first').attr('selected','selected');
	$('#complaintType option').each(function(){
		var currName=$(this).val().toLowerCase();
		if(!($('#app_seq_no_div').length>0)){
			if(currName=="feedback" || currName=="complaints"){
				$(this).remove();
			}
		}
	});
	$('[id$="_temp"]').val('');
	openHelpModalMid();
}
function openHelpModalMid(){
	if(!($('#app_seq_no_div').length>0)){
		initiHUB("helpCenterCaptcha");
	}
	iHUB.validation.resetValidationColourText();
	$('textarea#remarkBy').removeAttr('style');
	$('#subject').val('');
	$('#remarkBy').val('');
	$('#nameHC').val('');
	$('#emailIdHC').val('');
	$('#mobileNumberHC').val('');
	$('#complaintType').selectpicker('refresh');
	$('#helpcentermodal').modal();
	$('#helpcentermodal.newUI .form-control').css('border-color','');
}
function validateAndSave(){
	var beforeLogin=true;
	if($('#app_seq_no_div').length>0){
		beforeLogin=false;
	}
	var subject=false,remarkBy=false;
	if($('#complaintType').val()=="" || $('#complaintType').val()=="Select"){
		iHUB.validation.errorMessage("complaintType",multilingualKeyValue('68','34'),"10000");/*  Please select Type of Enquiry/Complaint.:68 */
		return false;
	}
	else{
		iHUB.validation.resetValidationColourText();
	}
	if(beforeLogin){
		if($('#nameHC').val()==""){
			iHUB.validation.errorMessage("nameHC",multilingualKeyValue('69','34'),"10000");/*  Please enter Name.:69 */
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
		}
		if($('#emailIdHC').val()==""){
			iHUB.validation.errorMessage("emailIdHC",multilingualKeyValue('70','34'),"10000");/*  Please Email Id.:70 */
			return false;
		}
		else if(!iHUB.validateEmail.validateEmailId($('#emailIdHC').val(),false)){
			iHUB.validation.errorMessage("emailIdHC",multilingualKeyValue('71','34')+"name@org.com or name@org.co.in","10000");/* The Email ID format is invalid,the valid Email Id format is name@org.com or name@org.co.in:mesg7 */
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
		}
		if($('#mobileNumberHC').val()==""){
			iHUB.validation.errorMessage("mobileNumberHC",multilingualKeyValue('72','34'),"10000");/* Please Mobile Number.:72 */
			return false;
		}
		else if($('#mobileNumberHC').val()!=""){	
			if(isNaN($('#mobileNumberHC').val())){
				iHUB.validation.errorMessage("mobileNumberHC",multilingualKeyValue('73','34'),"10000");/* Please enter Numeric Value as Mobile number.:73 */
				return false;
			}
			if(Number($('#mobileNumberHC').val())==0){
				iHUB.validation.errorMessage("mobileNumberHC",multilingualKeyValue('74','34'),"10000");/*  Please enter a correct mobile number.:74 */
				return false;
			}
			var phoneNo=$('#mobileNumberHC').val();
			var getLength=getPhoneNumberLength().split("@~@");
			if($.trim(phoneNo).length < Number(getLength[1]) || $.trim(phoneNo).length > Number(getLength[0])){
				iHUB.validation.errorMessage("mobileNumberHC",multilingualKeyValue('74','34'),"10000");/* Please enter a correct mobile number of 10 digits.:74 */
				return false;
			}
			else{
				iHUB.validation.resetValidationColourText();
			}
		}
		else{
			iHUB.validation.resetValidationColourText();
		}
	}
	if($.trim($('#subject').val())==""){
		iHUB.validation.errorMessage("subject",multilingualKeyValue('75','34'),"10000");/*  Please enter Subject.:75 */
		return false;
	}
	else if($('#subject').val().length > 0 && ($('#subject').val().length < 5 || $('#subject').val().length > 100)){
		iHUB.validation.errorMessage("subject",multilingualKeyValue('76','34'),"10000");/*  Please write appropriate Subject.:76 */
		return false;
	}
	else{
		subject=true;
		iHUB.validation.resetValidationColourText();
		if($('#remarkBy').val()==""){
			iHUB.validation.errorMessage("remarkBy",multilingualKeyValue('77','34'),"10000");/* Please enter Message.:77 */
			return false;
		}
		else if($('#remarkBy').val().length > 0 && ($('#remarkBy').val().length < 10 || $('#remarkBy').val().length > 1000)){
			iHUB.validation.errorMessage("remarkBy",multilingualKeyValue('78','34'),"10000");/*  Please write appropriate Message.:76 */
			return false;
		}
		else{
			remarkBy=true;
			iHUB.validation.resetValidationColourText();
		}
	}	
	if(remarkBy && subject){
		if(!($('#app_seq_no_div').length>0)){
			if(validateCaptchaiHUBWS("helpCenterCaptcha")){
				helpCenter();
			}
		}
		else{
			helpCenter();
		}
	}
}
function getProductCreationType(typeId){
	var productType="";
	globalCategories=getGlobalCategories();
	if(globalCategories!=undefined){
		$.each(globalCategories, function(k, v) {
			if(v.typeId==typeId)
				productType=v.txtProductType;
		});
	}
	return productType;
}

function isCanBeRedirectedToMicrosite(datalink,shortUrl,isIframe){
	if((($.trim(isIframe)=="0" || $.trim(isIframe)=="3") && $.trim(shortUrl)!="") || (!(($.trim(isIframe)=="0" || $.trim(isIframe)=="3") && $.trim(shortUrl)!="") && $.trim(datalink)!="")){
		return true;
	}
	return false;
}

function getThumbnail(cart,box_ht,pageType){
	var isIframe=$.trim(cart.microsite_iframe);
	var shortUrl=$.trim(cart.shortURL);
	var productImage="",micrositelink="";
	if(cart.txtThumbnailImage!="" && cart.txtThumbnailImage!=null && cart.txtThumbnailImage!="null"){
		productImage=$.trim(cart.txtThumbnailImage);
	}
	else if(cart.productImage!="" && cart.productImage!=null && cart.productImage!="null"){
		productImage=window.location.protocol+"//"+window.location.host+"/per/"+groupID+"/pub/"+orgID+"/EForms/image/"+$.trim(cart.productImage);
	}
	var micrositelink="";
	if(cart.txtProductMicrositeLink!="" && cart.txtProductMicrositeLink!=null && cart.txtProductMicrositeLink!="null"){
		micrositelink=$.trim(cart.txtProductMicrositeLink);
	}
	else if(cart.templateupload!="" && cart.templateupload!=null && cart.templateupload!="null"){
		micrositelink=window.location.protocol+"//"+window.location.host+"/per/"+groupID+"/pub/"+orgID+"/EForms/image/"+$.trim(cart.templateupload);
	}
	var ItemName=cart.ItemName;
	var txtItemshortDesc=cart.txtItemshortDesc;
	var txtItemStartDate=cart.txtItemStartDate;
	var txtProductCreationType=cart.txtProductCreationType;
	var productTypeId=cart.productTypeId;
	var txtItemPurchaseType=$.trim(cart.txtItemPurchaseType).toLowerCase();
	var txtItemPrice=Number(cart.txtItemPrice);			
	var IsItemOnlinePurchaseReqd=$.trim(cart.IsItemOnlinePurchaseReqd).toLowerCase();
	var IsItemActivationRqd=$.trim(cart.IsItemActivationRqd).toLowerCase();
	var txtTotalJoinees=cart.txtTotalJoinees;
	var txtInstructorName=cart.txtInstructorName;
	var productId=cart.productId;
	var txtCurrency=cart.txtCurrency;
	var txtOrgId=cart.txtOrgId;
	var txtDiscountPercentage=cart.txtDiscountPercentage;
	var currencySymbol=returnMyCurrencySymbol(txtCurrency);
	var txtItemDuration=cart.txtItemDuration;
	var txtItemScheduledStartDate=cart.txtItemScheduledStartDate;
	var txtItemScheduledEndDate=cart.txtItemScheduledEndDate;
	var isMultiSlot=$.trim(cart.isMultiSlot);
	var isMultiSlotCart=$.trim(isMultiSlot);
	var customFormId=$.trim(cart.customFormId);// data-customFormId=\""+customFormId+"\"
	/* //log("isMultiSlot:"+isMultiSlot); */
	var accepted_text=$.trim(cart.accepted_text);
	var publisherTnC=$.trim(cart.PublisherTnC);
	var productExpired=$.trim(cart.productExpired).toLowerCase();
	var expiredReason=$.trim(cart.expiredReason);
	if(expiredReason=="txtItemPurchaseType" || expiredReason=="IsItemOnlinePurchaseReqd"){
		productExpired="No";
	}
	var isAssigned=false,isDistributor=false;
	var userRole = $.trim($('#txtUsrRole').val()).toLowerCase();
	if(userRole=="distributor"){
		isDistributor=true;
	}
	var isAssignedValue=cart.isAssigned;
	if(isAssignedValue!=undefined && isAssignedValue!=""){
		if(isAssignedValue.toLowerCase()=="yes"){
			isAssigned=true;
		}
	}
	var txtTimezone=cart.txtTimezone;
	var isGMT=false;
	/* if(txtTimezone!=undefined){
		if(txtTimezone.toLowerCase()=="gmt"){
			isGMT=true;
		}
	}
	else if(orgID=="1193"){
		isGMT=true;
	} */
	var activeCouponCount=cart.activeCouponCount;
	var txtPublisherName=cart.txtPublisherName;
	var IsMemberVerificationRqd=cart.IsMemberVerificationRqd;
	var txtUserAttribute=cart.txtUserAttribute;
	var txtUserAttrubuteValue=cart.txtUserAttrubuteValue;
	var IsParentProduct=$.trim(cart.IsParentProduct).toLowerCase();
	var isMultipleSubscriptionsAllowed=cart.isMultipleSubscriptionsAllowed;
	var isPurchaseButtonReqd=$.trim(cart.isPurchaseButtonReqd);
	var buttonVisibilityFlag=$.trim(isPurchaseButtonReqd)=="0" && isDistributor? false:true;
	var avgRating="",ratingCount="",reviewCount="",rating1="",rating2="",rating3="",rating4="",rating5="",rating1P="0",rating2P="0",rating3P="0",rating4P="0",rating5P="0".isRecommendedCount="";
	avgRating=cart.avgRating == null ? '0' : cart.avgRating;
	isRecommendedCount=cart.isRecommendedCount == null ? '0' : cart.isRecommendedCount;
	ratingCount=cart.ratingCount==null ? '0' : cart.ratingCount;
	reviewCount=cart.reviewCount==null ? '0' : cart.reviewCount;
	rating1=cart.rating1==null ? '0' : cart.rating1;
	rating2=cart.rating2==null ? '0' : cart.rating2;
	rating3=cart.rating3==null ? '0' : cart.rating3;
	rating4=cart.rating4==null ? '0' : cart.rating4;
	rating5=cart.rating5==null ? '0' : cart.rating5;
	if(ratingCount!=0){
		rating1P=Math.ceil(rating1*100/ratingCount);
		rating2P=Math.ceil(rating2*100/ratingCount);
		rating3P=Math.ceil(rating3*100/ratingCount);
		rating4P=Math.ceil(rating4*100/ratingCount);
		rating5P=Math.ceil(rating5*100/ratingCount);
	}
	var purchased=false,MSA=false;
	if($('#app_seq_no_div').length>0){
		var productsPurchased=$.trim($('#productsPurchased').val()); /* changed for jobs CR */
		if(productsPurchased.replace(/ /g,'').split(',').indexOf(productId) > -1 ){
			purchased=true;
			if(isMultipleSubscriptionsAllowed=="1"){
				MSA=true;
			}
			else{
				MSA=false;
			}
		}
	}
	if(isDistributor){
		if(txtItemPurchaseType=="free"){
			txtItemPrice="0";
		}
		IsItemOnlinePurchaseReqd="yes";
		txtItemPurchaseType="paid";
		var distributorDiscount=cart.distributorDiscount;
		if(distributorDiscount!="" && distributorDiscount!=undefined){
			txtDiscountPercentage=distributorDiscount;
		}
	}
	var publisherName = $.trim(cart.txtPublisherName)=="" ? $.trim(getPublisherName(txtOrgId)) : $.trim(cart.txtPublisherName);
	var viewMicrosite = isCanBeRedirectedToMicrosite(micrositelink,shortUrl,isIframe) ? "viewMicrosite cousorPointer" : "viewMicrosite noMicrosite";
	var strFree="";
	var animationClass="",animationAttribute="";
	if($.trim($('#animationReqd').val())=="yes"){
		animationClass = "wow fadeInUp";
		animationAttribute = "data-wow-offset=\"100\" data-wow-duration=\".5s\" style=\"visibility: visible; animation-duration: 0.5s; animation-name: fadeInUp;\"";
	}
	strFree+="<div class=\"slideBox "+animationClass+" "+box_ht+"\" "+animationAttribute+" id=\""+productId+"\">";
	strFree+="<div class=\"type"+productTypeId+"-color list_head clearfix "+viewMicrosite+"\" data-name=\""+ItemName+"\" data-desc=\""+txtItemshortDesc+"\" data-iframe=\""+isIframe+"\" data-shortUrl=\""+shortUrl+"\" data-id=\""+productId+"\" data-link=\""+micrositelink+"\">";	
	if(ItemName.length > 90){
		strFree+="<span class='pull-left content_head whiteText valign_middle'>"+ItemName.substring(0,90)+" ...</span>";
	}
	else{
		strFree+="<span class='pull-left content_head whiteText valign_middle'>"+ItemName+"</span>";
	}
	var memberVeri=memberverification(IsMemberVerificationRqd,txtUserAttribute,txtUserAttrubuteValue);
	if(memberVeri){		
		strFree+='<div class="feature_box">';
		strFree+='<div class="fa-stack" data-placement="top" data-tooltip="tooltip" data-a="451" data-b="Member Verified" title="'+multilingualKeyValue('451','34')+'">';
		strFree+='<i class="fa fa-certificate fa-stack-2x whiteText"></i>';
		strFree+='<i class="fa fa-check fa-stack-1x"></i>';
		strFree+='</div>';
		/* strFree+='<div class="margintop10" data-tooltip="tooltip" data-original-title="Bundle">';
		strFree+='<img src="images/bundle-icon.svg" />';
		strFree+='</div>'; */ /* for bundle */
		strFree+='</div>';
	}	
	strFree+="</div>";
	strFree+="<div class=\"lblHead\">";
	strFree+="<a data-name=\""+ItemName+"\" data-desc=\""+txtItemshortDesc+"\"  data-id=\""+productId+"\" class=\"imgLink "+viewMicrosite+"\" data-iframe=\""+isIframe+"\" data-shortUrl=\""+shortUrl+"\" data-link=\""+micrositelink+"\"><img alt=\""+ItemName+"\" data-src="+productImage+" class='owl-lazy'></a>";
	if(txtProductCreationType!=null && txtProductCreationType!="null" && $.trim(txtProductCreationType)!=""){
		strFree+="<div class=\"verify_patch text-uppercase\">"+txtProductCreationType+"</div>";
	}
	var customActive="",customAddHidden="",customRemoveHidden="hidden",mv="";
	if(globalModuleVisibility!=null && globalModuleVisibility!=undefined){
		mv=globalModuleVisibility.split(',').filter(String).sort();
	}
	if(($('#app_seq_no_div').length > 0 && userRole=="learner") || $('#app_seq_no_div').length<=0 && buttonVisibilityFlag){
		if(IsParentProduct!="yes" && mv.indexOf('9')>-1 && txtItemPurchaseType!="cannot be purchased"){		
			if($('#sessChk').val()!="" && $('#sessChk').val()!=null){
			var wp=$.trim(store.get('myWishlistProducts'));				
				if(wp.indexOf(productId) > -1){							
					customActive="active";
					customAddHidden="hidden";
					customRemoveHidden="";
				}
			}
			strFree+='<div class="wishlistbtn '+customActive+'">';
			strFree+='<a href="javascript:void(0)" class="btn btn-xs btn-default btn-white ATW addToWishlist'+pageType+' '+customAddHidden+'" data-price="'+txtItemPrice+'" data-currency="'+txtCurrency+'" data-id="'+productId+'" data-productname="'+ItemName+'" data-producttype="'+txtProductCreationType+'" data-productduration="'+txtItemDuration+'" data-productdesc="'+txtItemshortDesc+'" data-productimg="'+productImage+'" data-tooltip="tooltip" data-a="79" data-b="Add to Wishlist" title="'+multilingualKeyValue('79','34')+'"><i class="fa fa-heart" aria-hidden="true"></i></a>';
			strFree+='<a href="javascript:void(0)" class="btn btn-xs btn-default btn-white RFW removeFromWishlist'+pageType+' '+customRemoveHidden+'" data-price="'+txtItemPrice+'" data-currency="'+txtCurrency+'" data-id="'+productId+'" data-productname="'+ItemName+'" data-producttype="'+txtProductCreationType+'" data-productduration="'+txtItemDuration+'" data-productdesc="'+txtItemshortDesc+'" data-productimg="'+productImage+'" data-tooltip="tooltip" data-a="80" data-b="Remove From Wishlist" title="'+multilingualKeyValue('80','34')+'"><i class="fa fa-heart" aria-hidden="true"></i></a>';
			strFree+='</div>';
		}
	}		
	strFree+="</div>";
	strFree+="<div class=\"lblContainer\">";
	strFree+="<div class=\"sansR sub_content\">";
	strFree+="<span class='v-ellipsis onhoverout' >"+txtItemshortDesc+"</span>";
	strFree+="<span class='onhoverin' style='display:none;'>"+txtItemshortDesc+"</span>";
	strFree+="</div>";
	var presentS=false;
	var presentE=false;	
	strFree+="<div class=\"clearfix\">";
	if((txtItemScheduledStartDate!=null && txtItemScheduledStartDate!="" && txtItemScheduledStartDate!="null") || (txtItemScheduledEndDate!=null && txtItemScheduledEndDate!="" && txtItemScheduledEndDate!="null") || (txtItemDuration!=null && txtItemDuration!="" && txtItemDuration!="null") ){
		strFree+="<span class=\"small margintop10 semibold\">";
		if(txtItemScheduledStartDate!=null && txtItemScheduledStartDate!="" && txtItemScheduledStartDate!="null" && txtItemScheduledEndDate!=null && txtItemScheduledEndDate!="" && txtItemScheduledEndDate!="null" && $.trim(txtItemScheduledStartDate).split(" ")[0].valueOf() == $.trim(txtItemScheduledEndDate).split(" ")[0].valueOf()){
			if(isGMT)
				txtItemScheduledStartDate=new Date(new Date(txtItemScheduledStartDate.replace(/-/g,'/'))-5.5*60*60*1000).toISOString().replace('T',' ');
			var a=txtItemScheduledStartDate.split(' ')[0];
			strFree+="Date : "+a.slice(8, 10)+"/"+a.slice(5, 7)+"/"+a.slice(0, 4)+""; /* Start : mkpc131 */
		}
		else{
			if(txtItemScheduledStartDate!=null && txtItemScheduledStartDate!="" && txtItemScheduledStartDate!="null" ){
				presentS=true;
				if(isGMT)
					txtItemScheduledStartDate=new Date(new Date(txtItemScheduledStartDate.replace(/-/g,'/'))-5.5*60*60*1000).toISOString().replace('T',' ');
				var a=txtItemScheduledStartDate.split(' ')[0];
				strFree+=""+multilingualKeyValue('81','34')+" : "+a.slice(8, 10)+"/"+a.slice(5, 7)+"/"+a.slice(0, 4)+""; /* Start : 81 */
			}
			if(txtItemScheduledStartDate!=null && txtItemScheduledStartDate!="" && txtItemScheduledStartDate!="null" && txtItemScheduledEndDate!=null && txtItemScheduledEndDate!="" && txtItemScheduledEndDate!="null" ){
				strFree+=" - ";
			}
			if(txtItemScheduledEndDate!=null && txtItemScheduledEndDate!="" && txtItemScheduledEndDate!="null" ){
				presentE=true;
				if(isGMT)
					txtItemScheduledEndDate=new Date(new Date(txtItemScheduledEndDate.replace(/-/g,'/'))-5.5*60*60*1000).toISOString().replace('T',' ');
				var b=txtItemScheduledEndDate.split(' ')[0];
				strFree+=""+multilingualKeyValue('82','34')+" : "+b.slice(8, 10)+"/"+b.slice(5, 7)+"/"+b.slice(0, 4)+""; /* End : 82 */
			}
			if((!(txtItemScheduledStartDate!=null && txtItemScheduledStartDate!="" && txtItemScheduledStartDate!="null") || !(txtItemScheduledEndDate!=null && txtItemScheduledEndDate!="" && txtItemScheduledEndDate!="null")) && txtItemDuration!=null && txtItemDuration!="" && txtItemDuration!="null" ){
				if(!presentS && !presentE)
					strFree+=""+txtItemDuration+"";
				else
					strFree+="&nbsp;("+txtItemDuration+")";
			}
		}
		strFree+="</span>";
	}
	else{
		strFree+="<span class=\"small margintop10 semibold\" style='visibility:hidden'>";
		strFree+="Start";
		strFree+="</span>";
	}
	
	strFree+="<div class=\"small color777 checkForEllipsis offeredbyEllipsis\" title=\""+publisherName+"\" data-a='83' data-b='Offered By'>";
	if(publisherName!=null && publisherName!="" && publisherName!="null"){
		strFree+=""+multilingualKeyValue('83','34')+"&nbsp:&nbsp;<span class='color333'>"+publisherName+"</span>";								
	}
	strFree+="</div>";
	strFree+="</div>";
	strFree+="<div class=\"clearfix\">";
	
	strFree+='<div class="rate_div">';
	if(txtItemPurchaseType=="free" && userRole!="publisher" && productExpired!='yes'){
		if(IsParentProduct!="yes"){			
			if(txtItemPrice!="" && txtItemPrice!=undefined && txtItemPrice!="undefined" && txtItemPrice!=null && txtItemPrice!="null" && Number(txtItemPrice)>0){
				strFree+='<div class="free_stamp" data-a="35" data-b="Free" style="padding-right: 10px;">'+multilingualKeyValue('35','34')+'</div>';
				strFree+='<div class="offer_rate semibold"><span><i class="fa '+currencySymbol+'"></i>&nbsp;'+txtItemPrice.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ',')+'</span></div>';
			}
			else{
				strFree+='<div class="free_stamp" data-a="35" data-b="Free">'+multilingualKeyValue('35','34')+'</div>';
			}
		}
	}
	else if(txtItemPurchaseType=="paid" && userRole!="publisher"){
		if(IsItemOnlinePurchaseReqd=="yes"){
			if(IsParentProduct!="yes"){							
				if(txtDiscountPercentage!="" && txtDiscountPercentage!=undefined && txtDiscountPercentage!="undefined" && txtDiscountPercentage!=null && txtDiscountPercentage!="null" && Number(txtDiscountPercentage)>0 && Number(txtItemPrice)>0){
					strFree+='<div class="orang_txt semibold main_price"><i class="fa '+currencySymbol+'"></i>&nbsp;'+Number((txtItemPrice*(1-(txtDiscountPercentage/100))).toFixed(2)).toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ',')+'</div>';
					strFree+='<div class="offer_rate semibold"><span><i class="fa '+currencySymbol+'"></i>&nbsp;'+txtItemPrice.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ',')+'</span> &nbsp;<span class="discountBlack">('+Math.floor(Number(txtDiscountPercentage))+'%)</span></div>';
				}
				else{
					strFree+='<div class="orang_txt semibold main_price"><i class="fa '+currencySymbol+'"></i>&nbsp;'+txtItemPrice.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g, ',')+'</div>';
				}
			}
		} 
	}
	strFree+='<div class="';
	if($.trim(activeCouponCount)=="" || $.trim(activeCouponCount)=="0")
		strFree+='disnone';
	strFree+=' offer_available">';
	strFree+='<span class="">'+$.trim(activeCouponCount)+'</span> Offer(s) Available';
	strFree+='</div>'; /* not yet implemented */
	
	var showRatingsAndReviews = $.trim($('#showRatingsAndReviews').val()).toLowerCase()=="no" ? false : true;
	if(avgRating>0 && showRatingsAndReviews){
		var showRating="";
		showRating+="<div>";
		showRating+="<div class=\"ratingbarsDiv\"> <span>5 Star</span><div class=\"ratingBars\"><div style=\"width: "+rating5P+"%\" aria-valuemax=\"100\" aria-valuemin=\"0\" aria-valuenow=\""+rating5P+"\" role=\"progressbar\" class=\"progress-bar\"> </div></div> <span> "+rating5+" </span> </div>";
		showRating+="<div class=\"ratingbarsDiv\"> <span>4 Star</span><div class=\"ratingBars\"><div style=\"width: "+rating4P+"%\" aria-valuemax=\"100\" aria-valuemin=\"0\" aria-valuenow=\""+rating4P+"\" role=\"progressbar\" class=\"progress-bar\"> </div></div> <span> "+rating4+" </span> </div>";
		showRating+="<div class=\"ratingbarsDiv\"> <span>3 Star</span><div class=\"ratingBars\"><div style=\"width: "+rating3P+"%\" aria-valuemax=\"100\" aria-valuemin=\"0\" aria-valuenow=\""+rating3P+"\" role=\"progressbar\" class=\"progress-bar\"> </div></div> <span> "+rating3+" </span> </div>";
		showRating+="<div class=\"ratingbarsDiv\"> <span>2 Star</span><div class=\"ratingBars\"><div style=\"width: "+rating2P+"%\" aria-valuemax=\"100\" aria-valuemin=\"0\" aria-valuenow=\""+rating2P+"\" role=\"progressbar\" class=\"progress-bar\"> </div></div> <span> "+rating2+" </span> </div>";
		showRating+="<div class=\"ratingbarsDiv\"> <span>1 Star</span><div class=\"ratingBars\"><div style=\"width: "+rating1P+"%\" aria-valuemax=\"100\" aria-valuemin=\"0\" aria-valuenow=\""+rating1P+"\" role=\"progressbar\" class=\"progress-bar\"> </div></div> <span> "+rating1+" </span> </div>";
		showRating+="</div>	</div>";
		showRating+='<div class="text-center rating_rev margintop10"><span><b>'+ratingCount+'</b>'+multilingualKeyValue('452','34')+' </span>&nbsp;|&nbsp;<span> <b>'+reviewCount+'</b> '+multilingualKeyValue('452','34')+'</span></div>';    /* Ratings:452    Reviews:454 */
		showRating+='<div class="text-center rating_rev marginbottom10">';
		if(Number(isRecommendedCount)!=0){
			showRating+='<span><b>'+isRecommendedCount+'</b> '+multilingualKeyValue('453','34')+'</span>';   /* Users Recommended:453 */
		}
		showRating+='</div>';
		strFree+="<span class=\"rating_btnC smRateC text-center popover-test cousorPointer\" style='margin-left: 10px; vertical-align: middle;' data-container=\"body\" data-toggle=\"popover\" data-placement=\"bottom\" title=\"<b data-a'455' data-b='Rating Details'>"+multilingualKeyValue('455','34')+" </b>\" data-content='"+showRating+"'><span class=\"marginrgt5\">"+avgRating+"</span><i class=\"fa fa-star\" style='color: orange;'></i></span> ";  
	}
	else{
		strFree+="<span>&nbsp;</span>";
	}	
	var subscribedWord = $.trim(multilingualKeyValue('mkpc2345','34'))!="" ? multilingualKeyValue('mkpc2345','34') : "Subscribed";
	if(purchased && !isDistributor && userRole!="publisher"){
		strFree+="<span class=\"paddingleft10 pull-right subscribedButton\" data-id=\""+productId+"\"><span class=\"free\">"+subscribedWord+"</span></span>";
	}
	else{
		strFree+="<span class=\"paddingleft10 pull-right hidden subscribedButton\" data-id=\""+productId+"\"><span class=\"free\">"+subscribedWord+"</span></span>";
	}
	strFree+='</div>'; /* end of rate_div */
	strFree+="</div>";	
	strFree+="<div class=\"clearfix\">";
	strFree+="<div class=\"pull-left margintop10\">";
	if(txtItemPurchaseType=="free" && userRole!="publisher" && productExpired!='yes' && buttonVisibilityFlag){
		if(IsParentProduct!="yes"){
			if(((purchased && MSA) || !purchased) && userRole!="publisher"){
				strFree+="<a data-id=\""+productId+"\" data-name=\""+ItemName+"\" class=\"btn btn-sm btn-info-outline subscribeFreeProducts"+pageType+"\" data-isMultipleSubscriptionsAllowed='"+MSA+"' data-a='84' data-b='Subscribe Now' data-customFormId=\""+customFormId+"\">"+multilingualKeyValue('84','34')+"</a>";
			}
		}
	}
	else if(txtItemPurchaseType=="paid" && userRole!="publisher" && productExpired!='yes' && buttonVisibilityFlag){
		if(IsItemOnlinePurchaseReqd=="yes"){
			if(IsParentProduct!="yes"){
				if(((((purchased && MSA) || !purchased) && !isDistributor) || (isDistributor && isAssigned)) && userRole!="publisher"){
					strFree+="<a data-id=\""+productId+"\" data-price=\""+txtItemPrice+"\" data-currency=\""+txtCurrency+"\" data-productname=\""+ItemName+"\" data-multipleSlot=\""+isMultiSlot+"\" data-acceptedText=\""+accepted_text+"\" data-PublisherTnC=\""+publisherTnC+"\" class=\"btn btn-sm btn-info-outline alActive buyNow"+pageType+"\" onclick=\"javascript:$('.marketplace-wrp').css('padding','0px');\" data-a='85' data-b='Buy Now'  data-customFormId=\""+customFormId+"\">"+multilingualKeyValue('85','34')+"</a>&nbsp;";
				}
				if(IsItemActivationRqd=="yes"){
					if(!isDistributor){
						if(((purchased && MSA) || !purchased) && userRole!="publisher"){
							strFree+="<a data-toggle=\"modal\" data-id=\""+productId+"\" data-price=\""+txtItemPrice+"\" publisher-name=\""+publisherName+"\" data-productname=\""+ItemName+"\" publisher-id=\""+txtOrgId+"\" data-currency =\""+txtCurrency+"\" class=\"btn btn-sm btn-info-outline activate"+pageType+"\" data-isMultipleSubscriptionsAllowed='"+MSA+"' data-a='86' data-b='Activate Now' data-customFormId=\""+customFormId+"\">"+multilingualKeyValue('86','34')+"</a>&nbsp;";
						}
					}
				}
				if(((((purchased && MSA) || !purchased) && !isDistributor) || (isDistributor && isAssigned)) && $.trim(externalId)=="" && checkForEformsLink(productId,'pre')==""){
				if(($.trim(customFormId)=="" && $.trim($('#app_seq_no').val())=="") || $.trim($('#app_seq_no').val())!=""){
					strFree+="<a data-customFormId=\""+customFormId+"\" class=\"btn btn-sm btn-default btn-white cart_ico addToCart"+pageType+"\" data-price =\""+txtItemPrice+"\" data-currency=\""+txtCurrency+"\" data-id=\""+productId+"\" data-productname=\""+ItemName+"\" data-multipleSlot=\""+isMultiSlot+"\" data-acceptedText=\""+accepted_text+"\" data-PublisherTnC=\""+publisherTnC+"\" data-producttype =\""+txtProductCreationType+"\" data-productduration=\""+txtItemDuration+"\" data-productdesc=\""+txtItemshortDesc+"\" data-productimg=\""+productImage+"\" data-tooltip=\"tooltip\" data-a='87' data-b='Add to Cart' title=\""+multilingualKeyValue('87','34')+"\"><i class=\"shoppingCartIcon\"></i></a>";
					}
				}
				else if(isDistributor && !isAssigned){
					strFree+="<a data-id=\""+productId+"\" data-publishername=\""+publisherName+"\" data-productname=\""+ItemName+"\" data-publisherid=\""+txtOrgId+"\" class=\"btn btn-sm btn-info-outline connectToPublisher"+pageType+"\" data-a='456' data-b='Connect To Publisher'>"+multilingualKeyValue('456','34')+"</a>";
				}
			}
		}
		else if(IsItemActivationRqd=="yes"){
			if(!isDistributor){
				if(((purchased && MSA) || !purchased) && userRole!="publisher"){
					strFree+="<a data-toggle=\"modal\" data-id=\""+productId+"\" data-price=\""+txtItemPrice+"\" data-productname=\""+ItemName+"\" publisher-name=\""+publisherName+"\" data-productname=\""+ItemName+"\" publisher-id=\""+txtOrgId+"\" data-currency =\""+txtCurrency+"\" class=\"btn btn-sm btn-info-outline activate"+pageType+"\" data-isMultipleSubscriptionsAllowed='"+MSA+"' data-a='86' data-b='Activate Now' data-customFormId=\""+customFormId+"\">"+multilingualKeyValue('86','34')+"</a>&nbsp;";
				}
			}
			else if(isDistributor && !isAssigned){
				strFree+="<a data-id=\""+productId+"\" data-publishername=\""+publisherName+"\" data-productname=\""+ItemName+"\" data-publisherid=\""+txtOrgId+"\" class=\"btn btn-sm btn-info-outline connectToPublisher"+pageType+"\" data-a='456' data-b='Connect To Publisher'>"+multilingualKeyValue('456','34')+"</a>";
			}
		} 
	}
	strFree+="</div></div>";
	strFree+="</div></div>";	
	return strFree;
}
function callForMultilingual(langId,langName){
	if(languageId!=langId){
		languageId=langId;
		store.set('languageId',langId);
		store.set('languageName',langName);
		languageName=langName;
		languageChanged();
		if (typeof setMultilingualLanguageToSession == 'function')  
			setMultilingualLanguageToSession(store.get('languageName'),masterform_id,orgID);
	}
}
function MicrositeParentURLResponse(){
	if($.trim(globalCategories)=="" || globalCategories==undefined)
		globalCategories=getGlobalCategories();
	var labelList={};
	var url= window.location.href;
	if($.trim(decodeURIComponent(url).split("&subAction=viewMicrosite&")[1])){
		var micrositeLinkDetails = decodeURIComponent(url).split("&subAction=viewMicrosite&")[1].split('&');
		for(var i=0;i<micrositeLinkDetails.length;i++){
			var values=micrositeLinkDetails[i].split("=");
			if(values[0]=="id")
				labelList["productId"]=micrositeLinkDetails[i].split("=")[1];
			if(values[0]=="name")
				labelList["productName"]=micrositeLinkDetails[i].split("=")[1].replace(/\+/g,' ');
		}
	}
	else{
		labelList["productId"]=$('#productId').val();
		labelList["productName"]=$('#productName').val();
	}
	labelList["productsPurchased"]=$('#productsPurchased').val();
	labelList["productsInCart"]=$('#productsInCart').val();
	labelList["productsInWishlist"]=myWishlistProducts;
	labelList["globalCategories"]=globalCategories;
	labelList["instancePubNameId"]=instancePubNameId;
	var mv="";
	//log("globalModuleVisibility.."+globalModuleVisibility);
	if(globalModuleVisibility!=null && globalModuleVisibility!=undefined){
		mv=globalModuleVisibility;
	}
	labelList["moduleVisibility"]=mv;
	labelList["showRatingsAndReviews"]=$.trim($('#showRatingsAndReviews').val()).toLowerCase();
	//log("labelList.."+labelList);
	var a=[{action:"parentURLResponse"},labelList];
	if($('#myRequestMicrosite').length>0){
		document.getElementById('myRequestMicrosite').contentWindow.postMessage(a,"*");
	}
	else
		getMicrositeParentURL(a);
}
function communicateWithParent(action,data){
	if(typeof customCommunicateWithParent == 'function')
		customCommunicateWithParent(action,data);
}
function communicateWithMicrosite(actionIdentifier,data){
	if($('#myRequestMicrosite').length>0){
		document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"communicateWithMicrosite"},{actionIdentifier : actionIdentifier},{data:data}],'*');
	}else{
		var a=[{action:"communicateWithMicrosite"},{actionIdentifier : actionIdentifier},{data:data}];
		if (typeof customCommunicateWithMicrosite == 'function')  
			customCommunicateWithMicrosite(a);
		else
			communicateWithMicrosite(a);
	}
}
function addLanguageDeatails(){
	$('select[id="languageId"]').html('');
	$('select[id="languageId"]').append("<option value='' disabled>Select</option>");
	var strOpt="";
	if(languageDetails!=undefined && languageDetails!="" && languageDetails!=null){
		var langLength=$.map(languageDetails, function(n, i) { return i; }).length;
		if(langLength > 1){
			$('select[id="languageId"]').parent().removeClass('hidden');
			$.each(languageDetails, function(i, el){
				strOpt+="<option value='"+el.lanid+"'>"+el.lanname+"</option>";
			});
			$('select[id="languageId"]').append(strOpt);
			$('select[id="languageId"]').selectpicker('refresh');
		}
		else{
			$('select[id="languageId"]').parent().addClass('hidden');
		}
	}
	
}
function buildLanguageDropDowns(){
	$('#languageDropDown').siblings('.dropdown-menu').html('');
	if(languageDetails!=undefined && languageDetails!="" && languageDetails!=null){
		var langLength=$.map(languageDetails, function(n, i) { return i; }).length;
		if(langLength > 1){
			$.each(languageDetails, function(i, el){
				$('#languageDropDownD').siblings('.dropdown-menu').append('<li><a onclick="callForMultilingual(\''+el.lanid+'\',\''+el.lanname+'\');" class="cousorPointer">'+el.lanname+'</a></li>');
				$('#menu').find('#languageDropDownM').siblings('ul').append('<li><a onclick="callForMultilingual(\''+el.lanid+'\',\''+el.lanname+'\');" href="#" class="cousorPointer">'+el.lanname+'</a></li>');
			});
			$('#languageDropDownD').removeClass('hidden');
			$('#menu').find('#languageDropDownM').removeClass('hidden');
		}
		else{
			$('#languageDropDownD').addClass('hidden');
			$('#menu').find('#languageDropDownM').addClass('hidden');
		}
	}
}
function clickExpandButn(pageNo){
	$('.listingView'+pageNo).find('.expandButn').on('click',function(){
	/* $(document).on('click','.listingView'+pageNo+' .expandButn',function(){ */
		$(this).toggleClass("in");
		$(this).parents(".parentL").next(".childCollps").slideToggle();
		$(this).parents(".parentL").toggleClass("in");
		$(this).parents(".parentL").next(".childCollps").find(".childL").toggleClass("in");
		if($(window).width()<=991){
		var childht=$(this).parents(".parentL").next(".childCollps").find(".childL").height();
		var ch=childht-18;
		var parntht=$(this).parents(".parentL").height();
		var ph=parntht-40;
			$('<style>.parentL.in .type-circle::after{height:'+ph+'px}</style>').appendTo('head');
			$('<style>.childL.in .type-circle::after{height:'+ch+'px}</style>').appendTo('head');
		}
	});
	$('.listingView'+pageNo).find('i.course-noti').on('click',function(){
	/* $(document).on('click','.listingView'+pageNo+' .expandButn',function(){ */
		$(this).parents(".parentL").find('.expandButn').toggleClass("in");
		$(this).parents(".parentL").next(".childCollps").slideToggle();
		$(this).parents(".parentL").toggleClass("in");
		$(this).parents(".parentL").next(".childCollps").find(".childL").toggleClass("in");
		if($(window).width()<=991){
		var childht=$(this).parents(".parentL").next(".childCollps").find(".childL").height();
		var ch=childht-18;
		var parntht=$(this).parents(".parentL").height();
		var ph=parntht-40;
			$('<style>.parentL.in .type-circle::after{height:'+ph+'px}</style>').appendTo('head');
			$('<style>.childL.in .type-circle::after{height:'+ch+'px}</style>').appendTo('head');
		}
	});
}
function languageChanged(){
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	iHUB.multilingual.multilingualFormKeyValue(masterform_id,orgID,store.get('languageName'),instanceId);
	setTimeout(function() {
			appendPasswordRules();
		}, 500);
	 if(eval('generateIndexPage()')){
		if($('#app_seq_no_div').length>0){
			listOfPublisherAndDistributorCall();
		}
		hashStatusVariable=false;
		var oldHash=decodeURIComponent(location.hash.substr(1,location.hash.length));
		if(oldHash!="" && oldHash.indexOf("@IID@Home/Catalogue=redirectTo~@~&subAction=viewMicrosite&")>-1){
			var mParams = oldHash.replace(instanceId+"@IID@Home/Catalogue=redirectTo~@~&subAction=viewMicrosite&","").split('&');
			for(var i=0;i<mParams.length;i++){
				if(mParams[i].split("=")[0]=='id'){
					mProductId=mParams[i].split("=")[1];
					break;
				}
			}
			getProductDetails(changeMicrosite,mProductId);
		}
		else{
			navigateMyPage();
		}
		if(!$('#micrositeContent').length>0){
			setTimeout(function() {
				cartJSPartPreLogin();
			}, 1000);
		}
		tooltipHoverFocus();
	} 
}
function changeMicrosite(result){
	var productDetails = JSON.stringify(result);
	if(productDetails!=undefined && productDetails!="" && JSON.parse(productDetails)["productDetails"]!=undefined){
		viewMicrositeEventHandlerForMicrosite(JSON.parse(productDetails)["productDetails"][0]["productId"],JSON.parse(productDetails)["productDetails"][0]["ItemName"],JSON.parse(productDetails)["productDetails"][0]["txtProductMicrositeLink"],JSON.parse(productDetails)["productDetails"][0]["shortURL"],JSON.parse(productDetails)["productDetails"][0]["microsite_iframe"]);
	}
}
function manageFooter(){
	/* var sum=returnFooterHeight();	
	if(($("body").height() + sum)> $(window).height()){ */
	$('.sub-footer').css('position','relative');
	if($('.mainContainer_iDH').height() > $(window).height()){
		$('.sub-footer').css('position','relative');
	}else{
		$('.sub-footer').css('position','fixed');
	}
}
function returnFooterHeight(){
	var sum=0;
	$('#FooterContent footer > div').map(function(){ return $(this).height() }).toArray().forEach(function(num){sum+=parseFloat(num) || 0;});
	return sum;
}
function forPaymentWindowInFrameYNCheck(){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			txtInstanceId:instanceId,
			languageId:languageId,
			instanceCols:"paymentWindowInFrameYN",
			subAction:"getInstanceDetails"
		},
		dataType: "json",
		/* async:false, */
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				var result=JSON.parse(JSON.stringify(result)).instanceDetails.paymentWindowInFrameYN;
				if(result=="1")
					paymentWindowInFrameYNCheck=false;
				else
					paymentWindowInFrameYNCheck=true;
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /*  session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		}
	});
}
function openHelpCenter(id){
	var filePath="";
	if(id=="Help Center")
		filePath=window.location.protocol+"//"+window.location.host+"/EForms/html/form50896/helpdesk.html";
	else if(id=="Get Started")
		filePath=window.location.protocol+"//"+window.location.host+"/EForms/html/form50896/getstartedhelppage.html";
	else if(id=="Browse Products")
		filePath=window.location.protocol+"//"+window.location.host+"/EForms/html/form50896/brwsprodhelppg.html";
	else if(id=="Buying Products")
		filePath=window.location.protocol+"//"+window.location.host+"/EForms/html/form50896/buyprodhelppg.html";
	else if(id=="Account Management")
		filePath=window.location.protocol+"//"+window.location.host+"/EForms/html/form50896/accounthelppg.html";
	callOnSearch();
	$('#HelpCenterContent').removeClass('hidden');
	if(id!="Help Center")
		SetBreadCrumb("Help Center","openHelpCenter('Help Center')",id);
	else
		$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="55" data-b="Home" style="cursor:pointer;">'+multilingualKeyValue('55','34')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>'+ id+'');
	$("#HelpCenterContent").load(filePath, function( response, status, xhr ) {if ( status == "success" ) { }});
	/* setLinkHash(instanceId+"@IID@Home/HelpCenter/"+id); */ /* commented as now no hash in jobs */ 
} 
function redirectHelpCenterPage(){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			txtInstanceId:instanceId,
			languageId:languageId,
			instanceCols:"helpCenterLink",
			subAction:"getInstanceDetails"
		},
		dataType: "json",
		/* async:false, */
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				var helpCenterLink=JSON.parse(JSON.stringify(result)).instanceDetails.helpCenterLink;
				if(helpCenterLink!="" && helpCenterLink!=null && helpCenterLink!=undefined){
					callOnSearch();			
					$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="55" data-b="Home" style="cursor:pointer;">'+multilingualKeyValue('55','34')+'</a><i data-a="88" data-b="Help Center" aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>'+multilingualKeyValue('88','34')+'');
					var appendFrame='<iframe width="100%" height="100%" src="" class="hidden" name="helpCenterManagement" id="helpCenterManagement" style="background : #eee url(\'/iDH/dashboard/images/iHUBLoader.gif\') no-repeat scroll 50% 27%;"></iframe>';
					$('#HelpCenterContent').append(appendFrame);
					document.getElementById('helpCenterManagement').setAttribute("src","");
					document.getElementById('helpCenterManagement').setAttribute("src",helpCenterLink);
					document.getElementById("helpCenterManagement").style.float="bottom";
					$("#helpCenterManagement").removeClass('hidden');
					$("#helpCenterManagement").parent().removeClass('hidden');
					/* setLinkHash(instanceId+"@IID@Home/HelpCenter"); */ /* commented as now no hash in jobs */
				}
				else{
					alert(multilingualKeyValue('89','34'));/*  Sorry, not available at the moment.:89 */
				}
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		}
	});
}
function getCookie(name){
	var nameEQ = name + "=";
	var ca = document.cookie.split(';');
	for(var i=0;i < ca.length;i++) {
		var c = ca[i];
		while (c.charAt(0)==' ') c = c.substring(1,c.length);
		if (c.indexOf(nameEQ) == 0) {
			ret = c.substring(nameEQ.length,c.length);
			switch (ret) {
				case 'true':
					return true;
				case 'false':
					return false;
				default:
					return ret;
			}
		}
	}
	return null;
}
function owlCarouselArrowHideShow(){
	/* $('.owl-carousel').find('.owl-nav .owl-prev').css({"opacity":"0.3","cursor":"default"}); */
}
function demoFunction(d){
	if(!(d._items[0].hasClass('active')) && !(d._items[(d._items.length-1)].hasClass('active'))){
		d.$element.find('.owl-nav .owl-next').css({"opacity":"1","cursor":"pointer"});
		d.$element.find('.owl-nav .owl-prev').css({"opacity":"1","cursor":"pointer"});
	}
	if ((d._items[0].hasClass('active'))){  
		d.$element.find('.owl-nav .owl-next').css({"opacity":"1","cursor":"pointer"});
		d.$element.find('.owl-nav .owl-prev').css({"opacity":"0.3","cursor":"default"});
		$('.carousel').carousel('pause');
	}
	else if(d._items[(d._items.length-1)].hasClass('active')) {
		var count=0;
		$.each(d._items, function(i, el){
			if(el.hasClass('active'))
				count++;
		});
		if(count<=Number(d.settings.items)){
			d.$element.find('.owl-nav .owl-next').css({"opacity":"0.3","cursor":"default"});	
			d.$element.find('.owl-nav .owl-prev').css({"opacity":"1","cursor":"pointer"});	
		}
		else{
			d.$element.find('.owl-nav .owl-next').css({"opacity":"1","cursor":"pointer"});
			d.$element.find('.owl-nav .owl-prev').css({"opacity":"1","cursor":"pointer"});
		}
	}
}
function callMultiLingual(){
	if(typeof callCustomMultiLingual == 'function')
		return eval('callCustomMultiLingual()');
	else
		return false;
}
function refundCheck(calledFrom,productId,txtloginType,orderId,productPrice,quantity,isCourses){	
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	if((productId!="" && productId!=undefined && productId!=null) || (orderId!="" && orderId!=undefined && orderId!=null)){
		$.ajax({		
			type: "POST",		
			url: url,		
			data: {		
				orgID:orgID,
				orderId:orderId,
				masterform_id:masterform_id,
				languageId:languageId,
				txtloginType:txtloginType,/* Learner or Distributor */
				tokenId:$('#tokenId').val(),
				sessChk:$('#sessChk').val(),				
				app_seq_no:$('#app_seq_no').val(),
				txtInstanceId:instanceId,
				subAction:"refundCheck",
				txtPhoneNumber:$('#txtPhoneNumber_div').html(),
				txtEmailId:$('#txtEmail_div').html(),
				productPrice:productPrice,
				txtquantity:quantity,
				txtproductId:productId,
				isCourses:isCourses,
				userId:$('#app_seq_no').val()
			},		
			dataType: "json",
			async:false,
			success: function(result){
				log(result);
				var condn=iHUB.checkSessionOrToken(result);
				if(eval(condn)){
					if(calledFrom.toLowerCase()=="microsite"){
						document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"refundCheckResponse"},{result:JSON.stringify(result)}], "*");if($('#micrositeContent').length>0  && (!$('#micrositeContent').hasClass('hidden'))){
							if (typeof customRefundCheckResponse == 'function')  
								customRefundCheckResponse(JSON.stringify(result));
							else
								refundCheckResponseM(JSON.stringify(result));
						}
					}
					else{
						refundCheckResponse(result);
					}
				}
			},		
			error: function(x, e){
				if(e=="parsererror" && x.responseText=="session is not avaliable"){				
					alert(multilingualKeyValue('114','34'));   /* 114: Failure */
				}
			}
		}); 
	}
}
function refundCheckResponse(response){
	log(response);
	var newResponse=JSON.stringify(response);
	var obj = JSON.parse(newResponse);
	log(obj);
	for(label in obj){
		var val=obj[label];
		log(val);
		var message=val["message"];
		log(message);
		var tokenId=val["token"];
		log(tokenId);
		
		if(message=="session is not avaliable"){
			$('#updateOrgProfilePop .popContainer .ErrorMsg').text(multilingualKeyValue('90','34'));        /*  The current session has expired.Please re-login to update update the organization details.:90 */
			$('#updateOrgProfilePop .popContainer .ErrorMsg').show();		
			window.parent.fnLogoutICMP('1');
		}
		else if(message=="Invalid Token"){
			alert(multilingualKeyValue('91','34'));   /* Token expired :91*/
		}
		else{
			$('#myModalLabel1612').html('');
			$('#myModalLabel1612').html(multilingualKeyValue('457','34'));              /*  "Refund Process Status":457 */
			$('#alertmsg1612').html('');
			$('#alertmsg1612').html(message);  /* The organization details have been updated successfully.alrt35 */
			$('#alert').modal();
		}
		log("here");
		iHUB.token.set(tokenId);/* $('#tokenId').val(tokenId); */
		log($('#tokenId').val());		
	}
}
function customBuildDynamicSearch_searchDisListDemo(id,searchClass,selector,style,VMappendClass){
	$('#'+id).find('.'+searchClass).parent('div').remove();
	$('#'+id).append('<div class="searchDistrib"><input class="form-control center-block '+searchClass+'" aria-label="Search" placeholder="'+multilingualKeyValue('92','34')+'" type="text"><div onclick="iHUB.search.clearjQuerySearch(\''+searchClass+'\')" class="input-group-addon cousorPointer hidden">X</div></div>');/* Search by name and address - 92 */
}
function customBuildDynamicSearch_organisationListSearchDemo(id,searchClass,selector,style,VMappendClass){
	$('#'+id).find('.'+searchClass).parent('div').remove();
	$('#'+id).append('<div class=""><input class="pull-right form-control searchinput marginbottom10 organisationListSearch '+searchClass+'" data-a="92" data-b="Search by Name or Address" aria-label="Search" placeholder="'+multilingualKeyValue('92','34')+'" type="text"><div onclick="iHUB.search.clearjQuerySearch(\''+searchClass+'\')" class="input-group-addon cousorPointer hidden">X</div></div>');
}
function customBuildDynamicResult_organisationListSearchDemo(id,searchClass,selector,style,VMappendClass){
	$('.'+searchClass+'NoResult').remove();
	$('.'+VMappendClass).append('<div class="col-lg-12 col-md-12 col-sm-12 '+searchClass+'NoResult text-center hidden" data-a="28" data-b="Sorry, No results found">'+multilingualKeyValue('28','34')+'</div>');
}
function customBuildDynamicResult_searchPublisherDemo(id,searchClass,selector,style,VMappendClass){
	$('.'+searchClass+'NoResult').remove();
	$('.'+VMappendClass).append('<div class="margintop10 '+searchClass+'NoResult text-center hidden" data-a="28" data-b="Sorry, No results found">'+multilingualKeyValue('28','34')+'</div>');
}
function customBuildDynamicSearch_searchAggregator(id,searchClass,selector,style,VMappendClass){
	/* $('#'+id).find('.'+searchClass).remove();
	$('#'+id).append('<div class="searchDistrib"><input class="form-control center-block '+searchClass+'" aria-label="Search" placeholder="Search Aggregator" type="text"><div onclick="iHUB.search.clearjQuerySearch(\''+searchClass+'\')" class="input-group-addon cousorPointer hidden">X</div></div>'); */
}
function customBuildDynamicResult_searchAggregator(id,searchClass,selector,style,VMappendClass){
	$('.'+searchClass+'NoResult').remove();
	$('.'+VMappendClass).append('<div class="margintop10 '+searchClass+'NoResult text-center hidden" data-a="28" data-b="Sorry, No results found">'+multilingualKeyValue('28','34')+'</div>');
}
function gmv(a){		
	return iHUB.multilingual.gmv(a);		
}
function checkIfProductExpired(catalog){
	/* var txtItemStartDate = catalog.txtItemStartDate;
	var txtItemEndDate = catalog.txtItemEndDate; */	
	var txtItemStartDate = catalog.availabilityStartDate;
	var txtItemEndDate = catalog.availabilityEndDate;
	var currentDate = new Date();
	var startDate = new Date();
	var endDate = new Date();
	if(txtItemStartDate!=null && txtItemStartDate!="" && txtItemStartDate!="null" ){
		var a1=txtItemStartDate.split(' ')[0].split('-');
		var a2=txtItemStartDate.split(' ')[1].split(':');
		startDate = new Date(a1[0], a1[1] - 1, a1[2], a2[0], a2[1], a2[2].split('.')[0], 0);
	}
	if(txtItemEndDate!=null && txtItemEndDate!="" && txtItemEndDate!="null" ){
		var b1=txtItemEndDate.split(' ')[0].split('-');
		var b2=txtItemEndDate.split(' ')[1].split(':');
		endDate = new Date(b1[0], b1[1] - 1, b1[2], b2[0], b2[1], b2[2].split('.')[0], 0);
	}
	if(!(startDate <= currentDate && endDate >= currentDate)){
		expiredChildProduct=true;
		isExpiredClass="expiredCurrProduct";
		return true;
	}
	else{
		return false;
	}
}
function clone(obj) {
    if (null == obj || "object" != typeof obj) 
		return obj;
    var copy = obj.constructor();
    for (var attr in obj) {
        if (obj.hasOwnProperty(attr)) 
			copy[attr] = obj[attr];
    }
    return copy;
}
function redirectToMicrosite(productId){
	var shortUrl="";
	var isIframe="";
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($.trim(productId)!="" && productId!=undefined && productId!="undefined" && productId!=null && productId!="null"){
		if($('#sessChk').length==0)
			sessChk="";
		else
			sessChk=$('#sessChk').val();
		if($.trim(masterform_id)=="")
			masterform_id=$('#userFormId').val();
		$.ajax({
			type: "POST",
			url: url,
			data: {
				orgID:orgID,
				masterform_id:masterform_id,
				sessChk:sessChk,
				txtInstanceId:instanceId,
				languageId:languageId,
				productId:productId,
				subAction:"getListofproductDetails"
			},
			dataType: "json",
			success: function(result){
				var newResponse=JSON.stringify(result);
				var obj = JSON.parse(newResponse);
				for(label in obj){
					if(label=="productDetails"){
						var val=obj[label];
						if(val.length>0){				
							for (var i = 0; i < val.length; i++){
								var catalog = val[i];
								var pID=catalog.app_seq_no;
								if(pID==productId){
									productName=catalog.ItemName;
									shortUrl=$.trim(catalog.shortURL);
									isIframe=$.trim(catalog.microsite_iframe);
									var datalink="";
									if(cart.txtProductMicrositeLink!="" && cart.txtProductMicrositeLink!=null && cart.txtProductMicrositeLink!="null"){
										datalink=$.trim(cart.txtProductMicrositeLink);
									}
									else if(cart.templateupload!="" && cart.templateupload!=null && cart.templateupload!="null"){
										datalink=window.location.protocol+"//"+window.location.host+"/per/"+groupID+"/pub/"+orgID+"/EForms/image/"+$.trim(cart.templateupload);
									}
								}
							}
						}
					}
				}
			},
			error: function(x, e){
				if(e=="parsererror" && x.responseText=="session is not avaliable"){
					$('#toaster').html('');
					iHUB.toaster.redMessageToaster(''); //doubt
					//$.toaster({ priority : 'danger', title : '', message : ''});
					fnLogoutICMP('1');
				}
			},
			complete:function(){
				if(datalink!="" || (shortUrl!="" && (isIframe=='0' || isIframe=='3'))){
					viewMicrositeEventHandlerForMicrosite(productId,productName,datalink,shortUrl,isIframe);
				}
			}
		});
	}
}
function getPublisherName(txtOrgId){
	var pubname="";
	var pubname=$("input[data-txtorgid='"+txtOrgId+"']").parent().text();	
	/* added bcoz publ name was not comng in dashbaord */
	if($.trim(pubname)==""){
		if(!jQuery.isEmptyObject(publisherDetails)){
			if(!jQuery.isEmptyObject(publisherDetails[txtOrgId]))
				pubname=publisherDetails[txtOrgId].txtOrganizationName;
			
		}/* else if(jQuery.isEmptyObject(publisherDetails)){
			var groupID = $.trim(headerUploadPath).indexOf('/per/') > -1 ? $.trim(headerUploadPath).split('/per/')[1].split('/')[0] : "g01";
			var sessionC = $('#app_seq_no_div').length>0 ? "P" : "A";
			var newJson = new Object();
			/* newJson = newResponse; 
			var jqxhr = $.getJSON("/per/"+groupID+"/pub/"+orgID+"/iDH/instance/"+instanceId+"/home/"+instanceId+"_"+sessionC+".json", function(data) {
			});
			jqxhr.complete(function(data) {
				//log( "second success"+data );
				var newResp=JSON.stringify(data);
				var obj = JSON.parse(newResp);				
				for (label in obj){
					//log('aa');
					if(label=="organizationDetails"){
						publisherDetails=obj[label];
						if(!jQuery.isEmptyObject(publisherDetails[txtOrgId]))
							pubname=publisherDetails[txtOrgId].txtOrganizationName;
					}
				}
				return pubname;
			});
		} */
	}
	/* added bcoz publ name was not comng in dashbaord */
	return pubname;
}
function getDisPubList(){
	return globalDisPubList;
}
var globalCMFormId="3090",applicabilityType="";
/* function openConsentManagementModal(type){
	var userType="";
	if($.trim(type.toLowerCase())=="org"){
		globalCMFormId="3097";
		var termsLink=$('#signUpOrg').attr('data-user');
		if(termsLink!=undefined && termsLink.toLowerCase()=="publisher"){
			
			applicabilityType="Publisher";
		}
		else{
			
			applicabilityType="Distributor";
		} 
	}
	else if($.trim(type.toLowerCase())=="user"){
		globalCMFormId="3090";
		applicabilityType="Learner";
	}
	else{
		globalCMFormId="3090";
		applicabilityType="Learner_Parent";
		type="User";
	}
	applicabilityType="Learner";/* Temporoary fix *//*
	$("#consentManagementModal").find('.modal-body').html('<iframe src="/EForms/html/form3090/consentManagement.html?v=iHUB&orgID='+orgID+'&applicabilityType='+applicabilityType+'&type='+type+'" id="iframe_CM" style="background : #fff url(\'/iDH/dashboard/images/iHUBLoader.gif\') no-repeat scroll 50% 27%;" frameborder="0" scrolling="scrolling"></iframe>');
	/* window.open(window.location.protocol+"//"+window.location.hostname+"/EForms/jsp/Consent.jsp?policyId=&orgId="+$('#orgId').val()+"&appId=9518&userId=&fromDB=&consentAlreadyProvided=No&isInsideSolution=No&policyOrPurpose=Policy","popupWindow", "width=600,height=600,scrollbars=yes"); */
	/*$('#consentManagementModal').modal();
	
	$("#consentManagementModal").on('hidden.bs.modal', function () {
		if($('.modal.in').length!=0)
			$('body').addClass("modal-open");
	});
} */
//modified and added by prajna
function openConsentManagementModal(type){
	var userType="";
	if($.trim(type.toLowerCase())=="org"){
		globalCMFormId="3097";
		var termsLink=$('#signUpOrg').attr('data-user');
		if(termsLink!=undefined && termsLink.toLowerCase()=="publisher"){
			
			applicabilityType="Publisher";
		}
		else{
			
			applicabilityType="Distributor";
		} 
	}
	else if($.trim(type.toLowerCase())=="user"){
		globalCMFormId="3090";
		applicabilityType="Learner";
	}
	else{
		globalCMFormId="3090";
		applicabilityType="Learner_Parent";
		type="User";
	}
	applicabilityType="Learner";/* Temporoary fix */
	$.get('/iDH/dashboard/js/ihubConsent.js?version='+hubversion, function( response, status, xhr ) {
		callPolicydetails(type);				
	});
	
}

//end of new consent
function closeConsentManagementModal(){
	/* $('body').css("overflow","auto"); */
	$('#consentManagementModal').modal('hide');
}
function sendResponseCM(resp,policyObj,applicabilityType){
	log("in marketPlace.js consentGiven is "+resp);
	log("in marketPlace.js applicabilityType is "+applicabilityType);
	log("in marketPlace.js policyObj.toSource is "+JSON.stringify(policyObj));
	var frameName="signUpOrg";
	if(globalCMFormId=="3090"){
		frameName="signUpUser";
		setTimeout(function() {
			appendPasswordRules();
		}, 500);
	}
	if (typeof consentResponseFromUser == 'function' && $.trim(window.location.pathname).split('/').indexOf('SignUp') > -1)
		consentResponseFromUser(resp,policyObj,applicabilityType);
	if($('#'+frameName).parents('.modal:visible').length>0 && typeof document.getElementById(frameName).contentWindow.openAgreeCondition == 'function'){
		if(resp=="1")
			document.getElementById(frameName).contentWindow.openAgreeCondition(policyObj,applicabilityType);
		else
			document.getElementById(frameName).contentWindow.closeAgreeCondition(policyObj,applicabilityType);
	}
	else{
		if(resp=="1")
			openAgreeCondition(policyObj,applicabilityType);
		else
			closeAgreeCondition(policyObj,applicabilityType);
	}
}
function getLanguageId(){
	return languageId;
}
/*changed by Prajna*/
function showConsentPostLogin(appSeqNo,attrValue,isLink){
	if($.trim(appSeqNo)=="" || appSeqNo.toLowerCase()=="user"){
		appSeqNo=$('#app_seq_no_div').html();
	}
	if($("#isMinor_div").html()==1){
		attrValue="minor";
	}
	else{
		attrValue="Learner";
	}
	/*attrValue="Learner"; Temporoary fix */
	if($.trim(attrValue)!="" && attrValue!=undefined && $.trim(appSeqNo)!="" && appSeqNo!=undefined){
		var applicabilityArray = new Array();
		var obj= new Object();
		obj["attrCode"]="UT";
		obj["attrValue"]=attrValue;
		applicabilityArray.push(obj);
		isLink = $.trim(isLink)=="" ? "0" : isLink;
		$.get('/iDH/dashboard/js/ihubConsent.js?version='+hubversion, function( response, status, xhr ) {
			if (typeof getPolicyDetailsPostLogin == 'function')  
			getPolicyDetailsPostLogin(appSeqNo,applicabilityArray);				
		});
		/* getPolicyDetailsForUser(orgId,appId,isInsideSolution,isLink,userId,isRedirect,applArr,solutionSpecificConsentDB) */
		
		/* if (typeof getPolicyDetailsForUser == 'function')  
			getPolicyDetailsForUser(orgID,"306","1",isLink,appSeqNo,"",applicabilityArray);
		log('policy_iframe length..'+$('.policy_iframe').length);
		$('.policy_iframe').contents().find('.consentMgtPop').css('top', '400px'); */
	}
}
/*changed by Prajna*/
function callCSCconnect(){
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	if($.trim(orgID)=="")
		orgID=$('#orgId').val();
	if (typeof cscConnect == 'function')
		cscConnect(orgID, masterform_id);
}
function callFromSuccessPage(sessChk,app_seq_no, userId, confData){
    var dailyPassword = "";
	log('in marketPlace - sessChk : '+sessChk);
	log('in marketPlace - app_seq_no : '+app_seq_no);
	var isEmailVerificationReq=$.trim(store.get("isEmailVerificationReq"))=="" ? "" : store.get("isEmailVerificationReq");
	var notAMinor=false;
	if($('#isUserMinor').length > 0){
		if($.trim($('#isUserMinor').val())=="0"){
			notAMinor=true;
		}
	}
	if(isEmailVerificationReq!="1" && notAMinor){
		if($.trim(userId)=="" || $.trim(confData)==""){
			var url=iHUB.url.iDH();/* iHUB.url.get(); */
			$.ajax({
				type : "POST",
				url : url,
				data : {
					masterform_id : masterform_id,
					orgID : orgID,
					subAction : 'checkdailypasswordrequirement',
					txtInstanceId : instanceId,
				},
				dataType : "json",
				success : function(result) {
					var res = JSON.stringify(result);
					var obj = JSON.parse(res);
					//log(obj);
					if($.trim(obj.isdailypasswordrequired) == "true"){
						var password2 = prompt(multilingualKeyValue('340','34'));    /* "Please enter daily password:" */
						if (password2 == null || password2 == "") {
							return false;
						} else {
							dailyPassword = password2;
						}
					}
					var param="app_seq_no="+app_seq_no+"&masterform_id="+masterform_id+"&orgID="+orgID+"&sessChk="+sessChk+"&subAction=login&txtInstanceId="+instanceId+"&dailyPassword="+dailyPassword;
					window.location=window.location.protocol+"//"+window.location.host+iHUB.url.get()+"?"+param;
				},
				error: function(x, e){
					if(e=="parsererror" && x.responseText=="session is not avaliable"){
						$('#toaster').html('');
						iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
						createLoginLoader();
						fnLogoutICMP('1');
						return false;
					}
				}
			});
		}
		else{
			var currentUrl = window.location.href;
			var form = document.createElement("form");
			form.className = "hidden";
			var element1 = document.createElement("input"); 
			var element2 = document.createElement("input"); 
			var element3 = document.createElement("input"); 
			var element4 = document.createElement("input"); 
			var element5 = document.createElement("input"); 
			var element6 = document.createElement("input"); 
			var element7 = document.createElement("input"); 

			form.method = "POST";
			form.action = iHUB.url.iDH();   

			element1.value=orgID;
			element1.name="orgID";
			form.appendChild(element1);  

			element2.value="validateinstancemandatoryandlogin";
			element2.name="subAction";
			form.appendChild(element2);
							
			element3.value=instanceId;
			element3.name="txtInstanceId";
			form.appendChild(element3);
							
			element4.value=userId;
			element4.name="userid";
			form.appendChild(element4);
							
			element5.value=confData;
			element5.name="confData";
			form.appendChild(element5);
							
			element6.value="iHUB";
			element6.name="loginType";
			form.appendChild(element6);
			
			currentUrl=currentUrl.split("#")[0]; /* fixing for an error */
			element7.value=currentUrl;
			element7.name="refererUrl";
			form.appendChild(element7);
							
			document.body.appendChild(form);

			form.submit();
		}
	}
}
function hideTabsForLearner(selectedRole){
	if($.trim(externalId)!=""){
		$(".activateCode").attr('style','display:none !important');
	}
	var userRole = $.trim(selectedRole)!="" ? $.trim(selectedRole).toLowerCase() : $.trim($("#txtUsrRole").val()).toLowerCase();
	changeHref(userRole); /* changed for jobs CR */
	if(userRole=="learner"){
		$(".dropdown-menu").find("#showAsDistributors").hide();
		$(".defaulter").find("#showAsDistributors").hide();
		$(".mobilePLTabs").find("#showAsDistributors").addClass('hidden');
		$(".dropdown-menu").find("#showManageProducts").hide();
		$(".defaulter").find("#showManageProducts").hide();
		$(".mobilePLTabs").find("#showManageProducts").addClass('hidden');
		$(".dropdown-menu").find("#showMyOrganization").show();
		$(".defaulter").find("#showMyOrganization").show();
		$(".mobilePLTabs").find("#showMyOrganization").removeClass('hidden');
		$(".dropdown-menu").find(".generateWishlist").show();
		$(".defaulter").find(".generateWishlist").show();
		/* added for jobs CR */
		$(".defaulter").find(".myTransactionHistory").show();
		$(".defaulter").find(".showMyAccount").show();
		/* added for jobs CR */
		$(".mobilePLTabs").find(".generateWishlist").removeClass('hidden');
		/* added for jobs CR */
		$(".mobilePLTabs").find(".myTransactionHistory").removeClass('hidden');
		$(".mobilePLTabs").find(".showMyAccount").removeClass('hidden');
			/* added for jobs CR */
		$(".activateCode").attr('style','display:block !important');
		if($(".licence-div").hasClass('hidden')){
			$(".licence-div").removeClass('hidden');
		}
		/* New Change by Kiran  */
		$(".staticMenu .mobilePLTabsN").find("#showAsDistributors").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find("#showManageProducts").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find("#showMyOrganization").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".generateWishlist").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".myTransactionHistory").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".showMyAccount").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".mySubscription").removeClass('hidden');
		/* New Change by Kiran  */
		$("#catlog").removeClass('hidden');
		$('.inputsearchbox').find('.searchboxnew').removeClass('hidden');
		$('.input-group.desktopinpt').removeClass('hidden');
		$(".mmenu_headbkground").find(".showManageProducts").hide();
		$(".mmenu_headbkground").find(".showAsDistributors").hide();
		$(".mmenu_headbkground").find(".showMyOrganization").show();
		//$(".navbarmobile-search").find(".searchbox2").show();
		$(".mainblueSubtab").find(".cart_iconFilterNav").show();
		$(".mainblueSubtab").find(".cart-bubbleqty").attr('style','display: inline-block');
		$("#cartdisp").show();
		$('body').removeClass('publisherMode');	
		/* added for jobs CR */
		$('.additionalbar_header .JobsClass').removeClass('hidden');
		$('.additionalbar_header .CatalogueClass').removeClass('hidden');
		$('.value-selected:first').removeClass('hidden');
		/* added for jobs CR */
	}
	else if(userRole=="distributor"){
		$(".dropdown-menu").find("#showAsDistributors").show();
		$(".defaulter").find("#showAsDistributors").show();
		$(".mobilePLTabs").find("#showAsDistributors").removeClass('hidden');
		$(".dropdown-menu").find("#showManageProducts").hide();
		$(".defaulter").find("#showManageProducts").hide();
		$(".mobilePLTabs").find("#showManageProducts").addClass('hidden');
		$(".dropdown-menu").find("#showMyOrganization").show();
		$(".defaulter").find("#showMyOrganization").show();
		$(".mobilePLTabs").find("#showMyOrganization").removeClass('hidden');
		$(".dropdown-menu").find(".generateWishlist").hide();
		$(".defaulter").find(".generateWishlist").hide();
		/* added for jobs CR */
		$(".defaulter").find(".myTransactionHistory").show();
		$(".defaulter").find(".showMyAccount").hide();
		/* added for jobs CR */
		$(".mobilePLTabs").find(".generateWishlist").addClass('hidden');
		/* added for jobs CR */
		$(".mobilePLTabs").find(".myTransactionHistory").removeClass('hidden');
		$(".mobilePLTabs").find(".showMyAccount").addClass('hidden');
		/* added for jobs CR */
		/* New Change by Kiran  */
		$(".staticMenu .mobilePLTabsN").find("#showAsDistributors").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find("#showManageProducts").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find("#showMyOrganization").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".generateWishlist").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".myTransactionHistory").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".showMyAccount").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".mySubscription").addClass('hidden');
		/* New Change by Kiran  */
		
		$(".activateCode").attr('style','display:none !important');
		$(".licence-div").addClass('hidden');
		$("#catlog").removeClass('hidden');
		$('.inputsearchbox').find('.searchboxnew').removeClass('hidden');
		$('.input-group.desktopinpt').removeClass('hidden');
		$(".mmenu_headbkground").find(".showManageProducts").hide();
		$(".mmenu_headbkground").find(".showAsDistributors").show();
		$(".mmenu_headbkground").find(".showMyOrganization").show();
		//$(".navbarmobile-search").find(".searchbox2").show();
		$(".mainblueSubtab").find(".cart_iconFilterNav").show();
		$(".mainblueSubtab").find(".cart-bubbleqty").attr('style','display: inline-block');
		$("#cartdisp").show();
		$('body').removeClass('publisherMode');	
		/* added for jobs CR */
		$('.additionalbar_header .JobsClass').addClass('hidden');
		$('.additionalbar_header .CatalogueClass').removeClass('hidden');
		$('.value-selected:first').removeClass('hidden');
		/* added for jobs CR */
	}
	else if(userRole=="publisher"){
		$(".dropdown-menu").find("#showAsDistributors").show();
		$(".defaulter").find("#showAsDistributors").show();
		$(".mobilePLTabs").find("#showAsDistributors").removeClass('hidden');
		$(".dropdown-menu").find("#showManageProducts").show();
		$(".defaulter").find("#showManageProducts").show();
		$(".mobilePLTabs").find("#showManageProducts").removeClass('hidden');
		$(".dropdown-menu").find("#showMyOrganization").show();
		$(".defaulter").find("#showMyOrganization").show();
		$(".mobilePLTabs").find("#showMyOrganization").removeClass('hidden');
		$(".dropdown-menu").find(".generateWishlist").hide();
		/* added for jobs CR */
		$(".defaulter").find(".myTransactionHistory").show();
		$(".defaulter").find(".showMyAccount").hide();
		/* added for jobs CR */
		$(".defaulter").find(".generateWishlist").hide();
		$(".mobilePLTabs").find(".generateWishlist").addClass('hidden');
		/* added for jobs CR */
		$(".mobilePLTabs").find(".myTransactionHistory").removeClass('hidden');
		$(".mobilePLTabs").find(".showMyAccount").addClass('hidden');
		/* added for jobs CR */
		/* New Change by Kiran  */
		$(".staticMenu .mobilePLTabsN").find("#showAsDistributors").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find("#showManageProducts").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find("#showMyOrganization").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".generateWishlist").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".myTransactionHistory").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".showMyAccount").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".mySubscription").addClass('hidden');
		/* New Change by Kiran  */
		
		$(".activateCode").attr('style','display:none !important');
		$(".licence-div").addClass('hidden');
		/* Changes by Kiran  */
		$("#catlog").removeClass('hidden');
		$('.inputsearchbox ').find('.searchboxnew').removeClass('hidden');		
		$('.input-group.desktopinpt').removeClass('hidden');
		/* Changes by Kiran  */
		$(".mmenu_headbkground").find(".showManageProducts").show();
		$(".mmenu_headbkground").find(".showAsDistributors").show();
		$(".mmenu_headbkground").find(".showMyOrganization").show();
		$(".navbarmobile-search").find(".searchbox2").hide();
		$(".mainblueSubtab").find(".cart_iconFilterNav").hide();
		$(".mainblueSubtab").find(".cart-bubbleqty").attr('style','display: none');
		if($('#search2').length>0){
			document.getElementById("search2").style.marginRight="109px";
			document.getElementById("search2").style.marginTop="4px";
		}
		$("#cartdisp").hide();
		$('body').addClass('publisherMode');
		/* if($.trim(selectedRole)=="")
			showAsDistributors(); */
	/* added for jobs CR */		
		$('.additionalbar_header .JobsClass').addClass('hidden');
		$('.additionalbar_header .CatalogueClass').addClass('hidden');
	}
	else if(userRole=="corporate"){
		
		$(".dropdown-menu").find("#showAsDistributors").hide();
		$(".defaulter").find("#showAsDistributors").hide();
		$(".mobilePLTabs").find("#showAsDistributors").addClass('hidden');
		$(".dropdown-menu").find("#showManageProducts").hide();
		$(".defaulter").find("#showManageProducts").hide();
		$(".mobilePLTabs").find("#showManageProducts").addClass('hidden');
		$(".dropdown-menu").find("#showMyOrganization").show();
		$(".defaulter").find("#showMyOrganization").show();
		$(".mobilePLTabs").find("#showMyOrganization").removeClass('hidden');
		$(".dropdown-menu").find(".generateWishlist").hide();
		$(".defaulter").find(".generateWishlist").hide();
		$(".defaulter").find(".myTransactionHistory").hide();
		$(".defaulter").find(".showMyAccount").hide();
		$(".mobilePLTabs").find(".generateWishlist").addClass('hidden');
		$(".mobilePLTabs").find(".myTransactionHistory").addClass('hidden');
		$(".mobilePLTabs").find(".showMyAccount").addClass('hidden');
		$(".activateCode").attr('style','display:none !important');
		$(".licence-div").addClass('hidden');
		$("#catlog").removeClass('hidden');
		
		/* New Change by Kiran  */
		$(".staticMenu .mobilePLTabsN").find("#showAsDistributors").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find("#showManageProducts").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find("#showMyOrganization").parent().removeClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".generateWishlist").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".myTransactionHistory").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".showMyAccount").parent().addClass('hidden');
		$(".staticMenu .mobilePLTabsN").find(".mySubscription").addClass('hidden');
		/* New Change by Kiran  */
		
		$('.inputsearchbox').find('.searchboxnew').removeClass('hidden');
		$('.input-group.desktopinpt').removeClass('hidden');
		$(".mmenu_headbkground").find(".showManageProducts").hide();
		$(".mmenu_headbkground").find(".showAsDistributors").hide();
		$(".mmenu_headbkground").find(".showMyOrganization").show();
		//$(".navbarmobile-search").find(".searchbox2").show();
		$(".mainblueSubtab").find(".cart_iconFilterNav").hide();
		$(".mainblueSubtab").find(".cart-bubbleqty").attr('style','display: none');
		$("#cartdisp").hide();
		$('body').removeClass('publisherMode');
		$('.additionalbar_header .JobsClass').addClass('hidden');
		$('.additionalbar_header .CatalogueClass').addClass('hidden');
		$('.value-selected:first').addClass('hidden');

	}
	/* added for jobs CR */
}
function getProductName(prID){
	var prName=$.trim(prID);
	var splitNames=$.trim(prdIdsAndName).split('@@~@@');
	var idNameObject = new Object();
	for(var i=0;i<splitNames.length;i++){
		idNameObject[splitNames[i].split('~')[0]]=splitNames[i].split('~')[1];
	}
	log(idNameObject);
	prName=idNameObject[prID]!=undefined ? idNameObject[prID] : prID;
	return prName;
}
function distributorUserPurchasesForProduct(productIds){
	if($.trim(productIds)!=""){	
		var app_seq_no=$.trim($('#app_seq_no').val());
		var txtdistributerId=$.trim($('#txtDistributorId').val()); /* changed for jobs CR */
		var url=iHUB.url.iDH();/* iHUB.url.get(); */
		if($.trim(masterform_id)=="")
			masterform_id=$('#userFormId').val();
		$.ajax({ 
			type: "POST",
			url: url,
			data: {
				orgID:orgID,
				app_seq_no:app_seq_no,
				txtdistributerId:txtdistributerId,
				masterform_id:masterform_id,
				txtInstanceId:instanceId,
				productId:productIds,
				subAction:"distributorUserPurchasesForProduct"
			},
			dataType: "json",
			/* async:false, */
			success: function(result){
				if (typeof distributorUserPurchasesForProductPost == 'function')  
					distributorUserPurchasesForProductPost(result);
				if($('#myRequestMicrosite').length>0){
					document.getElementById('myRequestMicrosite').contentWindow.postMessage([{action:"distributorUserPurchasesForProductPost"},{result:result}], "*");
				}else if($('#micrositeContent').length>0 && (!$('#micrositeContent').hasClass('hidden'))){
					var messageReceived=[{action:"distributorUserPurchasesForProductPost"},{result:result}];
					if (typeof distributorUserPurchasesForProductPostCustom == 'function'){ 
						distributorUserPurchasesForProductPostCustom(messageReceived);
					}else{
						distributorUserPurchasesForProductPostM(messageReceived);
					}
				}
			},
			error: function(x, e){
				if(e=="parsererror" && x.responseText=="session is not avaliable"){
					$('#toaster').html('');
					iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34'));/*  session expired, relogin to continue */
					createLoginLoader();
					fnLogoutICMP('1');
					return false;
				}
			}
		});
	}
}

/*function allowUserSignUp(){
	if(validateCaptchaiHUBWS("captchaHolderUser")){
		var url=iHUB.url.get();
		var datas = {};
		datas["masterform_id"]=$('#formId').val();
		datas["orgID"]=$('#orgId').val();
		datas["txtInstanceId"]=$.trim($('#instanceId').val());
		datas["languageId"]=$.trim($('#languageId').val());
		datas["timezoneId"]=$.trim($('#timezoneId').val());
		datas["subAction"]="userRegistration";
		datas["consentDataUser"]=$('#consentDataUser').val();
		datas["tokenId"]=iHUB.token.get();
		
		datas["captchaService_imageKey"]=$.trim($('#captchaHolderUser #captchaService_imageKey').val());
		datas["captchaService_answer"]=$.trim($('#captchaHolderUser #captchaService_answer').val());
		if($('#txtAppName:visible').length==1){
			if($.trim($('#txtAppName').val())!=""){
				var appName = $.trim($('#txtAppName').val());
				var appNameArray = appName.split(' ').filter(function(v){return v!==''});
				$('#txtFirstName').val($.trim(appNameArray[0]));
				$('#txtLastName').val($.trim(appNameArray.slice(1).join(' ')));
			}
		}		
		var arr = ["txtSalutation","txtFirstName","txtMiddleName","txtLastName","txtGender","txtDisplayName","txtEmail","txtPhoneNumber","txtDOB","txtCountry","txtProfileId","app_seq_no","txtState","txtCity","stateCode","isMailReqd","txtPassword","isMinor"];
		if($.trim($('#isMinor').val())=="1"){
			arr.push("parentName");
			arr.push("parentEmailId");
		}
		for(var i=0;i<arr.length;i++){
			if(eval(validateUserColumns(arr[i])) && $.trim($('#'+arr[i]).val())!=""){
				datas[arr[i]]=$.trim($('#'+arr[i]).val());				
			}
		}
		if($.trim(datas["stateCode"])=='' || datas["stateCode"]=='null'){
			datas["stateCode"]=$.trim(giveMeStateCode($.trim($('#txtState').val())));
		}
		//daily password authentication start
		datas["dailyPassword"]="";
			var url = iHUB.url.get();
			$.ajax({
				type : "POST",
				url : url,
				data : {
					masterform_id : masterform_id,
					orgID : orgID,
					subAction : 'checkdailypasswordrequirement',
					txtInstanceId : instanceId,
				},
				dataType : "json",
				success : function(result) {
					var res = JSON.stringify(result);
					var obj = JSON.parse(res);
					//log(obj);
					if($.trim(obj.isdailypasswordrequired) == "true"){
						var password2 = prompt("Please enter daily password:");
						if (password2 == null || password2 == "") {
							return false;
						} else {
							datas["dailyPassword"] = password2;
						}
					}
					$.ajax({ 
						type: "POST",
						url: url,
						data: datas,		
						dataType: "json",
						success: function(result){
							if(result.responseDetails.captchaStatus!=undefined && result.responseDetails.captchaStatus!=null){
								if($.trim(result.responseDetails.captchaStatus).toLowerCase()!="true"){
									alert("Please enter correct text shown in image"); 
									initiHUB("captchaHolderUser");
									return false;
								}
								else if($.trim(result.responseDetails.ErrorStatus).toLowerCase()=="false" || $.trim(result.responseDetails.status).toLowerCase()=="false"){
									alert("There has been some error. Please try again after sometime.");
									return false;
								}
								else{
									$('#userRegistration').find('.signCont').find('.successBodyNew').removeClass('hidden');
									$('#userRegistration').find('.signCont').find('.scroll_bar').addClass('hidden');
									$('#userRegistration').find('.modal-footer').addClass('hidden');
									$('#userRegistration').find('input[type="text"],input[type="password"],select[id!="txtCountry"]').val('');
									$('#userRegistration').find('#isMinorNo').click();
									$('#userRegistration').find('.selectpicker').selectpicker('refresh');
									minorUser();
									if($.trim(result.responseDetails.app_seq_no)!="")
										callFromSuccessPage(sessChk,result.responseDetails.app_seq_no);
								}
							}
							else{
								return false;
							}
						},
						error: function(x, e){
							iHUB.toaster.blackMessageToaster(x.readyState + " "+ x.status +" "+ e.msg);
						}
					});
				}
			});
	}
}*/
function allowUserSignUp(){
	if(validateCaptchaiHUBWS("captchaHolderUser")){
		var url="/iDH/iHUBWS";/* iHUB.url.get(); */
		var datas = {};
		datas["masterform_id"]=$('#formId').val();
		datas["orgID"]=$('#orgId').val();
		/* datas["txtInstanceId"]=$.trim($('#txtInstanceId').val()); */
		datas["txtInstanceId"]=$.trim($('#txtInstanceId').val())==""?$.trim($('#instanceId').val()):$.trim($('#txtInstanceId').val());
		datas["languageId"]=$.trim($('#languageId').val());
		datas["timezoneId"]=$.trim($('#timezoneId').val());
		datas["subAction"]="userRegistration";
		datas["referrer"]=ref;
		datas["source"]=sources;
		/* datas["consentDataUser"]=$('#consentDataUser').val(); */ 
		datas["consentData"]=$('#consentData').val();  /* changed for new privacy policy modal */
		datas["tokenId"]=iHUB.token.get();
		
		datas["captchaService_imageKey"]=$.trim($('#captchaService_imageKey').val());/* #captchaHolderUser  */
		datas["captchaService_answer"]=$.trim($('#captchaHolderUser #captchaService_answer').val());
		if($('#txtAppName:visible').length==1){
			if($.trim($('#txtAppName').val())!=""){
				var appName = $.trim($('#txtAppName').val());
				var appNameArray = appName.split(' ').filter(function(v){return v!==''});
				$('#txtFirstName').val($.trim(appNameArray[0]));
				$('#txtLastName').val($.trim(appNameArray.slice(1).join(' ')));
			}
		}		
		var arr = ["txtSalutation","txtFirstName","txtMiddleName","txtLastName","txtGender","txtDisplayName","txtEmail","txtPhoneNumber","txtDOB","txtCountry","txtProfileId","app_seq_no","txtState","txtCity","stateCode","isMailReqd","txtPassword","isMinor"];
		
		if (typeof addExtraParamForUserSignUp == 'function'){
			var extraParam = addExtraParamForUserSignUp();
			if($.trim(extraParam)!="")
				$.merge(arr,extraParam.split(','));
		}
			
		if($.trim($('#isMinor').val())=="1"){
			arr.push("parentName");
			arr.push("parentEmailId");
		}
		for(var i=0;i<arr.length;i++){
			if(eval(validateUserColumns(arr[i])) && $.trim($('#'+arr[i]).val())!=""){
				if($.trim(arr[i])=="txtEmail")					
					datas[arr[i]]=$.trim($('#'+arr[i]).val()).toLowerCase();
				else
					datas[arr[i]]=$.trim($('#'+arr[i]).val());				
			}
		}
		if($.trim(datas["stateCode"])=='' || datas["stateCode"]=='null'){
			datas["stateCode"]=$.trim(giveMeStateCode($.trim($('#txtState').val())));
		}
		//daily password authentication start
		datas["dailyPassword"]="";
			
		$.ajax({ 
			type: "POST",
			url: url,
			data: datas,		
			dataType: "json",
			success: function(result){
				if(result.responseDetails.captchaStatus!=undefined && result.responseDetails.captchaStatus!=null){
					if($.trim(result.responseDetails.captchaStatus).toLowerCase()!="true"){
						alert(multilingualKeyValue('295','34'));   /* Please enter correct text shown in image:295 */
						initiHUB("captchaHolderUser");
						return false;
					}
					else if($.trim(result.responseDetails.ErrorStatus).toLowerCase()=="false" || $.trim(result.responseDetails.status).toLowerCase()=="false"){
						/* alert("There has been some error. Please try again after sometime.");
						return false; */
						if($.trim(result.responseDetails.ErrorCause)!=""){
							if($.trim(result.responseDetails.ErrorCause)=="login id or email already exists"){
								alert(multilingualKeyValue('93','34'));  /* Your email id is already registered with us. Please try logging in with your existing credentials.:93 */
							}
							else{
								alert($.trim(result.responseDetails.ErrorCause));
							}
						}
						else{
							alert(multilingualKeyValue('458','34'));   /*  "There has been some error. Please try again after sometime." */
							return false;
						}
					}
					else{
						hitAnalyticsCheck("Signup","User","Registered");
						$('#userRegistration').find('.signCont').find('.successBodyNew').removeClass('hidden');
						$('#userRegistration').find('.signCont').find('.scroll_bar').addClass('hidden');
						$('#userRegistration').find('.modal-footer').addClass('hidden');
						$('#userRegistration').find('input[type="text"],input[type="password"],select[id!="txtCountry"]').val('');
						$('#userRegistration').find('#isMinorNo').click();
						$('#userRegistration').find('.selectpicker').selectpicker('refresh');
						minorUser();
						if($.trim(result.responseDetails.app_seq_no)!="")
							callFromSuccessPage(sessChk,result.responseDetails.app_seq_no,$.trim(result.responseDetails.txtLoginId), datas["txtPassword"]);
					}
				}
				else{
					return false;
				}
			},
			error: function(x, e){
				iHUB.toaster.blackMessageToaster(x.readyState + " "+ x.status +" "+ e.msg);
			}
		});
	}
}
function useNewSignUpFeature(){
	isNewRegistration=true;
}
function useNewOrgSignUpFeature(){
	isNewOrgRegistration=true;
}
function openNewRegistrationModal(){
	enableSlimScroll('#userRegistration .scroll_bar_row','300px','#00abe1');
	$('#userRegistration .slimScrollDiv').css('padding-right','25px');
	if(!($('#app_seq_no_div').length>0)){
		if (typeof initiHUB == 'function' && $('#captchaHolderUser').length > 0)			
			initiHUB("captchaHolderUser");
	}
	setTimeout(function () {
		$('#userRegistration').find('.slimScrollDiv').children(':first').slimScroll({ scrollTo: '0px', alwaysVisible: true });
	}, 500);
	$('#userRegistration').find('.signCont').find('.successBodyNew').addClass('hidden');
	$('#userRegistration').find('.signCont').find('.scroll_bar').removeClass('hidden');
	$('#userRegistration').find('.modal-footer').removeClass('hidden');
	$('#userRegistration').modal();	
}
function openNewOrgRegistrationModal(){
	enableSlimScroll('#orgRegistration .scroll_bar_row','300px','#00abe1');
	$('#orgRegistration .slimScrollDiv').css('padding-right','25px');
	if($.trim(orgColNotReqArr)==""){
		moduleVisibilityColumnsUser(allInstanceDetails);
	}
	setTimeout(function () {
		$('#orgRegistration').find('.slimScrollDiv').children(':first').slimScroll({ scrollTo: '0px', alwaysVisible: true });
	}, 500);
	$('#orgRegistration').find('.signCont').find('.successBodyNew').addClass('hidden');
	$('#orgRegistration').find('.signCont').find('.scroll_bar').removeClass('hidden');
	$('#orgRegistration').find('.modal-footer').removeClass('hidden');
	$('#orgRegistration').modal();	
	if(!($('#app_seq_no_div').length>0)){
		if (typeof initiHUB == 'function' && $('#OrgCaptchaHolder').length > 0)			
			initiHUB("OrgCaptchaHolder");
	}
}
function callMultiLingualFirstTime(){
	if(languageDetails==undefined)
		languageDetails=getLanguageDetails();
	/* added for lang cr by prajna */
	/* var groupID = $.trim(headerUploadPath).indexOf('/per/') > -1 ? $.trim(headerUploadPath).split('/per/')[1].split('/')[0] : "g01";
	var jsonPath="/per/"+groupID+"/pub/"+orgID+"/iDH/instance/"+instanceId+"/home/lang_"+instanceId+".json"; */
	/*  in shortlink we will not get headerUploadPath so we are directly taking value from hidden field */
	var jsonPath=$.trim($('#multilingualJsonPath').val());
	var language=$.trim($('#languageId_div').text());
	if($.trim(language)!=''){
		for(val in languageDetails){
			var langdetails=languageDetails[val];
			if(langdetails.lanid==language){						
				languageName=langdetails.lanname;
				store.set('languageName',languageName);
			}
		}				
	}
	else{
		store.set('languageName','English');
		store.set('languageId','1');
	}
	/* added for lang cr by prajna */
	var langLength=$.map(languageDetails, function(n, i) { return i; }).length;
	if(langLength>1 || (langLength==1 && eval('callMultiLingual()'))){
		log("use language "+$('#languageId_div').text());
		eval("iHUB.multilingual.multilingualFormKeyValue(masterform_id,orgID,store.get('languageName'),instanceId)");
		setTimeout(function() {
			appendPasswordRules();
		}, 500);
	}
	else{
		iHUB.multilingual.checkAndSetMultilingualValues();
		setTimeout(function() {
			appendPasswordRules();
		}, 500);
	}
	if (typeof setMultilingualLanguageToSession == 'function')  
		setMultilingualLanguageToSession(store.get('languageName'),masterform_id,orgID);
}
function createCataloguePageMain(response){
	var newResponse=JSON.stringify(response);
	var obj = JSON.parse(newResponse);
	for(label in obj){
		if(label=="responseDetails"){
			var val=obj[label];
			var token=val['token'];
			var fields=val['fields'];
			var variables="";
			iHUB.token.set(token);/* $('#tokenId').val(token); */
			if(fields=="ProductIdList"){
				variables=val['variables'];
				txtProductIDs=$.trim(variables);
				store.set('txtProductIDs',$.trim(variables));
			}
		}
	}
	createCataloguePage(response);
}
function alignTextCentre(){
	if($('#no-more-tables> thead> tr> th').length==2){
		$('#no-more-tables> thead> tr> th').css('text-align','center');
	} 
}
function getdistributorpublisherdetails(){
	var userid=$('#app_seq_no').val();
	var tokenId=iHUB.token.get();/* $('#tokenId').val(); */
	var sessChk=$('#sessChk').val();
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	$.ajax({ 
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			txtInstanceId:instanceId,
			languageId:languageId,
			app_seq_no:userid,
			userid:userid,
			sessChk:sessChk,
			tokenId:tokenId,
			subAction:"getdistributorpublisherdetails"
		},
		dataType: "json",
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				listOfPublisherAndDistributor(result);
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		},
		complete:function(){
			
		}
	});
}
function productTaggedToDistributor(response){
	callOnSearch();
	/* changed by Kiran */
	if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
		var categoryLevelDetails=$('#product_catlog').data('levelDetails');
		eval('getCategoryDetails(categoryLevelDetails)');
	}
	SetBreadCrumbCatalogue();
	$('#CatalogueContent').removeClass('hidden');
	$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
	var fields="",variables="",message="";
	var newResponse=JSON.stringify(response);
	var obj = JSON.parse(newResponse);
	for(label in obj){
		if(label=="responseDetails"){
			var val=obj[label];
			fields=val['fields'];
			variables=val['variables'];
			message=val['message'];
			if(val['distributorProductDetails']!=undefined && val['distributorProductDetails']!=""){
				var distributorProductDiscountQtyDetail=val['distributorProductDetails'];
				distributorProductDiscountQtyDetails=distributorProductDiscountQtyDetail;
				store.set('distributorProductDiscountQtyDetails',distributorProductDiscountQtyDetails);
			}			
		}
	}
	if(currentPageOfcatalogue==undefined || currentPageOfcatalogue=="" || currentPageOfcatalogue=="undefined" || isNaN(currentPageOfcatalogue))
		pageNo="1";
	else
		pageNo=currentPageOfcatalogue;
	/*createHashString=instanceId+"@IID@Home/Catalogue=redirectTo~@~field="+$.trim(fields)+"@~@txtorderby&subAction=createCatalogue&variable="+$.trim(variables)+"@~@PopularUp&pageNo="+pageNo;
	setLinkHash(createHashString);*/
	if(message=="No products tagged to distributer."){
		$('#catalogueItems').html('');
		$("div[id='div437']").remove();
		$('#catalogueItems').append("<h4 class='margintop20 text-center' data-a='28' data-b='Sorry, no results found.'>"+multilingualKeyValue('28','34')+"</h4>");
	}
	createCataloguePageMain(response);
}
function checkSessionOrToken(result){
	if(result!=null){
		var newResponse = JSON.stringify(result);
		var obj = JSON.parse(newResponse);
		var message = obj.message;
		if(message!=undefined && message!=null){
			if(message=="Invalid token" || message=="session is not avaliable"){
				//log(message+" :: caller is " + arguments.callee.caller.toString());
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
			else{
				return true;
			}
		}
		else{
			return true;
		}
	}
	else{
		//log("result null  :: caller is " + arguments.callee.caller.toString());
		$('#toaster').html('');
		iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
		createLoginLoader();
		fnLogoutICMP('1');
		return false;
	}	
}
function newIndexCall(newResponse,displayName,defaultYesOrNo){
	if(!jQuery.isEmptyObject(newResponse) && !jQuery.isEmptyObject(newResponse.createIndexDetails)){
		var requestDetails = newResponse.createIndexDetails.requestDetails.requestDetails;
		var catalogue = newResponse.createIndexDetails.catalogue;
		if(!jQuery.isEmptyObject(catalogue) && !jQuery.isEmptyObject(requestDetails))
			buildIndexCatalogue(catalogue,requestDetails,displayName,defaultYesOrNo);
	}
}
function buildIndexCatalogue(catalogue,requestDetails,displayName,defaultYesOrNo){
	if(catalogue!=undefined){
		if(defaultYesOrNo.toLowerCase()=="yes")
			defaultYesOrNo=true;
		else
			defaultYesOrNo=false;
		var splitFields;
		var splitVariables;
		var splitdisplayName=displayName.split(',');
		var variables=$.trim(requestDetails.variables);
		var fields=$.trim(requestDetails.fields);
		splitFields=fields.split(',');
		splitVariables=variables.split(',');
		
		if($('.tabsCreationIndex').length!=0){
			$('.tabsCreationIndex').html("");
			var strStaticFlip="";					
			strStaticFlip+="<div class=\"widthContainer clearfix\"><div class=\"horizTab\">";
			strStaticFlip+="<div class=\"topLink clearfix flipHeading\"></div>";
			strStaticFlip+="<div class=\"contentBoxContainer\"><div class=\"cubeContainer\"><div class=\"cube flipValue\"></div></div></div>";
			strStaticFlip+="</div></div>";
			$('.tabsCreationIndex').append(strStaticFlip);
			$('#tabaccordion').html("");
			$('#tabaccordion').addClass('removemargin');						
			var j=1;
			if(defaultYesOrNo){
				var strCategoryH="";
				strCategoryH+="<div class=\"\" id=\"tbf"+(Number(j))+"\"><p class=\"singleLine\" id='type'></p></div>";
				$('.flipHeading').append(strCategoryH);
				var strCategoryV="";
				strCategoryV+="<div class=\"face\" id=\"tbf"+(Number(j))+"\"><div class=\"contentBox cBoxT"+(Number(j))+"\"><div class=\"clearfix\"></div></div></div>";
				$('.flipValue').append(strCategoryV);						
				var strHVMob = "";
				strHVMob += "<div class=\"panel panel-default\" id=\"tbf"+(Number(j))+"\">";
				strHVMob += "<div class=\"panel-heading mobiletb\" role=\"tab\">";
				strHVMob += "<a role=\"button\" data-toggle=\"collapse\" data-parent=\"#tabaccordion\" href=\"#collapse" + (Number(j)) + "\" aria-expanded=\"true\" aria-controls=\"collapse" + (Number(j)) + "\">";
				strHVMob += "<h4 class=\"semibold panel-title\" id='type'></h4>";
				strHVMob += "</a></div>";
				strHVMob += "<div id=\"collapse" + (Number(j)) + "\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"\">";
				strHVMob += "<div class=\"panel-body container\"><div class=\"row\" id=\"categoryMob\">";
				strHVMob += "</div></div></div></div>";
				$('#tabaccordion').append(strHVMob);
				j++;
			}
			for(var i=j,p=0;p<splitVariables.length;i++,p++){ /* && i<=4 */
				var variableDesc=splitVariables[p];
				if(splitFields[p].indexOf("txtLevel")!=-1){
					variableDesc=getNameForValue(splitFields[p],splitVariables[p]);
				}
				var strH="";
				strH+="<div class=\"\" id=\"tbf"+(Number(i))+"\"><p class=\"dblLine\">"+splitdisplayName[p]+"</p></div>";
				var strV="";
				strV+="  <div class=\"face \" id=\"tbf"+(Number(i))+"\"><div class=\"contentBox category"+splitFields[p].toLowerCase()+"-"+splitVariables[p].toLowerCase()+" cBoxT"+(Number(i))+"\" id=\"category"+splitFields[p].toLowerCase()+"-"+splitVariables[p].toLowerCase()+"\"><div class=\"clearfix\"></div></div></div>";
				$('.flipHeading').append(strH);
				$('.flipValue').append(strV);
				var strHVMob="";
				strHVMob+="<div class=\"panel panel-default\" id=\"tbf"+(Number(i))+"\">";
				strHVMob+="<div class=\"panel-heading mobiletb\" role=\"tab\">";
				strHVMob+="<a role=\"button\" data-toggle=\"collapse\" data-parent=\"#tabaccordion\" href=\"#collapse"+i+"\" aria-expanded=\"true\" aria-controls=\"collapse"+i+"\">";
				strHVMob+="<h4 class=\"semibold panel-title\">"+splitdisplayName[p]+"</h4>";
				strHVMob+="</a></div>";
				strHVMob+="<div id=\"collapse"+i+"\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"\">";
				strHVMob+="<div class=\"panel-body container\"><div class=\"row\" id=\"categoryMob"+splitFields[p].toLowerCase()+"-"+splitVariables[p].toLowerCase()+"\">";
				strHVMob+="</div></div></div></div>";
				$('#tabaccordion').append(strHVMob);
			}
			
			var j=1;				
			/* if(defaultYesOrNo.toLowerCase()=="yes"){
				defaultYesOrNo=true;
				j++;
			}					
			else{
				defaultYesOrNo=false;
			} */			
			var cubeLength=$('.cube').children().length;
			for(var c=j;c<=cubeLength;c++){
				if(!($('#tbf'+c+'.face li').hasClass('appended'))){
					$("div[id='tbf"+c+"']").remove();
				}
			}
			$('.face').find('ul').find('li').find('a').each(function(){
				if($.trim($(this).html())=="" && $(this).parent().siblings('li').children().html()==""){
					$(this).parent().parent().prev().addClass('lastRow');
				}
				if($.trim($(this).html())==""){
					$(this).remove();
				}
			});
			$('.face').find('ul').find('li').each(function(){
				if($.trim($(this).html())=="" && $(this).siblings('li').html()==""){
					$(this).parent().prev().addClass('lastRow');
				}
			});
			var count=1;
			$('.topLink').children().each(function(){
				if(count<5){
					if(count==1){
						$(this).addClass('sel');
					}
					$(this).addClass('tb'+count);
					count=count+1;
				}
				else{
					$(this).addClass('hidden');
				}					
			});
			var countV=1;
			$('.flipValue').children().each(function(){
				if(countV<5){
					$(this).addClass('f'+countV);
					$(this).children().addClass('cBox'+countV);						
					$('.cBox'+countV).find('.TabsInnrTxt:nth-child(5)').addClass('lastRow');
					countV=countV+1;
				}
				else{
					$(this).addClass('hidden');
				}					
			});
			var countMob=1;
			$('#tabaccordion .mobiletb').each(function(){
				$(this).addClass('mobiletb'+countMob);
				countMob++;
			});
		}		
		$('.tb1').click();
		$('.topLink div').click(function(){
			$('.topLink div').removeClass('sel');
			$(this).addClass('sel');
			var indx = $('.topLink div').index($(this)) + 1 ;
			$('.cubeContainer .cube').attr('class','cube pos'+indx);
		});
		$('.dynamicSections').remove();
		var cubecounttemp;
		if(splitFields.length>4)
			cubecounttemp=4;
		else
			cubecounttemp=splitFields.length;
		for(m=cubecounttemp-1;m>=0;m--){
			/* if(m%2==0) */
				sectionClass="greyBG";
			/* else
				sectionClass=""; */
			var txtMyVarName=splitVariables[m];
			if(splitFields[m].indexOf("txtLevel")!=-1){
				txtMyVarName=getNameForValue(splitFields[m],splitVariables[m]);
			}
			var	strF="";
			var thumbnailCount="3";
			if($('#thumbnailCount').val()!=undefined && !isNaN($('#thumbnailCount').val()) && $('#thumbnailCount').val()!=""){
				thumbnailCountArray=[1,2,3,4,6];
				if(thumbnailCountArray.indexOf(Number($('#thumbnailCount').val()))>-1)
					thumbnailCount=$('#thumbnailCount').val();
			}							
			strF="<section class='container dynamicSections "+sectionClass+"'><div class='row'><div class='col-md-12' id='productList-"+m+"'><div class=\"center-block width90perc\"><h2 class=\"text-center sectionHeader removemargin sansR\">"+splitdisplayName[m]+"</span></h2><div class=\"owl-carousel owl-carousel"+thumbnailCount+" "+(splitFields[m]+"-"+splitVariables[m]).toLowerCase()+"\"></div> </div></div>  </div>  <div class='text-center margintop30 marginbottom10 cousorPointer'><a class='btn btn-default btn-lg typeSearch' data-field='"+splitFields[m]+"' data-type='"+splitVariables[m]+"' role='button' data-a='95' data-b='Browse More'>"+multilingualKeyValue('95','34')+"</a></div></section>";
			$('#parentDiv').after(strF);
			for(var n=0;n<5;n++){
				var strEachTabs="<ul class=\"TabsInnrTxt desktop-"+splitFields[m].toLowerCase()+"-"+splitVariables[m].toLowerCase()+"-"+n+"\"><li></li><li></li></ul>";
				$('#category'+splitFields[m].toLowerCase()+"-"+splitVariables[m].toLowerCase()+' .clearfix').append(strEachTabs);
			}
			for(var n=0;n<3;n++){
				var strEachTabs="<div class=\"col-lg-4 col-md-4 col-sm-4 col-xs-4\" style=\"padding-right:0px !important;\"><ul class=\"list-unstyled mobile-"+splitFields[m].toLowerCase()+"-"+splitVariables[m].toLowerCase()+"-"+n+"\" style=\"margin-bottom:0px;\"><li></li><li></li></ul></div>"
				$('#categoryMob'+splitFields[m].toLowerCase()+"-"+splitVariables[m].toLowerCase()).append(strEachTabs);
			}
		}
		var freeProductName="";
		var freeProductNameMob="";
		var i=1;
		for(label in catalogue){
			var freeORpaid=label.split('~')[0];
			var cart=catalogue[label];
			var productImage="",micrositelink="";
			var ItemName=cart.ItemName;
			if(cart.txtThumbnailImage!="" && cart.txtThumbnailImage!=null && cart.txtThumbnailImage!="null"){
				productImage=$.trim(cart.txtThumbnailImage);
			}
			else if(cart.productImage!="" && cart.productImage!=null && cart.productImage!="null"){
				productImage=window.location.protocol+"//"+window.location.host+"/per/"+groupID+"/pub/"+orgID+"/EForms/image/"+$.trim(cart.productImage);
			}
			if(cart.txtProductMicrositeLink!="" && cart.txtProductMicrositeLink!=null && cart.txtProductMicrositeLink!="null"){
				micrositelink=$.trim(cart.txtProductMicrositeLink);
			}
			else if(cart.templateupload!="" && cart.templateupload!=null && cart.templateupload!="null"){
				micrositelink=window.location.protocol+"//"+window.location.host+"/per/"+groupID+"/pub/"+orgID+"/EForms/image/"+$.trim(cart.templateupload);
			}						
			if(micrositelink!="null" && micrositelink!=null && micrositelink!=""){
				freeProductName="<a data-tooltip=\"tooltip\" class=\"greenTooltip checkForEllipsis cousorPointer viewMicrosite wrapCube\" data-placement=\"bottom\" data-name=\""+ItemName+"\" title=\""+ItemName+"\" data-link=\""+micrositelink+"\">"+ItemName+"</a>";
				freeProductNameMob="<a data-tooltip=\"tooltip\" class=\"greenTooltip checkForEllipsis cousorPointer viewMicrosite wrapCube\" data-placement=\"bottom\" data-name=\""+ItemName+"\" title=\""+ItemName+"\" data-link=\""+micrositelink+"\">"+ItemName+"</a>";	
			}
			else{
				freeProductName="<a data-tooltip=\"tooltip\" class=\"greenTooltip checkForEllipsis cousorPointer wrapCube\" data-placement=\"bottom\" title=\""+ItemName+"\" >"+ItemName+"</a>";
				freeProductNameMob="<a data-tooltip=\"tooltip\" class=\"greenTooltip checkForEllipsis cousorPointer wrapCube\" data-placement=\"bottom\" title=\""+ItemName+"\">"+ItemName+"</a>";
			}
			for(var g=1;g<=2;g++){
				var status=false;
				for(var t=0;t<5;t++){
					if(!($(".desktop-"+(freeORpaid).toLowerCase()+"-"+t+" li:nth-child("+g+")").hasClass('appended'))){
						$(".desktop-"+(freeORpaid).toLowerCase()+"-"+t+" li:nth-child("+g+")").append(freeProductName);
						$(".desktop-"+(freeORpaid).toLowerCase()+"-"+t+" li:nth-child("+g+")").addClass('appended');
						status=true;
						break;
					}
				}
				for(var t=0;t<3;t++){
					if(!($(".mobile-"+(freeORpaid).toLowerCase()+"-"+t+" li:nth-child("+g+")").hasClass('appended'))){
						$(".mobile-"+(freeORpaid).toLowerCase()+"-"+t+" li:nth-child("+g+")").append(freeProductNameMob);
						$(".mobile-"+(freeORpaid).toLowerCase()+"-"+t+" li:nth-child("+g+")").addClass('appended');
						$(".mobile-"+(freeORpaid).toLowerCase()+"-"+t+" li:nth-child("+g+")").css('margin-bottom', '10px');
						status=true;
						break;
					}
				}
				if(status==true)
					break;
			}
			if (typeof createCustomThumbnail == 'function')
				strFree="<div class=\"item\">"+createCustomThumbnail(cart,"","I")+"</div>";
			else
				strFree="<div class=\"item\">"+getThumbnail(cart,"","I")+"</div>";
			$('.'+freeORpaid.toLowerCase()).append(strFree);
			if(i>8){i=0;}
			i++;				
		}
		$('.item .hoverContent').each(function(){
			if($(this).text()==""){$(this).remove();}
		});
		postcreateIndexDetails();
	}
	MyCartAct('I');
}
function postHeaderCatalog(){
	setTimeout(function(){
		if (typeof getCustomCategoryDetails != 'function') {
			if($.trim($('#product_catlog').siblings('ul').html())!=""){
				$('#product_catlog').on('mouseenter',function(){
					if ($(window).width() > 992){
						var $menu = $(".dropdown-menu");
						function activateSubmenu(row) {
							var $row = $(row),
							submenuId = $row.data("submenuId"),
							$submenu = $("#" + submenuId),
							height = $menu.outerHeight(),
							width = $menu.outerWidth();
							$submenu.css({
								display: "block",
								top:-2,
								left: 206
							});								
							$row.find("a").addClass("maintainHover spc_hover");
						}
						function deactivateSubmenu(row) {
							var $row = $(row),
							submenuId = $row.data("submenuId"),
							$submenu = $("#" + submenuId);
							$submenu.css("display", "none");
							$row.find("a").removeClass("maintainHover spc_hover");
						}
						$menu.menuAim({
							activate: activateSubmenu,
							deactivate: deactivateSubmenu
						});  
						$("#product_catlog .dropdown-menu li").on("click",function(e) {
							e.stopPropagation();
						});
						$(document).on("click",function() {
							$(".popover").css("display", "none");
							$("a.maintainHover").removeClass("maintainHover spc_hover");
						});
						$(".courseMenu_drop").mouseleave(function() {
							$(".popover").css("display", "none");
							$("a.maintainHover").removeClass("maintainHover spc_hover");
						});
						/* added new */
						$('.drpdwnTabshow').on('touchstart', function () {
							$('.header_right_drpdown').show();
						});
					}
				});
			}
		}
		setHeightofDropDown();
	},1500);
}
function postcreateIndexDetails(){
	owlCarouselArrowHideShow();
	differentOwlCarousel();
	tooltipHoverFocus();
	if($('a.typeSearch').length>0){
		$('a.typeSearch').on('click',function(){
			/* if($.trim($('#CatalogueContent').html())=="")
				callJobsCataloge(this,'TypeSearch');
			else{ */
				$('input:checkbox').prop('checked',false);
				$('#txtItemScheduledStartDate').val('');
				$('#txtItemScheduledEndDate').val('');
				/* showAccordion(''); */
				var txtItemPurchaseType=[],datafields=[];			
				if($.trim($(this).attr('data-field'))=="IsItemActivationRqd"){
					txtItemPurchaseType.push("Licence");
					datafields.push("txtItemPurchaseType");
				}
				else{
					txtItemPurchaseType.push($.trim($(this).attr('data-type')));
					datafields.push($.trim($(this).attr('data-field')));
				}
				var variables = "catalogue@~@none@~@"+txtItemPurchaseType+"@~@PopularUp";
				if(txtItemPurchaseType.length>0){
					callOnSearch();
					
					if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
						var categoryLevelDetails=$('#product_catlog').data('levelDetails');
						eval('getCategoryDetails(categoryLevelDetails)');
					}
					
					$('#CatalogueContent').removeClass('hidden');
					$('.diffviews.list-unstyled.clearfix').removeClass('hidden');
					
					$("#distributorManagement").parent().addClass('hidden');
					datafields="view@~@schedule@~@"+datafields+"@~@txtorderby";							
					if(txtProductIDs!="" && txtProductIDs!=undefined){
						if($('#txtUsrRole').val()=="Distributor"){
							datafields="ProductIdList@~@"+datafields;
							variables=txtProductIDs+"@~@"+variables;
						}		
					}
					createCatalogueDataRequest(datafields,variables);
				}
				createMySearchLabels(datafields,variables);
				if(txtItemPurchaseType.toString().toLowerCase()=="paid"){
					$(".slider_range").fadeIn();
					$(".free1").prop('checked', false);
					$(".paid").prop('checked', true);
					$(".Licence").prop('checked', false);
					showAccordion('openPrice');
				}
				if(txtItemPurchaseType.toString().toLowerCase()=="free"){
					$(".slider_range").fadeOut();
					$(".paid").prop('checked', false);
					$(".free1").prop('checked', true);
					$(".Licence").prop('checked', false);
					showAccordion('openPrice');
				}
				if(txtItemPurchaseType.toString().toLowerCase()=="licence"){
					$(".slider_range").fadeOut();
					$(".paid").prop('checked', false);
					$(".free1").prop('checked', false);
					$(".Licence").prop('checked', true);
					showAccordion('openPrice');
				}
			/* } */
		});
	}
	$('.dynamicSections .owl-stage').each(function(){
		if($.trim($(this).html())==""){
			$(this).parent().parent().parent().parent().parent().parent().remove()
		}
	});		
	fireResize();
	applyvEllipsis();
}
function appendMobileSubscription(index){
	if(globalModuleVisibility!=null && globalModuleVisibility!=undefined){
		if(globalModuleVisibility.indexOf('1')>-1){
			var mobSubscription="",subWeb="";
			
			if(gblTabVisibility!=undefined){
				var splitTV=gblTabVisibility.split(',');
				$.each(splitTV, function(k, v){
					if(isSubscriptionTabPresent(v)){
						var tabId=$('#container-11 span#'+v+'_Tab_Name').text();
						var tabName=iHUB.multilingual.gmv(tabId);
						tabName=tabName!=undefined && tabName!='' ? tabName : $('#container-11 span#'+v+'_Tab_Description').text();
						mobSubscription+='<li data-search="'+tabId+'"><a href="#" onclick="newSubscriptionCall(\''+tabId+'\');"  data-a="'+tabId+'" data-b="'+tabName+'">'+tabName+'</a></li>';
						subWeb+='<li data-search="'+tabId+'"><a class="cousorPointer" onclick="newSubscriptionCall(\''+tabId+'\');"  data-a="'+tabId+'" data-b="'+tabName+'">'+tabName+'<span class="selctdIcon hidden"></span></a></li>';
					}
				});
			}
			if(index==0){
				$(".mmenuTabs").find('div.mm-panel.mm-hasnavbar.mm-highest#mysubscribe').remove();
				$(".mmenuTabs").after('<div class="mm-panel mm-hasnavbar mm-highest mm-current mm-opened displaynone spacePanel" id="mysubscribe"><ul class="mm-listview">'+mobSubscription+'</ul></div>');
			}
			else if(index==1){
				$(".showMySubscriptionsWeb ul").html('');
				$(".showMySubscriptionsWeb ul").append(subWeb);			
			}
		}
	}
}
function isSubscriptionTabPresent(tabId){
	if($('#container-11 span#'+tabId+'_Tab_Name').length > 0){
		var tabName=$('#container-11 span#'+tabId+'_Tab_Name').text();
		if(tabName.charCodeAt(0)==83 && !isNaN(tabName.substr(1,tabName.length))){
			return true;
		}
		else{
			return false;
		}
	}
	else{
		return false;
	}
}
function lazyImageLoad(idVal){
	$('#'+idVal+' img').each(function(){
		var datasrc=$(this).attr('data-src');
		var src=$(this).attr('src');
		if($.trim(src)=="")
			$(this).attr('src',$.trim(datasrc));
	});
}
function userRegistrationWithReferrer(name,email,referrer,source){
	signupUser();
	var orgID=$('#orgId').val();
	var nameSplit=name.split(" ");
	sources=source;
	/* var ref=""; */
	if(referrer!=""){
		ref=referrer;
	}
	else{
		ref="ihub";
	}
	$('#txtFirstName').val(nameSplit[0]);
	$('#txtLastName').val(nameSplit[1]);
	$('#txtEmail').val(email);
	$('#txtLoginId_temp').val(email);
	$('#referrer').val(ref);
	$('#txtAppName').val(name);
	$('#txtEmail').val(email);
	$('#referrer').val(ref);
	$('#source').val(sources);
}
/* commented as to increase performance else if changed to switch
 function multilingualKeyForSubaction(message){
	var key=$.trim(message);
	if($.trim(message)!=""){
		if(message=="Already present in Wishlist."){
			key=multilingualKeyValue('96','34');
		}else if(message=="Added to Wishlist."){
			key=multilingualKeyValue('97','34');
		}else if(message=="Not added to wishlist."){
			key=multilingualKeyValue('98','34');
		}else if(message=="Not a valid request."){
			key=multilingualKeyValue('15','34');
		}else if(message=="Payment GateWay not configured."){
			key=multilingualKeyValue('99','34');
		}else if(message=="Payment Gateway Not Recognized."){
			key=multilingualKeyValue('100','34');
		}else if(message=="Seller has been registered successfully."){
			key=multilingualKeyValue('101','34');
		}else if(message=="Citrus registration not initailised because incomplete data. Please update data first."){
			key=multilingualKeyValue('102','34');
		}else if(message=="Updated Successfully"){
			key=multilingualKeyValue('103','34');
		}else if(message=="Error Encountered"){
			key=multilingualKeyValue('104','34');
		}else if(message=="Incorrect values entered"){
			key=multilingualKeyValue('105','34');
		}else if(message=="invalid request"){
			key=multilingualKeyValue('106','34');
		}else if(message=="error in updation"){
			key=multilingualKeyValue('107','34');
		}else if(message=="updated"){
			key=multilingualKeyValue('108','34');
		}else if(message=="incorrect values"){
			key=multilingualKeyValue('109','34');
		}else if(message=="password updated successfully"){
			key=multilingualKeyValue('110','34');
		}else if(message=="incorrect old password."){
			key=multilingualKeyValue('111','34');
		}else if(message=="Logged in user not mapped to manage user permission"){
			key=multilingualKeyValue('112','34');
		}else if(message=="success"){
			key=multilingualKeyValue('113','34');
		}else if(message=="failure"){
			key=multilingualKeyValue('114','34');
		}else if(message=="User not registered"){
			key=multilingualKeyValue('115','34');
		}else if(message=="This license can not be purchased."){
			key=multilingualKeyValue('116','34');
		}else if(message=="Accepted"){
			key=multilingualKeyValue('117','34');
		}else if(message=="Rejected"){
			key=multilingualKeyValue('118','34');
		}else if(message=="Cancelled"){
			key=multilingualKeyValue('119','34');
		}else if(message=="Invalid"){
			key=multilingualKeyValue('120','34');
		}else if(message=="Valid"){
			key=multilingualKeyValue('121','34');
		}else if(message=="Your request is not registered."){
			key=multilingualKeyValue('122','34');
		}else if(message=="Your request is successfully registered."){
			key=multilingualKeyValue('123','34');
		}else if(message=="Your new request is successfully registered."){
			key=multilingualKeyValue('124','34');
		}else if(message=="Your new request is not registered."){
			key=multilingualKeyValue('125','34');
		}else if(message=="You have already requested for this organization."){
			key=multilingualKeyValue('126','34');
		}else if(message=="Request is successfully approved."){
			key=multilingualKeyValue('127','34');
		}else if(message=="There has been some error while approving the request"){
			key=multilingualKeyValue('128','34');
		}else if(message=="There has been some error while rejecting the request."){
			key=multilingualKeyValue('129','34');
		}else if(message=="Request is successfully Rejected."){
			key=multilingualKeyValue('130','34');
		}else if(message=="Invalid token"){
			key=multilingualKeyValue('131','34');
		}else if(message=="session is not avaliable"){
			key=multilingualKeyValue('132','34');
		}else if(message=="error in createupdateformbatch API"){
			key=multilingualKeyValue('133','34');
		}else if(message=="login id already exists"){
			key=multilingualKeyValue('134','34');
		}else if(message=="instance id or login id not available in the request."){
			key=multilingualKeyValue('135','34');
		}else if(message=="Expired"){
			key=multilingualKeyValue('136','34');
		}else if(message=="No such product found"){
			key=multilingualKeyValue('137','34');
		}else if(message=="Refund initiated."){
			key=multilingualKeyValue('138','34');
		}else if(message=="Refund initiation failed bacause"){
			key=multilingualKeyValue('139','34');
		}else if(message=="Refund cannot be initiated as quantity of licences refunded is greater than Active licences."){
			key=multilingualKeyValue("140",'34');
		}else if(message=="Refund cannot be initiated on used Products."){
			key=multilingualKeyValue('141','34');
		}else if(message=="Refund cannot be initiated, please try after 12 hours."){
			key=multilingualKeyValue('142','34');
		}else if(message=="not assigned"){
			key=multilingualKeyValue('12','34');
		}else if(message=="Distributor Publisher PartnerShip Not available2"){
			key=multilingualKeyValue('17','34');
		}else if(message=="not updated"){
			key=multilingualKeyValue('14','34');
		}else if(message=="Request for Assign Product successfully sent"){
			key=multilingualKeyValue('16','34');
		}else if(message=="Distributor Publisher PartnerShip Not available"){
			key=multilingualKeyValue('143','34');
		}else if(message=="Already a partner"){
			key=multilingualKeyValue('18','34');
		}else if(message=="Partnership request successfully auto Accepted"){
			key=multilingualKeyValue('19','34');
		}else if(message=="No sufficient Data2"){
			key=multilingualKeyValue('144','34');
		}else if(message=="No such product present"){
			key=multilingualKeyValue('145','34');
		}else if(message=="No sufficient Data1"){
			key=multilingualKeyValue('22','34');
		}else if(message=="Already purchased"){
			key=multilingualKeyValue('146','34');
		}else if(message=="Complaint Registered"){
			key=multilingualKeyValue('147','34');
		}else if(message=="Error Complaint Registration"){
			key=multilingualKeyValue('148','34');
		}else if(message=="Some data Missing"){
			key=multilingualKeyValue('149','34');
		}else if(message=="Invalid request or token not validated."){
			key=multilingualKeyValue('150','34');
		}else if(message=="Product Data not found"){
			key=multilingualKeyValue('151','34');
		}else if(message=="No such user"){
			key=multilingualKeyValue('152','34');
		}else if(message=="Rating data saved successfully"){
			key=multilingualKeyValue('153','34');
		}else if(message=="Error in saving Rating Data"){
			key=multilingualKeyValue('154','34');
		}else if(message=="Data not updated"){
			key=multilingualKeyValue('155','34');
		}else if(message=="Data can't be saved because of insufficient Data"){
			key=multilingualKeyValue('156','34');
		}else if(message=="removed from Wishlist."){
			key=multilingualKeyValue('45','34');
		}else if(message=="not removed from Wishlist."){
			key=multilingualKeyValue('157','34');
		}else if(message=="Invalid Product"){
			key=multilingualKeyValue('158','34');
		}else if(message=="is already subscribed"){
			key=multilingualKeyValue('159','34');
		}else if(message=="is not a free Product"){
			key=multilingualKeyValue('160','34');
		}else if(message=="You are not eligible to subscribe the Product"){
			key=multilingualKeyValue('161','34');
		}else if(message=="You have already subscribed to"){
			key=multilingualKeyValue('162','34');
		}else if(message=="You have not yet subscribed to"){
			key=multilingualKeyValue('163','34');
		}else if(message=="There has been some error in Product Subscription"){
			key=multilingualKeyValue('164','34');
		}else if(message=="has been successfully subscribed"){
			key=multilingualKeyValue('165','34');
		}else if(message=="quantity changed."){
			key=multilingualKeyValue('166','34');
		}else if(message=="you can buy only 1 product."){
			key=multilingualKeyValue('167','34');
		}else if(message=="quantity not changed."){
			key=multilingualKeyValue('168','34');
		}else if(message=="already purchased."){
			key=multilingualKeyValue('169','34');
		}else if(message=="already expired."){
			key=multilingualKeyValue('170','34');
		}else if(message=="License code has been successfully activated"){
			key=multilingualKeyValue('171','34');
		}else if(message=="Error in subscription of the product to the user"){
			key=multilingualKeyValue('172','34');
		}else if(message=="Error in License code activation"){
			key=multilingualKeyValue('173','34');
		}else if(message=="You are not eligible to purchase the product"){
			key=multilingualKeyValue('174','34');
		}else if(message=="Product not available for activation using license code"){
			key=multilingualKeyValue('175','34');
		}else if(message=="You have not yet subscribed to"){
			key=multilingualKeyValue('163','34');
		}else if(message=="You have already subscribed to"){
			key=multilingualKeyValue('162','34');
		}else if(message=="Invalid user"){
			key=multilingualKeyValue('176','34');
		}else if(message=="License code is already activated by the requested user"){
			key=multilingualKeyValue('177','34');
		}else if(message=="License code is already activated by a different user"){
			key=multilingualKeyValue('178','34');
		}else if(message=="Invalid request"){
			key=multilingualKeyValue('106','34');
		}else if(message=="Invalid Licence code"){
			key=multilingualKeyValue('179','34');
		}else if(message=="removed from cart."){
			key=multilingualKeyValue('47','34');
		}else if(message=="not removed from cart."){
			key=multilingualKeyValue('180','34');
		}else if(message=="some products are not available."){
			key=multilingualKeyValue('181','34');
		}else if(message=="updated."){
			key=multilingualKeyValue('183','34');
		}else if(message=="not updated."){
			key=multilingualKeyValue('182','34');
		}else if(message=="added to cart."){
			key=multilingualKeyValue('184','34');
		}else if(message=="already present in cart."){
			key=multilingualKeyValue('185','34');
		}else if(message=="postLoginCart"){
			key=multilingualKeyValue('186','34');
		}else if(message=="Please complete your profile"){
			key=multilingualKeyValue('187','34');
		}else if(message=="Products updated to cart"){
			key=multilingualKeyValue('188','34');
		}else if(message=="No products updated to cart"){
			key=multilingualKeyValue('189','34');
		}
	}
	return key;
} */
function multilingualKeyForSubaction(message){
	var key=$.trim(message);
	if($.trim(message)!=""){
		switch(($.trim(message))){
			case "Already present in Wishlist.":
				key=multilingualKeyValue('96','34');
				break;
			case "Added to Wishlist." :
				key=multilingualKeyValue('97','34');
				break;
			case "Not added to wishlist.":
				key=multilingualKeyValue('98','34');
				break;
			case "Not a valid request.":
				key=multilingualKeyValue('15','34');
				break;
			case "Payment GateWay not configured.":
				key=multilingualKeyValue('99','34');
				break;
			case "Payment Gateway Not Recognized.":
				key=multilingualKeyValue('100','34');
				break;
			case "Seller has been registered successfully.":
				key=multilingualKeyValue('101','34');
				break;
			case "Citrus registration not initailised because incomplete data. Please update data first.":
				key=multilingualKeyValue('102','34');
				break;
			case "Updated Successfully":
				key=multilingualKeyValue('103','34');
				break;
			case "Error Encountered":
				key=multilingualKeyValue('104','34');
				break;
			case "Incorrect values entered":
				key=multilingualKeyValue('105','34');
				break;
			case "invalid request":
				key=multilingualKeyValue('106','34');
				break;
			case "error in updation":
				key=multilingualKeyValue('107','34');
				break;
			case "updated":
				key=multilingualKeyValue('108','34');
				break;
			case "incorrect values":
				key=multilingualKeyValue('109','34');
				break;
			case "password updated successfully":
				key=multilingualKeyValue('110','34');
				break;
			case "incorrect old password.":
				key=multilingualKeyValue('111','34');
				break;
			case "Logged in user not mapped to manage user permission":
				key=multilingualKeyValue('112','34');
				break;
			case "success":
				key=multilingualKeyValue('113','34');
				break;
			case "failure":
				key=multilingualKeyValue('114','34');
				break;
			case "User not registered":
				key=multilingualKeyValue('115','34');
				break;
			case "This license can not be purchased.":
				key=multilingualKeyValue('116','34');
				break;
			case "Accepted":
				key=multilingualKeyValue('117','34');
				break;
			case "Rejected":
				key=multilingualKeyValue('118','34');
				break;
			case "Cancelled":
				key=multilingualKeyValue('119','34');
				break;
			case "Invalid":
				key=multilingualKeyValue('120','34');
				break;
			case "Valid":
				key=multilingualKeyValue('121','34');
				break;
			case "Your request is not registered.":
				key=multilingualKeyValue('122','34');
				break;
			case "Your request is successfully registered.":
				key=multilingualKeyValue('123','34');
				break;
			case "Your new request is successfully registered.":
				key=multilingualKeyValue('124','34');
				break;
			case "Your new request is not registered.":
				key=multilingualKeyValue('125','34');
				break;
			case "You have already requested for this organization.":
				key=multilingualKeyValue('126','34');
				break;
			case "Request is successfully approved.":
				key=multilingualKeyValue('127','34');
				break;
			case "There has been some error while approving the request":
				key=multilingualKeyValue('128','34');
				break;
			case "There has been some error while rejecting the request.":
				key=multilingualKeyValue('129','34');
				break;
			case "Request is successfully Rejected.":
				key=multilingualKeyValue('130','34');
				break;
			case "Invalid token":
				key=multilingualKeyValue('131','34');
				break;
			case "session is not avaliable":
				key=multilingualKeyValue('132','34');
				break;
			case "error in createupdateformbatch API":
				key=multilingualKeyValue('133','34');
				break;
			case "login id already exists":
				key=multilingualKeyValue('134','34');
				break;
			case "instance id or login id not available in the request.":
				key=multilingualKeyValue('135','34');
				break;
			case "Expired":
				key=multilingualKeyValue('136','34');
				break;
			case "No such product found":
				key=multilingualKeyValue('137','34');
				break;
			case "Refund initiated.":
				key=multilingualKeyValue('138','34');
				break;
			case "Refund initiation failed bacause":
				key=multilingualKeyValue('139','34');
				break;
			case "Refund cannot be initiated as quantity of licences refunded is greater than Active licences.":
				key=multilingualKeyValue('140','34');
				break;
			case "Refund cannot be initiated on used Products.":
				key=multilingualKeyValue('141','34');
				break;
			case "Refund cannot be initiated, please try after 12 hours.":
				key=multilingualKeyValue('142','34');
				break;
			case "not assigned":
				key=multilingualKeyValue('12','34');
				break;
			case "Distributor Publisher PartnerShip Not available2":
				key=multilingualKeyValue('17','34');
				break;
			case "not updated":
				key=multilingualKeyValue('14','34');
				break;
			case "Request for Assign Product successfully sent":
				key=multilingualKeyValue('16','34');
				break;
			case "Distributor Publisher PartnerShip Not available":
				key=multilingualKeyValue('143','34');
				break;
			case "Already a partner":
				key=multilingualKeyValue('18','34');
				break;
			case "Partnership request successfully auto Accepted":
				key=multilingualKeyValue('19','34');
				break;
			case "No sufficient Data2":
				key=multilingualKeyValue('144','34');
				break;
			case "No such product present":
				key=multilingualKeyValue('145','34');
				break;
			case "No sufficient Data1":
				key=multilingualKeyValue('22','34');
				break;
			case "Already purchased":
				key=multilingualKeyValue('146','34');
				break;
			case "Complaint Registered":
				key=multilingualKeyValue('147','34');
				break;
			case "Error Complaint Registration":
				key=multilingualKeyValue('148','34');
				break;
			case "Some data Missing":
				key=multilingualKeyValue('149','34');
				break;
			case "Invalid request or token not validated.":
				key=multilingualKeyValue('150','34');
				break;
			case "Product Data not found":
				key=multilingualKeyValue('151','34');
				break;
			case "No such user":
				key=multilingualKeyValue('152','34');
				break;
			case "Rating data saved successfully":
				key=multilingualKeyValue('153','34');
				break;
			case "Error in saving Rating Data":
				key=multilingualKeyValue('154','34');
				break;
			case "Data not updated":
				key=multilingualKeyValue('155','34');
				break;
			case "Data can't be saved because of insufficient Data":
				key=multilingualKeyValue('156','34');
				break;
			case "removed from Wishlist.":
				key=multilingualKeyValue('45','34');
				break;
			case "not removed from Wishlist.":
				key=multilingualKeyValue('157','34');
				break;
			case "Invalid Product":
				key=multilingualKeyValue('158','34');
				break;
			case "is already subscribed":
				key=multilingualKeyValue('159','34');
				break;
			case "is not a free Product":
				key=multilingualKeyValue('160','34');
				break;
			case "You are not eligible to subscribe the Product":
				key=multilingualKeyValue('161','34');
				break;
			case "You have already subscribed to":
				key=multilingualKeyValue('162','34');
				break;
			case "You have not yet subscribed to":
				key=multilingualKeyValue('163','34');
				break;
			case "There has been some error in Product Subscription":
				key=multilingualKeyValue('164','34');
				break;
			case "has been successfully subscribed":
				key=multilingualKeyValue('165','34');
				break;
			case "quantity changed.":
				key=multilingualKeyValue('166','34');
				break;
			case "you can buy only 1 product.":
				key=multilingualKeyValue('167','34');
				break;
			case "quantity not changed.":
				key=multilingualKeyValue('168','34');
				break;
			case "already purchased.":
				key=multilingualKeyValue('169','34');
				break;
			case "already expired.":
				key=multilingualKeyValue('170','34');
				break;
			case "License code has been successfully activated":
				key=multilingualKeyValue('171','34');
				break;
			case "Error in subscription of the product to the user":
				key=multilingualKeyValue('172','34');
				break;
			case "Error in License code activation":
				key=multilingualKeyValue('173','34');
				break;
			case "You are not eligible to purchase the product":
				key=multilingualKeyValue('174','34');
				break;
			case "Product not available for activation using license code":
				key=multilingualKeyValue('175','34');
				break;
			case "Invalid user":
				key=multilingualKeyValue('176','34');
				break;
			case "License code is already activated by the requested user":
				key=multilingualKeyValue('177','34');
				break;
			case "License code is already activated by a different user":
				key=multilingualKeyValue('178','34');
				break;
			case "Invalid request":
				key=multilingualKeyValue('106','34');
				break;
			case "Invalid Licence code":
				key=multilingualKeyValue('179','34');
				break;
			case "removed from cart.":
				key=multilingualKeyValue('47','34');
				break;
			case "not removed from cart.":
				key=multilingualKeyValue('180','34');
				break;
			case "some products are not available.":
				key=multilingualKeyValue('181','34');
				break;
			case "updated.":
				key=multilingualKeyValue('183','34');
				break;
			case "not updated.":
				key=multilingualKeyValue('182','34');
				break;
			case "added to cart.":
				key=multilingualKeyValue('184','34');
				break;
			case "already present in cart.":
				key=multilingualKeyValue('185','34');
				break;
			case "postLoginCart":
				key=multilingualKeyValue('186','34');
				break;
			case "Please complete your profile":
				key=multilingualKeyValue('187','34');
				break;
			case "Products updated to cart":
				key=multilingualKeyValue('188','34');
				break;
			case "No products updated to cart":
				key=multilingualKeyValue('189','34');
				break;
		}	
	}
	return key;
}			
function moduleVisibilityBeforeLogin(){
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	if($('#sessChk').length==0)
		sessChk="";
	else
		sessChk=$('#sessChk').val();
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			txtInstanceId:instanceId,
			languageId:languageId,
			instanceCols:"moduleVisibility,isEmailVerificationReq",
			subAction:"getInstanceDetails"
		},
		dataType: "json",
		/* async:false, */
		success: function(result){
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				globalModuleVisibility=JSON.parse(JSON.stringify(result)).instanceDetails.moduleVisibility;
				store.set("isEmailVerificationReq",$.trim(JSON.parse(JSON.stringify(result)).instanceDetails.isEmailVerificationReq));
			}
		},	
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				$('#toaster').html('');
				iHUB.toaster.redMessageToaster(multilingualKeyValue('1','34')); /* session expired, relogin to continue */
				createLoginLoader();
				fnLogoutICMP('1');
				return false;
			}
		}
	});
}
function callInsideCatalougeData(data){
	getProductTypeDetails(globalCategories);
	getPublishers(publisherDetails);
	/* var newResponse=JSON.stringify(data);
	var obj = JSON.parse(newResponse);
	if($.trim(obj.instanceDetails.defaultLanguageId)!="")
		languageId=$.trim(obj.instanceDetails.defaultLanguageId);
	else
		languageId="1";
	if(!jQuery.isEmptyObject(obj.languageDetails)){		
		languageDetails=obj.languageDetails;
	}
	if(!jQuery.isEmptyObject(obj.instanceDetails)){
		languageDetails=jQuery.isEmptyObject(obj.instanceDetails)?"":obj.languageDetails;
		allInstanceDetails=obj.instanceDetails;
		defaultLanguageId=allInstanceDetails.defaultLanguageId;
		defaultTimeZone=allInstanceDetails.defaultTimeZone;
	}
	if(!jQuery.isEmptyObject(obj.levels)){
		var levels=obj.levels[languageId]["subLevels"];
		$('#product_catlog').data('levelDetails',levels);
		var categoryLevelDetails=$('#product_catlog').data('levelDetails');
		if($('.staticMenu').length > 0){
			$('#product_catlog').on('mouseenter',function(){
				if($.trim($('.courseMenu_drop').html())=="" || $.trim($('#openCategory .list-group').html())==""){
					getCategoryDetails(categoryLevelDetails);
				}
			});
			buildMmenu();
			if(jQuery.isEmptyObject(levels)){
				$("ul[id='mobUi']").remove();
			}
		}
		else
			getCategoryDetails(categoryLevelDetails);
	}
	if(!jQuery.isEmptyObject(obj.organizationDetails)){
		getPublishers(obj.organizationDetails);
	}
	if(!jQuery.isEmptyObject(obj.categories)){
		getProductTypeDetails(obj.categories[languageId]);
	}
	if(!jQuery.isEmptyObject(obj.currencyDetails)){
		currencyDetails=obj.currencyDetails;
	} */
	
	$('.sortBy').on('click', function() {
		$('.sortBy').parent().removeClass('active');
		var sortBy = $(this).attr('data-search');
		$('.sortBy').each(function() {
			if ($(this).attr('data-search') == sortBy) {
				$(this).parent().addClass('active');
			}
		});
		$('input:radio[id="txtorderby"]').each(function() {
			if ($(this).attr('data-id') == sortBy)
				$(this).prop('checked', true);
			else
				$(this).prop('checked', false);
		});
		var searchType = "";
		var searchText = "";
		$('.yourSearch span').each(function() {
			if ($(this).attr('data-filtered') == "txtSearchText") {
				searchType = "search";
				searchText = $.trim($(this).text());
			} else {
				searchType = "filter";
			}
		});
		if (searchType == "filter") {
			filterSearch();
		} else {
			$('input:radio[id="txtorderby"]:checked').each(function() {
				filterSearch();
			});
		}
	});
	/* $('.generateCart').on('click',function(){
		callGenerateCart();
	}); */
	/* callAlways();
	callMultiLingualFirstTime(); */
}
function callAfterCatalouge(){
	(function rerunGlobalMLjson(){
		if(!jQuery.isEmptyObject(globalMLjson) && globalMLjson!=null && Object.keys(globalMLjson).length != 0){
			eval('getCatalougeData()');
			var hash = decodeURIComponent(location.hash);
			var myPage = hash.substr(1,hash.length);
			if($.trim(hash)==""){
				filterSearch();
			}
			else{
				if(hash.indexOf('=')!=-1){
					myPage = hash.substr(1,hash.indexOf('=')-1);
					myPageLocation = hash.substr(hash.indexOf('=')+1);
				}
				if(myPage == instanceId+"@IID@Home/Catalogue"){
					if(myPageLocation!="" && myPageLocation!=undefined){
						if($.trim(myPageLocation.split('~@~')[0]).toUpperCase()=="REDIRECTTO")
							goTofilteredCatalogue(myPageLocation);
					}
				}
				var userrole = $.trim($('#txtUsrRole').val());
				if(userrole.toLowerCase()=="distributor"){
					getMyProductListsPost(store.get('distributorCatalogue'));
					$('.licence-div').hide();
				}
				else{
					$('.licence-div').show();
					$('#disAssigned').hide();
				}
			}			
			setTimeout(function() {
				postCatalogueScript();
			},1000);
		}else{
			setTimeout(rerunGlobalMLjson, 200);
		}
	})();	
}
function getCatalougeData(){
	if(!jQuery.isEmptyObject(globalInstanceAPjson)){
		callInsideCatalougeData(globalInstanceAPjson);
	}
	else{
		var url=$.trim($('#instanceJsonPath').val()).replace('/ionstore','');
		$.getJSON(url, function( data ) {
			callInsideCatalougeData(data);
		});
	}
}
function getSubscriptionListStatus(){
	//log("getSubscriptionListStatus function called");
	var txtUsrRole = $.trim($('#txtUsrRole').val()).toLowerCase();
	if(!(txtUsrRole=="learner" || txtUsrRole=="distributor")){
		return false;
	}
	var app_seq_no = $('#app_seq_no').val();
	var tokenId = iHUB.token.get();/* $('#tokenId').val(); */
	var sessChk = $('#sessChk').val();
	var distributorId = $('#txtDistributerId').val()==undefined ? "" : $.trim($('#txtDistributerId').val());
	if($.trim(masterform_id)=="")
		masterform_id=$('#userFormId').val();
	if($.trim(instanceId)=="")
		instanceId=$('#instanceId').val();
	if($.trim(languageId)=="")
		languageId="1";
	var url=iHUB.url.iDH();/* iHUB.url.get(); */
	$.ajax({
		type: "POST",
		url: url,
		data: {
			app_seq_no: app_seq_no,
			tokenId: tokenId,
			masterform_id: masterform_id,
			txtInstanceId: instanceId,
			sessChk: sessChk,
			orgID: orgID,
			languageId:languageId,
			txtdistributerId:distributorId,
			subAction: "getSubscriptionList",
		},
		dataType: "json",
		success: function(result) {
			var condn=iHUB.checkSessionOrToken(result);
			if(eval(condn)){
				if(result!=""){
					$('#SubscriptionList').val(JSON.parse(JSON.stringify(result)).responseDetails.subscriptionList);
					$('[id="productsPurchased"]').val(JSON.parse(JSON.stringify(result)).responseDetails.productCodes);
					//log("productsPurchased value set");
					iHUB.token.set(JSON.parse(JSON.stringify(result)).responseDetails.token);/* $('#tokenId').val(JSON.parse(JSON.stringify(esult)).responseDetails.token); */
					if (typeof showHideSubscriptionTabs == 'function')
						showHideSubscriptionTabs();
					if($('#myRequestMicrosite').length>0){
						document.getElementById('myRequestMicrosite').contentWindow.postMessage("productsPurchased@~@"+$('#productsPurchased').val(),"*");
					}
				}
			}
		},
		error: function(x, e) {
			iHUB.toaster.blackMessageToaster(x.readyState + " " + x.status + " " + e.msg);
			fnLogoutICMP('1');
		}
	});
}
$(window).on('load resize', function () {
	/* var windowHeight = $(window).height();
	var footerHeight = $('.footer-templ').height();
	var footerTop = $('.footer-templ').position().top + footerHeight;
	if (footerTop < windowHeight) {
		$('.footer-templ').css('margin-top', 30 + (windowHeight - footerTop) + 'px');
	} */
	// for small role icons mobile view
	setTimeout(function(){
		var tabWidth = $(".mm-panel").length>0?$(".mm-panel").width():$(".staticMenu").width();
		var smallwidth  = tabWidth / 4;
		$(".role_selections .tab").width(tabWidth-17);
		$(".role_selections  .tab button").css("width", smallwidth-5);
	}, 300) 

});
/* $(document).on("click touchstart", ".loginPopUpBtn", function () { */
function openHeaderPostLogin(){
	/* $(this).parents('#loginmodal').modal('hide'); */
	$('.mm-panels > .mm-panel').addClass('incrHt');
	$('.userProfile').addClass('shwImp');
	$('.spacePanel').addClass('loggedInUser');
	setTimeout(function () {
		/* $('.mm-listview .logout_mobTxt').show();
		$('.mm-listview .login_mobTxt').hide(); */
		if($.trim($('#txtUsrRole').val()).toLowerCase()=='learner')
			$('.mm-listview .change_organization').hide();
	}, 500)
	
	
	$(".incrHt").on("scroll",function () {
		var scrollCount = "-" + $(this).scrollTop() + "px";
		if (scrollCount == "-0px") {
			$(".userProfile").css('top', '35px');
			$(".back_menu").css('top', '13px');
			$(".nav-toggle.active").css('display', 'block');
		} else {
			$(".userProfile, .back_menu").css('top', scrollCount);
			$(".nav-toggle.active").css('display', 'none');
		}
	});
	if ($(window).width() < 993) {
		$(document).on("click", function (e) {
			if ($(e.target).is("a.nav-toggle") === false) {
				$(".nav-toggle.active").show();
			}
		});
	}
}
/* }); */
function enableSlimScroll(selector,ht,colour,alwaysVisible,disableFadeOut){
	if($(selector).length > 0){
		$(selector).slimScroll({ destroy: true });
		alwaysVisible = $.trim(alwaysVisible)=="" ? true : ($.trim(alwaysVisible)=="false" ? false : true);
		disableFadeOut = $.trim(disableFadeOut)=="" ? false : ($.trim(disableFadeOut)=="true" ? true : false);
		$(selector).slimscroll({
			height: ht,
			color: colour,
			wheelStep: 10,
			scrollTo: '0px',
			touchScrollStep: 50,
			alwaysVisible: alwaysVisible,
			disableFadeOut: disableFadeOut,
			railVisible: true,
			railOpacity: 0.3,
			allowPageScroll: false
		});
	}
}
function hideNewUIPart(){
	//log("hiding tablinks starts");
	var tablinks = document.getElementsByClassName("tablinks");
	for (var i = 0; i < tablinks.length; i++) {
		if($.trim(tablinks[i].textContent).toLowerCase()!="learner"){
			tablinks[i].style.display = "none";
		}
	}
	var tablinks = document.getElementsByClassName("smalltablinks");
	for (var i = 0; i < tablinks.length; i++) {
		if($.trim(tablinks[i].textContent).toLowerCase()!="learner"){
			tablinks[i].style.display = "none";
		}
	}	
	//log("hiding tablinks ends");
}
function openTabLinks(names){
	$('.tablinks').each(function(){
		if($.trim($(this).attr('data-type')).toLowerCase()==$.trim(names).toLowerCase())
			$(this).show();
	});
	$('.smalltablinks').each(function(){
		if($.trim($(this).attr('data-type')).toLowerCase()==$.trim(names).toLowerCase())
			$(this).show();
	});
	/* var tablinks = document.getElementsByClassName("tablinks");
	for (var i = 0; i < tablinks.length; i++) {
		if($.trim(tablinks[i].textContent).toLowerCase()==$.trim(names).toLowerCase()){
			tablinks[i].style.display = "block";
		}
	}
	var tablinks = document.getElementsByClassName("smalltablinks");
	for (var i = 0; i < tablinks.length; i++) {
		if($.trim(tablinks[i].textContent).toLowerCase()==$.trim(names).toLowerCase()){
			tablinks[i].style.display = "block";
		}
	} */
}
function selectTabLinks(names){
	var i, tabcontent, tablinks;
	tabcontent = document.getElementsByClassName("tabcontent");
	for (i = 0; i < tabcontent.length; i++) {
		tabcontent[i].style.display = "none";
	}
	tablinks = document.getElementsByClassName("tablinks");
	for (i = 0; i < tablinks.length; i++) {
		tablinks[i].className = tablinks[i].className.replace(" active", "");
	}
	var ID = '.tabcontent#'+names;
	$(ID).css({'display':'block'});
	$(".tablinks[data-type='"+names+"']").addClass('active');
}
function selectTabLinksMob(names){
	var i, tabcontent, tablinks;
	tabcontent = document.getElementsByClassName("smalltabcontent");
	for (i = 0; i < tabcontent.length; i++) {
		tabcontent[i].style.display = "none";
	}
	tablinks = document.getElementsByClassName("smalltablinks");
	for (i = 0; i < tablinks.length; i++) {
		tablinks[i].className = tablinks[i].className.replace(" active", "");
	}
	if(names == 'Learner'){
		$('.change_organization').hide();
		$(".single_organization").hide();
	}
	else{
		$('.change_organization').show();
		$(".single_organization").hide();
		changeSelectDropDown(names);
	}
	$('.smalltablinks[data-type="'+names+'"]').addClass('active');
	$('.smalltablinks[data-type="'+names+'"]').siblings().removeClass('active'); 
	// change upper title role starts
	$('#role_info').text(names);
	// change upper title role ends
}
function changeSelectDropDown(names){
	$('.selected_organization.mm-listview').find('li').hide();
	$('.selected_organization.mm-listview').find('li').each(function(){
		if($.trim($(this).children('a').attr('data-type')).toLowerCase()==$.trim(names).toLowerCase())
			$(this).show();
	});
}
function enableNewHeader(){
	isNewHeader=true;
}
/* multilingual password change*/
 function appendPasswordRules(){
	var str=""
	str+=""+multilingualKeyValue('190','34')+"</br>";   /* Password Policy : */
	str+=""+multilingualKeyValue('191','34')+"</br>";  /* 1. At least one special character among @!#$^*_+: */
	str+=""+multilingualKeyValue('192','34')+"</br>";  /*  2. Minimum 6 and maximum 10 letters */
	str+=""+multilingualKeyValue('193','34')+"</br>";  /* 3. Should not contain */
	str+=""+multilingualKeyValue('194','34')+"</br>";   /* 4. At least one Numeric Digit, one lower case and one upper case Character */
	$('#customTooltip[data-tooltip="tooltip"]').attr('data-original-title',''+str+'');
	$('#customTooltipView[data-tooltip="tooltip"]').attr('data-original-title',''+str+'');
	$('#customTooltipOrg[data-tooltip="tooltip"]').attr('data-original-title',''+str+'');
	/* //log(str); */
}
/* multilingual password change*/
function openBlog(){
	var filePath=window.location.protocol+"//"+window.location.host+"/EForms/html/form3090/ihub_blog.html";

	//log('filepath..'+filePath);
	callOnSearch();
	/* $('#blogContent').load(filePath); */
	$('#blogContent').load(filePath, function( response, status, xhr ) {if ( status == "success" ) {	}});
	$('#blogContent').removeClass('hidden');
	SetBreadCrumBlog();
}
function SetBreadCrumBlog(){
	$('.bredcrum .container .pull-left').html('<a onclick="$(\'.mylogo\').click();" data-a="55" data-b="Home" style="cursor:pointer;">'+multilingualKeyValue('55','34')+'</a><i aria-hidden="true" class="fa fa-angle-double-right fade_txt"></i>Blogs');	
}
function customBuildDynamicSearch_searchAggrListDemo(id,searchClass,selector,style,VMappendClass){
	$('#'+id).find('.'+searchClass).parent('div').remove();
	$('#'+id).append('<div class="searchDistrib"><input class="form-control center-block '+searchClass+'" aria-label="Search" data-a="459" data-b="Search Aggregator" placeholder="'+multilingualKeyValue('459','34')+'" type="text"><div onclick="iHUB.search.clearjQuerySearch(\''+searchClass+'\')" class="input-group-addon cousorPointer hidden">X</div></div>');/* Search by name and address - placeholder14 */
}
/* function getDashboard(){
	if($.trim($('#sessChk').val())=="" || $('#sessChk').val()==null){
		checkMyPage();/* $('#loginmodal').modal(); 
	}
	else{
		showDashboard();
	}
} */
function applyvEllipsis(){
	//Ellipses on 2nd line JS starts
	$().vEllipsis({
		'lines': 2,
		'responsive': true
	});
	//Ellipses on 2nd line JS ends
}
/* Validation for org reg */
/* Commented as available in marketPlaceBL 
function validateOrganizationDetails() {
	log(window.parent.$('#signUpOrg').attr('src')); 
	 if(eval(validateOrgColumns("txtOrganizationName"))){ 
		if ($('#txtOrganizationNameOrg').val() == "") {
			iHUB.validation.errorMessage("txtOrganizationNameOrg",iHUB.multilingual.gmv('app300'),0);    "Please enter the Organization Name."orgreg50:"
			validate = false;
			return false;
		} else {
			iHUB.validation.resetValidationColourText();
			validate = true;
		}
	 }	
	if(eval(validateOrgColumns("txtOrganizationAddress"))){ 
		if ($('#txtOrganizationAddressOrg').val() == "") {
			iHUB.validation.errorMessage("txtOrganizationAddressOrg",iHUB.multilingual.gmv('app301'),0); /* orgreg51: 
			validate = false;
			return false;
		} else {
			iHUB.validation.resetValidationColourText();
			validate = true;
		}
	 }
	 if(eval(validateOrgColumns("txtOrgCountry"))){ 
		if ($('#txtOrgCountryOrg').val() == "" || $('#txtOrgCountryOrg').val() == "Country") {
			iHUB.validation.errorMessage("txtOrgCountryOrg",iHUB.multilingual.gmv('app302'),0);  /* "Please Enter Country." orgreg52:
			validate = false;
			return false;
		} else if ($('.txtOrgCountry').val() != "") {
			iHUB.validation.resetValidationColourText();
			validate = true;
		}
	 }	
	if(eval(validateOrgColumns("txtOrganizationState"))){ 
		if(!$('#txtOrganizationStateOrg').parent('.form-group').hasClass("hidden")){
			if($('#txtOrganizationStateOrg').val()=="State" || $('#txtOrganizationStateOrg').val()==""){
				iHUB.validation.errorMessage('txtOrganizationStateOrg',iHUB.multilingual.gmv('app303'),'100');              /*  mesg4 
				validate=false;
				return false;
			}
			else{
				iHUB.validation.resetValidationColourText();
				validate=true;
			}
		}
	 }	
	if(eval(validateOrgColumns("txtOrganizationWebsite"))){ 
		if ($('#txtOrganizationWebsiteOrg').val() == "") {
			validate = true;
		} else if (!validateWebsite($('#txtOrganizationWebsiteOrg').val(), false)) {
			iHUB.validation.errorMessage("txtOrganizationWebsiteOrg",iHUB.multilingual.gmv('app304'),100);
			validate = false;
			return false;
		} else {
			iHUB.validation.resetValidationColourText();
			validate = true;
		}
	 }
	if(eval(validateOrgColumns("txtPostcode"))){
		if ($('#txtPostcodeOrg').val() == "") {
			iHUB.validation.errorMessage("txtPostcodeOrg",iHUB.multilingual.gmv('app305'),100);      /* "Please Enter the Organization Postal/Pincode."orgreg54: 
			validate = false;
			return false;
		}
		var zipCode = $('#txtPostcodeOrg').val();
		if (zipCode.length < 1 || zipCode.length > 10) {
			iHUB.validation.errorMessage("txtPostcodeOrg",iHUB.multilingual.gmv('app306'),100);         /* "Please enter correct Organization Postal/Pincode."orgreg55: 
			validate = false;
			return false;
		} else {
			iHUB.validation.resetValidationColourText();
			validate = true;
		}
	 }
	 if((eval(validateUserColumns("instituteContactNumber"))) && (!($('#instituteContactNumberOrg').parent().hasClass("hidden"))) && $('#instituteContactNumberOrg').val()!=""){	
				/* if($('#instituteContactNumberOrg').val()==""){
					iHUB.validation.errorMessage("instituteContactNumberOrg","Please enter institute's contact number",300);
					validate=false;
					return false;
				}
				if(isNaN($('#instituteContactNumberOrg').val())){
					iHUB.validation.errorMessage("instituteContactNumberOrg",iHUB.multilingual.gmv('txt23'),300);
					validate=false;
					return false;
				}
				if(Number($('#instituteContactNumberOrg').val())==0){
					iHUB.validation.errorMessage("instituteContactNumberOrg",iHUB.multilingual.gmv('txt24'),300);
					validate=false;
					return false;
				}
				var phoneNo=$('#instituteContactNumberOrg').val();
				var getLength=getPhoneNumberLength().split("@~@");
				if($.trim(phoneNo).length < Number(getLength[1]) || $.trim(phoneNo).length > Number(getLength[0])){
					iHUB.validation.errorMessage("instituteContactNumberOrg",iHUB.multilingual.gmv('txt24'),300);
					validate=false;
					return false;
				}else{
					iHUB.validation.resetValidationColourText();
					validate=true;
				}
			}
	if((eval(validateUserColumns("instituteEmailId"))) && (!($('#instituteEmailIdOrg').parent().hasClass("hidden")))&& $('#instituteEmailIdOrg').val()!=""){ 
		/* if($('#instituteEmailIdOrg').val()==""){
			iHUB.validation.errorMessage("instituteEmailIdOrg",iHUB.multilingual.gmv('txt18'),100);
			validate=false;
			return false;
		} 
		if(!iHUB.validateEmail.validateEmailId($('#instituteEmailIdOrg').val(),false)){
			iHUB.validation.errorMessage("instituteEmailIdOrg",iHUB.multilingual.gmv('txt19'),100);
			validate=false;
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	 }
 /*validation for institute
	if(isNewInstituteFieldRequired && userTypesOrg=="Distributor"){
		if((eval(validateUserColumns("institutionType")) && $('[data-id="institutionTypeOrg"]:visible').length==1) && (!($('#institutionTypeOrg').parent().hasClass("hidden")))){ 
		if(($('#institutionTypeOrg').val()=="") ||($('#institutionTypeOrg').val()=="Select")){
			iHUB.validation.errorMessage("institutionTypeOrg","Please select institution type",300);
				validate=false;
				return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	}
		if ($("#institutionTypeOrg").val()!=0) {
	/* 		if((eval(validateUserColumns("instituteContactNumber"))) && (!($('#instituteContactNumberOrg').parent().hasClass("hidden")))){	
				if($('#instituteContactNumberOrg').val()==""){
					iHUB.validation.errorMessage("instituteContactNumberOrg","Please enter institute's contact number",300);
					validate=false;
					return false;
				}
				if(isNaN($('#instituteContactNumberOrg').val())){
					iHUB.validation.errorMessage("instituteContactNumberOrg",iHUB.multilingual.gmv('txt23'),300);
					validate=false;
					return false;
				}
				if(Number($('#instituteContactNumberOrg').val())==0){
					iHUB.validation.errorMessage("instituteContactNumberOrg",iHUB.multilingual.gmv('txt24'),300);
					validate=false;
					return false;
				}
				var phoneNo=$('#instituteContactNumberOrg').val();
				var getLength=getPhoneNumberLength().split("@~@");
				if($.trim(phoneNo).length < Number(getLength[1]) || $.trim(phoneNo).length > Number(getLength[0])){
					iHUB.validation.errorMessage("instituteContactNumberOrg",iHUB.multilingual.gmv('txt24'),300);
					validate=false;
					return false;
				}else{
					iHUB.validation.resetValidationColourText();
					validate=true;
				}
			}
	if((eval(validateUserColumns("instituteEmailId"))) && (!($('#instituteEmailIdOrg').parent().hasClass("hidden")))){ 
		if($('#instituteEmailIdOrg').val()==""){
			iHUB.validation.errorMessage("instituteEmailIdOrg",iHUB.multilingual.gmv('txt18'),100);
			validate=false;
			return false;
		}
		if(!iHUB.validateEmail.validateEmailId($('#instituteEmailIdOrg').val(),false)){
			iHUB.validation.errorMessage("instituteEmailIdOrg",iHUB.multilingual.gmv('txt19'),100);
			validate=false;
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	 } 
	 if((eval(validateUserColumns("affiliatingBody")) && $('[data-id="affiliatingBodyOrg"]:visible').length==1) && (!($('#affiliatingBodyOrg').parent().hasClass("hidden")))){ 
		if(($('#affiliatingBodyOrg').val()=="") ||($('#affiliatingBodyOrg').val()=="Select")){
			iHUB.validation.errorMessage("affiliatingBodyOrg","Please select affiliating Body",300);
				validate=false;
				return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	}
	if((eval(validateUserColumns("principalName")) && $('#principalNameOrg:visible').length==1)&& (!($('#principalNameOrg').parent().hasClass("hidden")))){ 
		if($('#principalNameOrg').val()==""){
			/*Please Enter your Last Name.txt15
			iHUB.validation.errorMessage("principalNameOrg","Please enter Principal's Name.",50);
			validate=false;
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	 }
	 if((eval(validateUserColumns("principalMobileNumber")))&& (!($('#principalMobileNumberOrg').parent().hasClass("hidden")))){	
		if($('#principalMobileNumberOrg').val()==""){
			iHUB.validation.errorMessage("principalMobileNumberOrg","Please enter Principal's contact number",300);
			validate=false;
			return false;
		}
		if(isNaN($('#principalMobileNumberOrg').val())){
            /* Please enter Numeric Value as Mobile number.txt23 
		 	iHUB.validation.errorMessage("principalMobileNumberOrg",iHUB.multilingual.gmv('txt23'),300);
			validate=false;
			return false;
		}
		if(Number($('#principalMobileNumberOrg').val())==0){
			/* Please Enter a Correct Mobile Number.txt24	
		 	iHUB.validation.errorMessage("principalMobileNumberOrg",iHUB.multilingual.gmv('txt24'),300);
			validate=false;
			return false;
		}
		var phoneNo=$('#principalMobileNumberOrg').val();
		var getLength=getPhoneNumberLength().split("@~@");
		if($.trim(phoneNo).length < Number(getLength[1]) || $.trim(phoneNo).length > Number(getLength[0])){
			/* Please Enter a Correct Mobile Number.txt24 
			iHUB.validation.errorMessage("principalMobileNumberOrg",iHUB.multilingual.gmv('txt24'),300);
 			validate=false;
			return false;
		}else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	}
	if((eval(validateUserColumns("principalEmail")))&& (!($('#principalEmailOrg').parent().hasClass("hidden")))){ 
		if($('#principalEmailOrg').val()==""){
				   /*  Please Enter your Email Id.txt18 
			iHUB.validation.errorMessage("principalEmailOrg",iHUB.multilingual.gmv('txt18'),100);
			validate=false;
			return false;
		}
		if(!iHUB.validateEmail.validateEmailId($('#principalEmailOrg').val(),false)){
			/* The Email ID format is invalid,the valid Email Id format is name@org.com or name@org.co.in.txt19 
			iHUB.validation.errorMessage("principalEmailOrg",iHUB.multilingual.gmv('txt19'),100);
			validate=false;
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	 }
	 if((eval(validateUserColumns("instituteCoordinatorName")) && $('#instituteCoordinatorNameOrg:visible').length==1)&& (!($('#instituteCoordinatorNameOrg').parent().hasClass("hidden")))){ 
		if($('#instituteCoordinatorNameOrg').val()==""){
			/*Please Enter your Last Name.txt15 
			iHUB.validation.errorMessage("instituteCoordinatorNameOrg","Please enter Co-ordinator's Name.",50);
			validate=false;
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	 }
	 if((eval(validateUserColumns("instituteCoordinatorMobileNumber")))&& (!($('#instituteCoordinatorMobileNumberOrg').parent().hasClass("hidden")))){	
		if($('#instituteCoordinatorMobileNumberOrg').val()==""){
			iHUB.validation.errorMessage("instituteCoordinatorMobileNumberOrg","Please enter School Co-ordinator's contact number",300);
			validate=false;
			return false;
		}
		if(isNaN($('#instituteCoordinatorMobileNumberOrg').val())){
            /* Please enter Numeric Value as Mobile number.txt23
		 	iHUB.validation.errorMessage("instituteCoordinatorMobileNumberOrg",iHUB.multilingual.gmv('txt23'),300);
			validate=false;
			return false;
		}
		if(Number($('#instituteCoordinatorMobileNumberOrg').val())==0){
			/* Please Enter a Correct Mobile Number.txt24
		 	iHUB.validation.errorMessage("instituteCoordinatorMobileNumberOrg",iHUB.multilingual.gmv('txt24'),300);
			validate=false;
			return false;
		}
		var phoneNo=$('#instituteCoordinatorMobileNumberOrg').val();
		var getLength=getPhoneNumberLength().split("@~@");
		if($.trim(phoneNo).length < Number(getLength[1]) || $.trim(phoneNo).length > Number(getLength[0])){
			/* Please Enter a Correct Mobile Number.txt24 	
			iHUB.validation.errorMessage("instituteCoordinatorMobileNumberOrg",iHUB.multilingual.gmv('txt24'),300);
 			validate=false;
			return false;
		}else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	}
	if((eval(validateUserColumns("instituteCoordinatorEmail")))&& (!($('#instituteCoordinatorEmailOrg').parent().hasClass("hidden")))){ 
		if($('#instituteCoordinatorEmailOrg').val()==""){
				   /*  Please Enter your Email Id.txt18
			iHUB.validation.errorMessage("instituteCoordinatorEmailOrg",iHUB.multilingual.gmv('txt18'),100);
			validate=false;
			return false;
		}
		if(!iHUB.validateEmail.validateEmailId($('#instituteCoordinatorEmailOrg').val(),false)){
			/* The Email ID format is invalid,the valid Email Id format is name@org.com or name@org.co.in.txt19
			iHUB.validation.errorMessage("instituteCoordinatorEmailOrg",iHUB.multilingual.gmv('txt19'),100);
			validate=false;
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	 }
	 if((eval(validateUserColumns("institutionCoordinatorDesignation")) && $('#institutionCoordinatorDesignationOrg:visible').length==1) && (!($('#institutionCoordinatorDesignationOrg').parent().hasClass("hidden")))){ 
		if(($('#institutionCoordinatorDesignationOrg').val()=="")){
			iHUB.validation.errorMessage("institutionCoordinatorDesignationOrg","Please select Institute Co-ordinator's role",300);
				validate=false;
				return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	}
	if((eval(validateUserColumns("assessmentSpocName")) && $('#assessmentSpocNameOrg:visible').length==1)&& (!($('#assessmentSpocNameOrg').parent().hasClass("hidden")))){ 
		if($('#assessmentSpocNameOrg').val()==""){
			/*Please Enter your Last Name.txt15
			iHUB.validation.errorMessage("assessmentSpocNameOrg","Please enter Assessment Spoc Name.",50);
			validate=false;
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	 }
	if((eval(validateUserColumns("assessmentSpocMobileNumber")))&& (!($('#assessmentSpocMobileNumberOrg').parent().hasClass("hidden")))){	
				if($('#assessmentSpocMobileNumberOrg').val()==""){
					iHUB.validation.errorMessage("assessmentSpocMobileNumberOrg","Please enter assessmentSpoc contact number",300);
					validate=false;
					return false;
				}
				if(isNaN($('#assessmentSpocMobileNumberOrg').val())){
					/* Please enter Numeric Value as Mobile number.txt23 
					iHUB.validation.errorMessage("assessmentSpocMobileNumberOrg",iHUB.multilingual.gmv('txt23'),300);
					validate=false;
					return false;
				}
				if(Number($('#assessmentSpocMobileNumberOrg').val())==0){
				/* Please Enter a Correct Mobile Number.txt24 
					iHUB.validation.errorMessage("assessmentSpocMobileNumberOrg",iHUB.multilingual.gmv('txt24'),300);
					validate=false;
					return false;
				}
				var phoneNo=$('#assessmentSpocMobileNumberOrg').val();
				var getLength=getPhoneNumberLength().split("@~@");
				if($.trim(phoneNo).length < Number(getLength[1]) || $.trim(phoneNo).length > Number(getLength[0])){
					/* Please Enter a Correct Mobile Number.txt24	
					iHUB.validation.errorMessage("assessmentSpocMobileNumberOrg",iHUB.multilingual.gmv('txt24'),300);
					validate=false;
					return false;
				}else{
					iHUB.validation.resetValidationColourText();
					validate=true;
				}
			}
	if((eval(validateUserColumns("assessmentSpocEmail")))&& (!($('#assessmentSpocEmailOrg').parent().hasClass("hidden")))){ 
		if($('#assessmentSpocEmailOrg').val()==""){
				   /*  Please Enter your Email Id.txt18 
			iHUB.validation.errorMessage("assessmentSpocEmailOrg",iHUB.multilingual.gmv('txt18'),100);
			validate=false;
			return false;
		}
		if(!iHUB.validateEmail.validateEmailId($('#assessmentSpocEmailOrg').val(),false)){
			/* The Email ID format is invalid,the valid Email Id format is name@org.com or name@org.co.in.txt19
			iHUB.validation.errorMessage("assessmentSpocEmailOrg",iHUB.multilingual.gmv('txt19'),100);
			validate=false;
			return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	 }
	 if((eval(validateUserColumns("internalTypeOfInstitute")) && $('[data-id="internalTypeOfInstituteOrg"]:visible').length==1)&& (!($('#internalTypeOfInstituteOrg').parent().hasClass("hidden")))){ 
		if(($('#internalTypeOfInstituteOrg').val()=="") ||($('#internalTypeOfInstituteOrg').val()=="Select")){
			iHUB.validation.errorMessage("internalTypeOfInstituteOrg","Please select internal Type Of Institute",300);
				validate=false;
				return false;
		}
		else{
			iHUB.validation.resetValidationColourText();
			validate=true;
		}
	}
}	
	}
	 /*validation for institute
	var registeredCheck = document.getElementsByName('userRegistered');
	var ischecked_method = false;
	for (var i = 0; i < registeredCheck.length; i++) {
		if (registeredCheck[i].checked) {
			ischecked_method = true;
			break;
		}
	}
	if (!ischecked_method) {
		iHUB.validation.errorMessage("userRegistered",iHUB.multilingual.gmv('app307'),150); /*"Please Select if the the Primary user is already a Registered User or Not." orgreg56: 
		validate = false;
		return false;
	} else {
		iHUB.validation.resetValidationColourText();
		validate = true;
	}
	if (document.getElementById('YesOrg').checked) {
		if(eval(validateOrgColumns("userid_temp"))){
			if ($('#userid_tempOrg').val() == "") {
				iHUB.validation.errorMessage("userid_tempOrg",iHUB.multilingual.gmv('txt1'),220);   /*Please Enter Login Id. orgreg66: 
				validate = false;
				return false;
			} else {
				iHUB.validation.resetValidationColourText();
				validate = true;
			}
		}	
		if(eval(validateOrgColumns("confData"))){
			if ($('#confDataOrg').val() == "") {
				iHUB.validation.errorMessage("confDataOrg",iHUB.multilingual.gmv('txt20'),220);  /*"Please Enter Password." orgreg58:
				validate = false;
				return false;
			} else {
				iHUB.validation.resetValidationColourText();
				validate = true;
			}
		}
	}
	else if (document.getElementById('NoOrg').checked) {
		if(eval(validateOrgColumns("txtSalutation"))){
			if ($('#txtSalutationOrg').val() == "" || $('#txtSalutationOrg').val() == "Salutation") {
				iHUB.validation.errorMessage("txtSalutationOrg",iHUB.multilingual.gmv('txt13'),220);  /*"Please select Salutation." orgreg59: 
				validate = false;
				return false;
			} else if ($('#txtSalutationOrg').val() != "") {
				//$('#txtSalutation-H').text("");
				//$('.abc').hide();
				iHUB.validation.resetValidationColourText();
				validate = true;
			}
		}
		if(eval(validateOrgColumns("txtFirstName"))){
			if ($('#txtFirstNameOrg').val() == "") {
				iHUB.validation.errorMessage("txtFirstNameOrg",iHUB.multilingual.gmv('txt14'),220);/*"Please Enter your First Name." orgreg60: 
				validate = false;
				return false;
			} else {
				iHUB.validation.resetValidationColourText();
				validate = true;
			}
		}
		if(eval(validateOrgColumns("txtLastName"))){
			if ($('#txtLastNameOrg').val() == "") {
				iHUB.validation.errorMessage("txtLastNameOrg",iHUB.multilingual.gmv('txt15'),270);  /*"Please Enter your Last Name." orgreg61: 
				validate = false;
				return false;
			} else {
				iHUB.validation.resetValidationColourText();
				validate = true;
			}
		}
		if(eval(validateOrgColumns("txtGender"))){
			if($(".gender-container .btn-group .active").length<1){
			/* txt16 "Please select Gender."
				iHUB.validation.errorMessage("txtGenderOrg",iHUB.multilingual.gmv('txt16'),100);
				validate=false;
				return false;
			}
			else{ /* if($('#txtGender').val()!="") 
				/* $("#txtGender").val($(".gender-container .btn-group .active").val()); 
				var str = $(".gender-container .btn-group .active").val();
				str = str.toLowerCase().replace(/\b[a-z]/g, function(letter) {
					return letter.toUpperCase();
				});
				$("#txtGender").val(str);
				iHUB.validation.resetValidationColourText();
				validate=true;
			}
		}
		if(eval(validateOrgColumns("txtDisplayName"))){
			if ($('#txtDisplayNameOrg').val() == "") {
				iHUB.validation.errorMessage("txtDisplayNameOrg",iHUB.multilingual.gmv('txt17'),320);    /*"Please Enter Display Name." orgreg63:
				validate = false;
				return false;
			} else {
				iHUB.validation.resetValidationColourText();
				validate = true;
			}
		}
		if(eval(validateOrgColumns("txtEmail"))){
			if($('#txtEmailOrg').val()==""){	
				iHUB.validation.errorMessage("txtEmailOrg",iHUB.multilingual.gmv('txt18'),100);          /*"Please Enter your Email Id." orgreg64:"" 
				validate=false;
				return false;
			}
			if (!iHUB.validateEmail.validateEmailId($('#txtEmailOrg').val(), false)) {
					//document.forms[0].emailId.focus();
					iHUB.validation.errorMessage("txtEmailOrg",iHUB.multilingual.gmv('txt19'),370);  /*'The Email ID format is invalid,the valid Email Id format is name@org.com or name@org.co.in ' orgreg65:
					validate = false;
					return false;
				} else {
					//$('.abc6').hide(); 
					iHUB.validation.resetValidationColourText();
					validate = true;
				}
		}	

		if(eval(validateOrgColumns("txtLoginId_temp"))){
			if ($('#txtLoginId_tempOrg').val() == "") {
				iHUB.validation.errorMessage("txtLoginId_tempOrg",iHUB.multilingual.gmv('txt37'),370);   /*"Please Enter Login ID." orgreg66: 
				validate = false;
				return false;
			} else {
				//$('.abc61').hide();
				iHUB.validation.resetValidationColourText();
				var sPageURL = decodeURIComponent(window.location.search.substring(1)),
					sURLVariables = sPageURL.split('&'),
					sParameterName,
					i;
				sParameterName = sURLVariables;
				for (var i = 0; i < sParameterName.length; i++) {
					if (sParameterName[i].split('=')[0] === 'instanceId') {
						instanceId = sParameterName[i].split('=')[1];
					}
				}
				var masterform_id = $.trim(window.parent.$('input[name="formId"]').val())!=''?$.trim(window.parent.$('input[name="formId"]').val()):$.trim(window.parent.$('input[name="userFormId"]').val());
				var orgID = $('input[name="orgId"]').val();
				$('#txtLoginIdOrg').val($('#txtLoginId_tempOrg').val() + "_" + masterform_id + orgID + "_" + instanceId);
				$('#txtLoginIdForDisplay').val($('#txtLoginId_tempOrg').val());
				validate = true;
			}
		}
		if(eval(validateOrgColumns("txtPassword"))){
			if ($('#txtPasswordOrg').val() == "") {
				iHUB.validation.errorMessage("txtPasswordOrg",iHUB.multilingual.gmv('txt20'),420);           /*  orgreg67:"Please Enter your Password." 
				validate = false;
				return false;
			} else {
				var val = eval('validatePWD($("#txtPasswordOrg").val(),"txtPasswordOrg")');
				if (val) {
					iHUB.validation.resetValidationColourText();
					validate = true;
				} else {
					validate = false;
					return false;
				}
			}
		}
		if(eval(validateOrgColumns("ConfirmPasswOrd"))){
			if ($('#ConfirmPasswOrdOrg').val() == "") {
				iHUB.validation.errorMessage("ConfirmPasswOrdOrg",iHUB.multilingual.gmv('txt21'),420);  /*"Please Enter your Password to Confirm." orgreg68: 
				validate = false;
				return false;
			}
			if ($('#txtPasswordOrg').val() != $('#ConfirmPasswOrdOrg').val()) {
				iHUB.validation.errorMessage("ConfirmPasswOrdOrg",iHUB.multilingual.gmv('txt22'),420);  /*"The confirmed password entered does not match with your new password" orgreg69: 
				validate = false;
				return false;
			} else {
				iHUB.validation.resetValidationColourText();
				validate = true;
			}
		}
		if(eval(validateOrgColumns("txtCountry"))){ 
			if(($('#txtCountryOrg').val()=="") ||($('#txtCountryOrg').val()=="Country")){
				iHUB.validation.errorMessage("txtCountryOrg",iHUB.multilingual.gmv('mesg15'),300);//"Please select Country"
					validate=false;
					return false;
			}
			else{
				iHUB.validation.resetValidationColourText();
				validate=true;
			}
		}	
		if(eval(validateOrgColumns("txtUserState"))){
			if(!$('#txtUserStateOrg').parent('.form-group').hasClass("hidden")){
				if($('#txtUserStateOrg').val()=="State" || $('#txtUserStateOrg').val()==""){
					iHUB.validation.errorMessage("txtUserStateOrg",iHUB.multilingual.gmv('mesg66'),100);              /*" Please select State." mesg4 
					validate=false;
					return false;
				}
				else{
					iHUB.validation.resetValidationColourText();
					validate=true;
				}
			}	
		}
		if(eval(validateOrgColumns("mailCheck"))){
			if($('#mailCheckOrg').length < 0){
				iHUB.validation.errorMessage("isMailReqdOrg",iHUB.multilingual.gmv('app99'),100);/* Please select State.mesg66 
				validate=false;
				return false;
			}
			else{
				if($("#mailCheckOrg").prop('checked')){
				$('#isMailReqdOrg').val("1");
				}
				else{
					$('#isMailReqdOrg').val("0");
				}
				iHUB.validation.resetValidationColourText();
				validate=true;
			}
		}
		if(eval(validateOrgColumns("isMinor"))){
			var isMinorCheck = document.getElementsByName('isMinor');
			var isminorchecked_method = false;
			for (var i = 0; i < isMinorCheck.length; i++) {
				if (isMinorCheck[i].checked) {
					isminorchecked_method = true;
					break;
				}
			}
			if (!isminorchecked_method) {
				iHUB.validation.errorMessage("isMinor",iHUB.multilingual.gmv('app100'),150); //"Please check if you are minor or not."
				validate = false;
				return false;
			} else {
				iHUB.validation.resetValidationColourText();
				validate = true;
			}
			if (document.getElementById('isMinorYes').checked) {
				if(eval(validateOrgColumns("parentName"))){
					if ($('#parentName').val() == "") {
						iHUB.validation.errorMessage("parentName",iHUB.multilingual.gmv('app101'),220);   /*"Please Enter Parent Name." orgreg66:"" 
						validate = false;
						return false;
					} else {
						iHUB.validation.resetValidationColourText();
						validate = true;
					}
				}
				if(eval(validateOrgColumns("parentMobileNo"))){
					if ($('#parentMobileNoOrg').val() == "") {
						iHUB.validation.errorMessage("parentMobileNoOrg",iHUB.multilingual.gmv('app102'),220);/*"Please Enter your Parent Mobile Number." orgreg60: 
						validate = false;
						return false;
					} else {
						iHUB.validation.resetValidationColourText();
						validate = true;
					}
				}
				if(eval(validateOrgColumns("parentEmailId"))){
					if($('#parentEmailIdOrg').val()==""){	
						iHUB.validation.errorMessage("parentEmailIdOrg",iHUB.multilingual.gmv('app103') ,100);          /*"Please Enter your Parent Email Id." orgreg64:
						validate=false;
						return false;
					}
					if (!iHUB.validateEmail.validateEmailId($('#parentEmailIdOrg').val(), false)) {
							//document.forms[0].emailId.focus();
						iHUB.validation.errorMessage("parentEmailIdOrg",iHUB.multilingual.gmv('txt19')+'name@org.com or name@org.co.in ',370);  /* orgreg65:The Email ID format is invalid,the valid Email Id format is 
						validate = false;
						return false;
					}
					else if($.trim($('#parentEmailIdOrg').val().toLowerCase())==$.trim($('#txtEmailOrg').val().toLowerCase())){
						iHUB.validation.errorMessage("parentEmailIdOrg","Please Enter your Parent Email Id.",100);          /* "Please Enter your Parent Email Id." 
						validate=false;
						return false;
					}
					else {
							//$('.abc6').hide(); 
						iHUB.validation.resetValidationColourText();
						validate = true;
					}
				}
			}
			else if (document.getElementById('isMinorNo').checked) {
				
					iHUB.validation.resetValidationColourText();
					validate = true;
			}
			if($('#agreeConditionOrg').length > 0){
				if($('#agreeConditionOrg:checked').length==0){					
					alert(iHUB.multilingual.gmv('alrt11') );  /* orgreg45:'Please accept iON Digital Hub\'s Terms of Use' 				
					return false;
				}
				else{
					validate=true;
				}
			}
			else{
				validate=true;
			}
		}
	}
	return true;
} Commented as available in marketPlaceBL */
$(function() {
	$('input[id$=txtFirstNameOrg]').on("keyup",function() {
		var txtClone = $(this).val();
		$('input[id$=txtDisplayNameOrg]').val(txtClone);
		if(txtClone.length==0){
			$('#txtDisplayNameOrg').parents(".form-group").find(".selName").removeClass("in");
		}
		else{
			$('#txtDisplayNameOrg').parents(".form-group").find(".selName").addClass("in");
		}
	});
	$('input[id$=txtEmailOrg]').on("keyup",function() {
		var txtClone = $(this).val();
		$('input[id$=txtLoginId_tempOrg]').val(txtClone);
		if(txtClone.length==0){
			$('#txtLoginId_tempOrg').parents(".form-group").find(".selName").removeClass("in");
		}
		else{
			$('#txtLoginId_tempOrg').parents(".form-group").find(".selName").addClass("in");
		}
	});
});
/* Commented as available in marketPlaceBL 
function validatelogin() {
	
	var loginId = document.getElementById("txtLoginIdOrg").value;
	var check;
	if (loginId != null && loginId != "") {
		var params = [loginId];
		check = validateChkDuplicateLogin(params);
	}
	if (!check) return false;
	else return true;
}
function validateChkDuplicateLogin(arrValues) {
	var a = "";
	var check = false;
	for (i = 0; i < arrValues.length; i++) {
		a = a + "-@@ion@@-" + arrValues[i];
	}
	var http_request = fnGetXMLHttpObject();
	var orgID = document.getElementById("orgId").value;
	var formID = window.parent.$('[name="formId"]').val();
	if (http_request != null) {
		var pValidationServlet = "/EForms/SecureCheckDuplicate";
		http_request.open('POST', pValidationServlet, false);
		http_request.onreadystatechange = function() {
			check = validateChkDuplicateResponse(http_request);
		};
		var parameters = orgID + "-@@ion@@-" + formID + a;
		http_request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		http_request.send("Params=" + parameters);
	}
	return check;
} 
/* function saveOrgData() {
	var userDetailsValidate = eval('validateOrganizationDetails()');
	var sPageURL = decodeURIComponent(window.location.search.substring(1)),
		sURLVariables = sPageURL.split('&'),
		sParameterName,
		i;
	sParameterName = sURLVariables;
	for (var i = 0; i < sParameterName.length; i++) {
		if (sParameterName[i].split('=')[0] === 'instanceId') {
			instanceId = sParameterName[i].split('=')[1];
		}
	}
	$('#txtInstanceId').val(instanceId);
	$('#languageId').val(defaultLanguageId);
	$('#timezoneId').val(defaultTimeZone);
	if (userDetailsValidate){
		if (document.getElementById('NoOrg').checked) {
			if (eval('validatelogin()')) {
				var goAhead=false;
				if($('#agreeConditionOrg').length > 0){
					if($('#agreeConditionOrg:checked').length==0){ 
						alert(iHUB.multilingual.gmv('alrt11'));
					}
					else{
						goAhead=true;
					}
				}
				else{
					goAhead=true;
				}				
				if(goAhead){
					if($('#isMinor').val()==""){
						$('#isMinor').val("0");
					}
					$('#txtCountryOrg').removeAttr('disabled', 'disabled');
					$('#txtCountryOrg').selectpicker('refresh');
					$('#txtOrgCountryOrg').removeAttr("disabled","disabled");
					$('#txtOrgCountryOrg').selectpicker('refresh');
					if (window.parent.isNewOrgRegistration && typeof allowOrgSignUp == 'function'){ 
						allowOrgSignUp();
					}
					else{
						eval(validateIonCaptcha("saveFormData","Submit"));
					}
				}
			}else {
				iHUB.validation.errorMessage("txtLoginId_tempOrg","This login Id is already registered.",220); 
			}
		}
		else if (document.getElementById('YesOrg').checked) {
			dailyPswdChk();
		}
	}
}	
function dailyPswdChk(){
	var dailyPassword="";
	var url = iHUB.url.get();
	var txtInstanceId=$.trim($('#txtInstanceId').val());
	var orgID=$('#orgId').val();
	var formId=$('#formId').val();
	$.ajax({
		type : "POST",
		url : url,
		data : {
			masterform_id : formId,
			orgID :orgID,
			subAction : 'checkdailypasswordrequirement',
			txtInstanceId : txtInstanceId,
		},
		dataType : "json",
		success : function(result) {
			log('result'+result);
			var res = JSON.stringify(result);
			var obj = JSON.parse(res);
			if($.trim(obj.isdailypasswordrequired) == "true"){
				var password2 = prompt("Please enter daily password:");
				if (password2 == null || password2 == "") {
					log("password2"+password2);
				} else {
					dailyPassword= password2;
					log("dailyPassword before:"+dailyPassword);
				}
			}
		},
		error: function(x, e){

		},
		complete: function(){
			validateUserCredentials(dailyPassword);
		}
	}); 
}
function validateUserCredentials(dailyPassword){
	var masterform_id = parent.$('[name="formId"]').val();
	if(masterform_id==undefined || $.trim(masterform_id)=="")
		masterform_id=parent.$('#userFormId').val();
	var orgID = $('#orgId').val();
	var instanceId;
	var sPageURL = decodeURIComponent(window.location.search.substring(1)),
		sURLVariables = sPageURL.split('&'),
		sParameterName,
		i;
	sParameterName = sURLVariables;
	for (var i = 0; i < sParameterName.length; i++) {
		if (sParameterName[i].split('=')[0] === 'instanceId') {
			instanceId = sParameterName[i].split('=')[1];
		}
	}
	if(instanceId==='' || instanceId===undefined){
		instanceId=$("#txtInstanceId_div").text()==""?$("#txtInstanceId").val():$("#txtInstanceId_div").text();
	}
	if(instanceId==='' || instanceId===undefined){
			instanceId=$.trim($('#instanceId').val());
	}
	var url=iHUB.url.get();
	var userid=$('#userid_tempOrg').val()+"_"+masterform_id+orgID+"_"+instanceId;
	$.ajax({
		type: "POST",
		url: url,
		data: {
			orgID:orgID,
			masterform_id:masterform_id,
			txtInstanceId:instanceId,
			userid:userid,
			dailyPassword:dailyPassword,
			confData:$('#confDataOrg').val(),
			subAction:"validateUser"
		},
		dataType: "text",
		success: function(responseTemp){
			var result=responseTemp.split('@~@')[0];
			if(result.toLowerCase()=="invalid"){
				iHUB.validation.errorMessage("userid_tempOrg","Login Id doesn't exists.",220); 
				validate = false;
				return false;
			}
			else if(responseTemp.split('@~@')[1]=="0"){
				if(result.toLowerCase()=="on-hold"){
					$('#userid_tempOrg').val('');
					$('#confDataOrg').val('');
					alert("You are not elligible to affilliate as you are a minor.");
					validate = false;
					return false;
				}
				else if(result.toLowerCase()==userid.toLowerCase()){
					iHUB.validation.resetValidationColourText();
					$('#txtLoginIdOrg').val($('#userid_tempOrg').val()+"_"+masterform_id+orgID+"_"+instanceId);
					var goAhead=false;
					if($('#agreeConditionOrg').length > 0){
						if($('#agreeConditionOrg:checked').length==0){
							alert('Please accept iON Digital Hub\'s Terms of Use');  
						}
						else{
							goAhead=true;
						}
					}
					else{
						goAhead=true;
					}				
					if(goAhead){
						if($('#isMinorOrg').val()==""){
							$('#isMinorOrg').val("0");
						}
						$('#txtCountryOrg').removeAttr('disabled', 'disabled');
						$('#txtCountryOrg').selectpicker('refresh');
						$('#txtOrgCountryOrg').removeAttr("disabled","disabled");
						$('#txtOrgCountryOrg').selectpicker('refresh');
						if (window.parent.isNewOrgRegistration && typeof allowOrgSignUp == 'function'){ 
							allowOrgSignUp();
						}
						else{
							eval(validateIonCaptcha("saveFormData","Submit"));
						}
					}
				}
			}
			else if(responseTemp.split('@~@')[1]=="1"){
				$('#userid_tempOrg').val('');
				$('#confDataOrg').val('');
				alert("You are not elligible to affilliate as you are a minor.");
				validate = false;
				return false;
			}
		},
		error: function(x, e){
			if(e=="parsererror" && x.responseText=="session is not avaliable"){
				createIncorrectURLLoader();
				return false;
			}
		},
		complete: function(){
			
		}
	});
} 
function allowOrgSignUp(){
	if(validateCaptchaiHUBWS("OrgCaptchaHolder")){
		var url="/iDH/iHUBWS";
		var orgID=$('#orgId').val();
		var formId=$('#formId').val();
		var isNewUser="",userRegistered="",existingUser="",txtLoginIdForDisplay="",txtLoginId="",txtPassword="";
		if(document.getElementById('NoOrg').checked){
			isNewUser="y";
			userRegistered="no";
			existingUser="no";
			txtLoginIdForDisplay=$.trim($('#txtLoginId_tempOrg').val());
			txtLoginId=$.trim($('#txtLoginId_tempOrg').val());
			txtPassword=$('#txtPasswordOrg').val();
		}
		else{
			isNewUser="n";
			userRegistered="yes";
			existingUser="yes";
			txtLoginIdForDisplay=$.trim($('#userid_tempOrg').val());
			txtLoginId=$.trim($('#userid_tempOrg').val());
			txtPassword=$('#confDataOrg').val();
		}
		var txtInstanceId=$.trim($('#txtInstanceId').val())==""?$.trim($('#instanceId').val()):$.trim($('#txtInstanceId').val()); *///$.trim($('#txtInstanceId').val());
		/* var txtOrgType = userTypesOrg;
		var entityOrgId="0";
		var instanceid=$.trim($('#txtInstanceId').val())==""?$.trim($('#instanceId').val()):$.trim($('#txtInstanceId').val()); *///$.trim($('#txtInstanceId').val());
		/* var languageId=$.trim($('#languageId').val());
		var timezoneId=$.trim($('#timezoneId').val());
		var isMailReqd=$('#isMailReqdOrg').val();
		var isMinor=$('#isMinorOrg').val();
		var txtOrganizationName=$('#txtOrganizationNameOrg').val();
		var txtOrganizationAddress=$('#txtOrganizationAddressOrg').val();
		var txtOrgAddress2=$('#txtOrgAddress2Org').val();
		var txtOrgAddress3=$('#txtOrgAddress3Org').val();
		var txtOrganizationWebsite=$('#txtOrganizationWebsiteOrg').val();
		var txtOrgCountry=$('#txtOrgCountryOrg').val();
		var txtOrganizationState=$('#txtOrganizationStateOrg').val();
		var txtPostcode=$('#txtPostcodeOrg').val();
		var stateCode=$.trim(giveMeStateCode($.trim($('#txtOrganizationStateOrg').val())));
		var txtSalutation= $('#txtSalutationOrg').val();
		var txtFirstName=$('#txtFirstNameOrg').val();
		var txtLastName=$('#txtLastNameOrg').val();
		var txtGender=$('#txtGenderOrg').val();
		var txtDisplayName=$('#txtDisplayNameOrg').val();
		var txtEmail=$('#txtEmailOrg').val();
		var txtLoginId_temp=$('#txtLoginId_tempOrg').val();
		var ConfirmPasswOrd=$('#ConfirmPasswOrdOrg').val();
		var txtCountry=$('#txtCountryOrg').val();
		var txtUserState=$('#txtUserStateOrg').val();
		var txtUserStateCode=$.trim(giveMeStateCode($.trim($('#txtUserStateOrg').val())));
		var userid_temp=$('#userid_tempOrg').val();
		var confData=$('#confDataOrg').val();
		var txtCity=$('#txtCityOrg').val();
		var isAggregator="0";
		var consentDataOrg=$('#consentDataOrg').val();
		var isAggregatorChk = document.getElementsByName('isAggregator');
		var aggregator_method = false;
		var captchaService_imageKey=$.trim($('#captchaService_imageKey').val());
		var captchaService_answer=$.trim($('#OrgCaptchaHolder #captchaService_answer').val()); */
		/* for (var i = 0; i < isAggregatorChk.length; i++) {
			if (isAggregatorChk[i].checked) {
				aggregator_method = true;
				isAggregator="1";
				break;
			}
		} /*
		var isInstitute="";
		if (document.getElementById('YesIns').checked) {
			isInstitute="Y";
		}
		else{
			isInstitute="N";
		}
		var institutionType=$('#institutionTypeOrg').val();
		var instituteContactNumber=$('#instituteContactNumberOrg').val();
		var instituteEmailId=$('#instituteEmailIdOrg').val();
		var affiliatingBody=$('#affiliatingBodyOrg').val();
		var principalName=$('#principalNameOrg').val();
		var principalMobileNumber=$('#principalMobileNumberOrg').val();
		var principalEmail=$('#principalEmailOrg').val();
		var instituteCoordinatorName=$('#instituteCoordinatorNameOrg').val();
		var instituteCoordinatorMobileNumber=$('#instituteCoordinatorMobileNumberOrg').val();
		var instituteCoordinatorEmail=$('#instituteCoordinatorEmailOrg').val();
		var institutionCoordinatorDesignation=$('#institutionCoordinatorDesignationOrg').val();
		var assessmentSpocName=$('#assessmentSpocNameOrg').val();
		var assessmentSpocMobileNumber=$('#assessmentSpocMobileNumberOrg').val();
		var assessmentSpocEmail=$('#assessmentSpocEmailOrg').val();
		var agreeConditionOrg=$('#agreeConditionOrgOrg').val();
		var internalTypeOfInstitute=$('#internalTypeOfInstituteOrg').val();
		var dailyPassword="";
		var url = iHUB.url.get();
			$.ajax({
				type : "POST",
				url : url,
				data : {
					masterform_id : formId,
					orgID : orgID,
					subAction : 'checkdailypasswordrequirement',
					txtInstanceId : txtInstanceId,
				},
				dataType : "json",
				success : function(result) {
					var res = JSON.stringify(result);
					var obj = JSON.parse(res);
					if($.trim(obj.isdailypasswordrequired) == "true"){
						var password2 = prompt("Please enter daily password:");
						if (password2 == null || password2 == "") {
							return false;
						} else {
							dailyPassword= password2;
							log("dailyPassword before:"+dailyPassword);
						}
					}
					$.ajax({			
						type: "POST",		
						url: "/iDH/iHUBWS",		
						data: {		
							orgID: orgID,
							formId:formId,
							isNewUser: isNewUser,
							txtInstanceId: txtInstanceId,
							txtOrgType: txtOrgType,
							txtLoginIdForDisplay: txtLoginIdForDisplay,
							txtLoginId: txtLoginId,
							entityOrgId:entityOrgId,
							instanceid:instanceid,
							languageId: languageId,
							timezoneId:timezoneId,
							isMailReqd: isMailReqd,
							isMinor: isMinor,
							txtOrganizationName:txtOrganizationName,
							txtOrganizationAddress: txtOrganizationAddress,
							txtOrgAddress2: txtOrgAddress2,
							txtOrgAddress3: txtOrgAddress3,
							txtOrganizationWebsite:txtOrganizationWebsite,
							txtOrgCountry: txtOrgCountry,
							txtOrganizationState: txtOrganizationState,
							txtPostcode: txtPostcode,
							stateCode: stateCode,
							userRegistered: userRegistered,
							txtSalutation:txtSalutation,
							txtFirstName:txtFirstName,
							txtLastName: txtLastName,
							txtGender: txtGender,
							txtDisplayName: txtDisplayName,
							txtEmail: txtEmail,
							txtLoginId_temp: txtLoginId_temp,
							txtPassword: txtPassword,
							ConfirmPasswOrd: ConfirmPasswOrd,
							txtCountry: txtCountry,
							txtUserState: txtUserState,
							txtState:txtUserState,
							txtUserStateCode:txtUserStateCode,
							userid_temp: userid_temp,
							confData:confData,
							txtCity: txtCity,
							isMinor: isMinor,
							consentDataOrg:consentDataOrg,
							isAggregator: isAggregator,
							institutionType:institutionType,
							instituteContactNumber:instituteContactNumber,
							instituteEmailId:instituteEmailId,
							affiliatingBody:affiliatingBody,
							principalName:principalName,
							principalMobileNumber:principalMobileNumber,
							principalEmail:principalEmail,
							instituteCoordinatorName:instituteCoordinatorName,
							instituteCoordinatorMobileNumber:instituteCoordinatorMobileNumber,
							instituteCoordinatorEmail:instituteCoordinatorEmail,
							institutionCoordinatorDesignation:institutionCoordinatorDesignation,
							assessmentSpocName:assessmentSpocName,
							assessmentSpocMobileNumber:assessmentSpocMobileNumber,
							assessmentSpocEmail:assessmentSpocEmail,
							internalTypeOfInstitute:internalTypeOfInstitute,
							agreeConditionOrg:agreeConditionOrg,
							captchaService_imageKey:captchaService_imageKey,
							captchaService_answer:captchaService_answer,
							subAction: "orgregistration",
							dailyPassword: dailyPassword,
							existingUser:existingUser
						},		
						dataType: "json",
						async:false,
						success: function(result){
							if(result.responseDetails.captchaStatus!=undefined && result.responseDetails.captchaStatus!=null){
								if($.trim(result.responseDetails.captchaStatus).toLowerCase()!="true"){
									alert("Please enter correct text shown in image"); 
									initiHUB("OrgCaptchaHolder");
									return false;
								}
								else if($.trim(result.responseDetails.ErrorStatus).toLowerCase()=="false" || $.trim(result.responseDetails.status).toLowerCase()=="false"){
									alert("There has been some error. Please try again after sometime.");
									return false;
								}
								else{
									$('#orgRegistration').find('.signCont').find('.successBodyNew').removeClass('hidden');
									$('#orgRegistration').find('.signCont').find('.scroll_bar').addClass('hidden');
									$('#orgRegistration').find('.modal-footer').addClass('hidden');
									$('#orgRegistration').find('input[type="text"],input[type="password"],select[id!="txtCountry"]').val('');
									$('#orgRegistration').find('#isMinorNo').click();
									$('#orgRegistration').find('.selectpicker').selectpicker('refresh');
									minorUser();
									if($.trim(result.responseDetails.app_seq_no)!="")
										callFromSuccessPage(sessChk,result.responseDetails.app_seq_no);
								}
							}
							else{
								return false;
							}
						},
						error: function(x, e){
							iHUB.toaster.blackMessageToaster(x.readyState + " "+ x.status +" "+ e.msg);
						}
					});
				}
			});
		log("dailyPassword after:"+dailyPassword);
	}
} 
Commented as available in marketPlaceBL */
function selectInstitutionType(){
	var dataVal=$('select[name="institutionTypeOrg"] option:selected').attr('value');
	log("dataVal:"+dataVal);
	$(".instituteType").addClass("hidden");
	$(".instituteType .selectpicker").selectpicker('refresh');
	$(".iaminstitute .form-control").val("");
	if(dataVal==0){
		$(".iaminstitute").addClass("hidden");
	}
	else if(dataVal==1){
		$('.iaminstitute').removeClass('hidden');
		for(i=0;i<instituteIdList.length;i++){
			log("Demo:"+instituteIdList1[i]);
			if(instituteIdList1[i]!=""){
				$('[id="'+instituteIdList[i]+'"]').parent().removeClass('hidden');
				$('[id="'+instituteIdList[i]+'"]').attr("placeholder",instituteIdList1[i]);
				$('[id="'+instituteIdList[i]+'"]').attr("title",instituteIdList1[i]);
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').html("");
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').append(instituteIdList1[i]);
			}
			else{
				$('[id="'+instituteIdList[i]+'"]').parent().addClass('hidden');
			}
		}
	}	
	else if(dataVal==2){
		$('.iaminstitute').removeClass('hidden');
		for(i=0;i<instituteIdList.length;i++){
			log("Demo:"+instituteIdList2[i]);
			if(instituteIdList2[i]!=""){
				$('[id="'+instituteIdList[i]+'"]').parent().removeClass('hidden');
				$('[id="'+instituteIdList[i]+'"]').attr("placeholder",instituteIdList2[i]);
				$('[id="'+instituteIdList[i]+'"]').attr("title",instituteIdList2[i]);
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').html("");
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').append(instituteIdList2[i]);
			}
			else{
				$('[id="'+instituteIdList[i]+'"]').parent().addClass('hidden');
			}
		}
	}	
	else if(dataVal==3){
		var str="";
		$('.iaminstitute').removeClass('hidden');
		for(i=0;i<instituteIdList.length;i++){
			log("Demo:"+instituteIdList3[i]);
			if(instituteIdList3[i]!=""){
				$('[id="'+instituteIdList[i]+'"]').parent().removeClass('hidden');
				$('[id="'+instituteIdList[i]+'"]').attr("placeholder",instituteIdList3[i]);
				$('[id="'+instituteIdList[i]+'"]').attr("title",instituteIdList3[i]);
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').html("");
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').append(instituteIdList3[i]);
			}
			else{
				$('[id="'+instituteIdList[i]+'"]').parent().addClass('hidden');
			}
		}
		$('select[id="internalTypeOfInstituteOrg"]').html('');
		str+=' <option value="" title="'+multilingualKeyValue('460','34')+'" data-a="460" data-b="Internal Type Of Institute" >Select</option>';
		str+='<option value="Private">'+multilingualKeyValue('461','34')+'</option>';   /* Private */
		str+='<option value="Government">'+multilingualKeyValue('462','34')+'</option>';   /* Government */
		$('select[id="internalTypeOfInstituteOrg"]').append(str);
		$('select[id="internalTypeOfInstituteOrg"]').selectpicker('refresh');
	}
	else if(dataVal==4){
		var str='';
		$('.iaminstitute').removeClass('hidden');
		for(i=0;i<instituteIdList.length;i++){
			log("Demo:"+instituteIdList4[i]);
			if(instituteIdList4[i]!=""){
				$('[id="'+instituteIdList[i]+'"]').parent().removeClass('hidden');
				$('[id="'+instituteIdList[i]+'"]').attr("placeholder",instituteIdList4[i]);
				$('[id="'+instituteIdList[i]+'"]').attr("title",instituteIdList4[i]);
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').html("");
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').append(instituteIdList4[i]);
			}
			else{
				$('[id="'+instituteIdList[i]+'"]').parent().addClass('hidden');
			}
		}
		$('select[id="internalTypeOfInstituteOrg"]').html('');
		str+=' <option value="" title="'+multilingualKeyValue('463','34')+'"  data-a="463" data-b="Select Sector Skill Council">Select</option>';
		for(var i=0;i<selectorList.length;i++){
			str+=' <option value="'+selectorList[i]+'" >'+selectorList[i]+'</option>';
		}
		$('select[id="internalTypeOfInstituteOrg"]').append(str);
		$('select[id="internalTypeOfInstituteOrg"]').selectpicker('refresh');
	}	
	else if(dataVal==5){
		$('.iaminstitute').removeClass('hidden');
		for(i=0;i<instituteIdList.length;i++){
			log("Demo:"+instituteIdList5[i]);
			if(instituteIdList5[i]!=""){
				$('[id="'+instituteIdList[i]+'"]').parent().removeClass('hidden');
				$('[id="'+instituteIdList[i]+'"]').attr("placeholder",instituteIdList5[i]);
				$('[id="'+instituteIdList[i]+'"]').attr("title",instituteIdList5[i]);
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').html("");
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').append(instituteIdList5[i]);
			}
			else{
				$('[id="'+instituteIdList[i]+'"]').parent().addClass('hidden');
			}
		}
	}
	else if(dataVal==6){
		$('.iaminstitute').removeClass('hidden');
		for(i=0;i<instituteIdList.length;i++){
			log("Demo:"+instituteIdList6[i]);
			if(instituteIdList6[i]!=""){
				$('[id="'+instituteIdList[i]+'"]').parent().removeClass('hidden');
				$('[id="'+instituteIdList[i]+'"]').attr("placeholder",instituteIdList6[i]);
				$('[id="'+instituteIdList[i]+'"]').attr("title",instituteIdList6[i]);
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').html("");
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').append(instituteIdList6[i]);
			}
			else{
				$('[id="'+instituteIdList[i]+'"]').parent().addClass('hidden');
			}
		}
	}	
	else if(dataVal==7){
		$('.iaminstitute').removeClass('hidden');
		for(i=0;i<instituteIdList.length;i++){
			log("Demo:"+instituteIdList7[i]);
			if(instituteIdList7[i]!=""){
				$('[id="'+instituteIdList[i]+'"]').parent().removeClass('hidden');
				$('[id="'+instituteIdList[i]+'"]').attr("placeholder",instituteIdList7[i]);
				$('[id="'+instituteIdList[i]+'"]').attr("title",instituteIdList7[i]);
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').html("");
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').append(instituteIdList7[i]);
			}
			else{
				$('[id="'+instituteIdList[i]+'"]').parent().addClass('hidden');
			}
		}
	}	
	else if(dataVal==8){
		$('.iaminstitute').removeClass('hidden');
		for(i=0;i<instituteIdList.length;i++){
			log("Demo:"+instituteIdList8[i]);
			if(instituteIdList8[i]!=""){
				$('[id="'+instituteIdList[i]+'"]').parent().removeClass('hidden');
				$('[id="'+instituteIdList[i]+'"]').attr("placeholder",instituteIdList8[i]);
				$('[id="'+instituteIdList[i]+'"]').attr("title",instituteIdList8[i]);
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').html("");
				$('[id="'+instituteIdList[i]+'"]').parent().find('.selName').append(instituteIdList8[i]);
			}
			else{
				$('[id="'+instituteIdList[i]+'"]').parent().addClass('hidden');
			}
		}
	}	
}
/* function validateOrgColumns(val){
	if(userColNotReqArr.indexOf(val)>-1)
		return false;
	else
		return true;
}
function alreadyUserYes(){
	$('.iamuser').removeClass('hidden');
	$('.iamuser').val() == "";
	$('.iamnotanuser').addClass('hidden');
	$('.iamnotanuser').val() == "";
}
function alreadyUserNo(){
	$('.iamuser').addClass('hidden');
	$('.iamuser').val() == "";
	$('.iamnotanuser').removeClass('hidden');
	$('.iamnotanuser').val() == "";
} */
function isInstituteYes(){		
	$('.iaminstitute').removeClass('hidden');		
	$('.iaminstitute').val() == "";		
}		
function isInstituteNo(){		
	$('.iaminstitute').addClass('hidden');		
	$('.iaminstitute').val() == "";		
}
/* function validateWebsite(addr, db) {
	if (addr == '') return true;
	var invalidChars = '\/\'\\ ";:?!()[]\{\}^|<>#$!~`^';
	for (var i = 0; i < invalidChars.length; i++) {
		if (addr.indexOf(invalidChars.charAt(i), 0) > -1) {
			if (db) alert('Website address contains invalid characters');       
			return false;
		}
	}
	for (var i = 0; i < addr.length; i++) {
		if (addr.charCodeAt(i) > 127) {
			if (db) alert("Website address contains non ascii characters."); 
			return false;
		}
	}
	var atPos = addr.indexOf('.', 0);
	if (atPos == -1) {
		if (db) alert('Website address must contain an .'); 
		return false;
	}
	if (atPos == 0) {
		if (db) alert('Website address must not start with .') 
		return false;
	}
	if (addr.indexOf('.', atPos + 1) < 0) {
		if (db) alert('Website address must contain atleast two .')     
		return false;
	}
	if (addr.indexOf('..', 0) != -1) {
		if (db) alert('two periods must not be adjacent in website address');
		return false;
	}
	var suffix = addr.substring(addr.lastIndexOf('.') + 1);
	if (suffix.length != 2 && suffix != 'com' && suffix != 'net' && suffix != 'org' && suffix != 'edu' && suffix != 'int' && suffix != 'mil' && suffix != 'gov' & suffix != 'arpa' && suffix != 'biz' && suffix != 'aero' && suffix != 'name' && suffix != 'coop' && suffix != 'info' && suffix != 'pro' && suffix != 'museum' && suffix != 'COM' && suffix != 'NET' && suffix != 'ORG' && suffix != 'EDU' && suffix != 'INT' && suffix != 'MIL' && suffix != 'GOV' & suffix != 'ARPA' && suffix != 'BIZ' && suffix != 'AERO' && suffix != 'NAME' && suffix != 'COOP' && suffix != 'INFO' && suffix != 'PRO' && suffix != 'MUSUEM') {
		if (db) alert('invalid primary domain in website address');  
		return false;
	}
	return true;
}
function clearValues(){
	$(".form-control").val("");
	$('#txtCityOrg').selectpicker('refresh');
	$('#txtUserStateOrg').selectpicker('refresh');
	$('#txtOrganizationStateOrg').selectpicker('refresh');
	$('.iamnotanuser').addClass('hidden');
	$('.iamuser').addClass('hidden');
	initiHUB("OrgCaptchaHolder");
	$("#YesOrg,#NoOrg").prop("checked",false);
	$('#txtSalutationOrg').val('Dear');
	$(".text-danger").addClass("hidden");
	$('.form-control').css('border-color','');
	$('button.btn').css("border-color","");
	$(".selName ").removeClass("in");
	if($('#orgId').val()=="1016"){
		$("#txtOrgCountryOrg").val("India");
		$('#txtCountry').val("India");
		$('#txtCountryOrg').val("India");
	}
} */
/* Validation for org reg */
function checkForEformsLink(productId,requiredFor){
	var rString = "";
	if($.trim(productId)!=""){
		if(jQuery.isEmptyObject(eformsLinksobj)){
			var eformsLinks = $.trim($('#eformsLinks').val());
			/* {'productIdFormMap':{'IONTEST20082018':{'link':'https://cdn.digialm.com:443//EForms/configuredHtml/726/53875/application.html','type':'pre'},'IONTEST200820181':{'link':'https://cdn.digialm.com:443//EForms/configuredHtml/726/53875/application.html','type':'post'},'IONTEST200820182':{'link':'https://cdn.digialm.com:443//EForms/configuredHtml/726/53875/application.html','type':'pre,post'}}} */
			if($.trim(eformsLinks)!=""){					
				var tempObj = {};
				try{
					log("eformsLinks.."+eformsLinks);
					tempObj = JSON.parse(eformsLinks.replace(/'/g,'"'));
					log("eformsLinks JSON.."+tempObj);
				}
				catch(err) {
					console.log(err);
				} 
				finally {
					
				}
				if(!jQuery.isEmptyObject(tempObj)){
					eformsLinksobj = tempObj.productIdFormMap;
				}
			}
		}
		if(!jQuery.isEmptyObject(eformsLinksobj)){
			if($.trim(eformsLinksobj[productId])!=""){
				var link = eformsLinksobj[productId]["link"];
				var type = eformsLinksobj[productId]["type"];
				var productsPurchased=$.trim($('#productsPurchased').val());
				if($('#sessChk').length>0){
					if($.trim(requiredFor)=="block"){
						rString = type.indexOf('block') > -1 ? 'block' : "";
					}
					else if(productsPurchased!="" && productsPurchased.replace(/ /g,'').split(',').indexOf(productId) > -1 && $.trim(requiredFor)!="pre"){
						rString = type.indexOf('post') > -1 ? link : "";
					}
					else if($.trim(requiredFor)!="post"){
						rString = type.indexOf('pre') > -1 ? link : "";
					}
				}
				else if($.trim(requiredFor)=="pre"){
					rString = type.indexOf('pre') > -1 ? link : "";
				}
			}
		}
	}
	return rString;
}
function postEformSubmission(){
	$('#EformsLinkForm').modal('hide');
	if($('#iframe_eforms').length > 0){
		var calledfrom = $.trim($('#iframe_eforms').attr('data-calledfrom'));
		var productId = $.trim($('#iframe_eforms').attr('data-productId'));
		var productName = $.trim($('#iframe_eforms').attr('data-productName'));
		if(calledfrom=="buynow"){
			buyNowEventHandlerPost(productId,"","","",true);
		}
		else if(calledfrom=="activate"){
			activateLicenseInitiateEventHandler(productId,"","","","","",true);
		}
		else if(calledfrom=="addtocart"){
			addtoCartEventHandlerPost(productId,"","","",true);
		}
		else if(calledfrom=="subscribefreeproducts"){
			subscribeInitiateEventHandler(productId, productName, true, "");
		}
	}
}
/* added for jobs CR */
function createIndexDetails(response,displayName,defaultYesOrNo){
	if(defaultYesOrNo.toLowerCase()=="yes")
		defaultYesOrNo=true;
	else
		defaultYesOrNo=false;
	var obj;
	if(typeof indexDetailsTempListICMP == 'object'){
		/* //log("indexDetailsTempListICMP.."+indexDetailsTempListICMP); */
		obj=indexDetailsTempListICMP;
	}
	else{
		var newResponse=JSON.stringify(response);
		obj = JSON.parse(newResponse);
	}
	
	var categoryLevelDetails,requestDetails,categories,catalogue,publishers;
	categoryLevelDetails = obj.getCategoryDetails.subLevels;
	$('#product_catlog').data('levelDetails',categoryLevelDetails);
	buildCategoryLevelDetails(categoryLevelDetails);
	
	requestDetails = obj.createIndexDetails.requestDetails.requestDetails;
	categories = obj.createIndexDetails.categories;
	buildCategories(categories,requestDetails,displayName,defaultYesOrNo);
	catalogue = obj.createIndexDetails.catalogue;
	buildIndexCatalogue(catalogue,requestDetails,displayName);
	publishers = obj.createIndexDetails.publishers;
	buildPublishers(publishers);
	if(typeof menu_courosal_Custom == 'function'){
		menu_courosal_Custom();
	}
	else{		
		/* menu_courosal(); */
	}
	tooltipHoverFocus();
}
function buildCategoryLevelDetails(categoryLevelDetails){
	/* var count=0;
	$.each(categoryLevelDetails, function(ik, iv) {
		count++;
	});	 */
	if(!jQuery.isEmptyObject(categoryLevelDetails)){
		$('.courseMenu_drop').html("");
		$('.dropdown-menu-right').html("");
		$('#course_list .list-group').html("");
		level1ArrayN=[],level2ArrayN=[],level3ArrayN=[],level4ArrayN=[],level1ArrayV=[],level2ArrayV=[],level3ArrayV=[],level4ArrayV=[];
		var l1=0,l2=0,l3=0,l4=0;
		var val = categoryLevelDetails;
		var strMob4="";
		var strSearch="";
		if($('#createMobCatalog').siblings().attr('href')=="#mobUi"){
			$("ul[id='mobUi']").remove();
		}
		else{
			$("ul[id='mobUi']").remove();
			$('#createMobCatalog').after("<ul id=\"mobUi\"></ul>");
		}
		var countofLevel1=0;
		for (label in val) {
			var L = val[label];
			var levelName1=$.trim(L.levelName);
			var levelId1=$.trim(L.levelId);
			if(levelName1!="" && levelId1!=""){
				level1ArrayN.push(levelName1);
				level1ArrayV.push(levelId1);
				l1++;
			}
			var strLevel1="";
			if(countofLevel1==10){			
				strLevel1+="<li><a id=\"showMoreLevels\" style=\"text-align: center;\" class=\"noValue\" data-a='195' data-b='View More'><span class='lnkTrance' style='color:#13afeb;'>"+multilingualKeyValue('195','34')+"</span></a></li>";
			}
			if(countofLevel1 > 9){
				strLevel1+="<li data-submenu-id=\"submenu1-1Level"+levelId1+"\" class=\"hidden\">";
			}
			else{
				strLevel1+="<li data-submenu-id=\"submenu1-1Level"+levelId1+"\">";
			}			
			strLevel1+="<a style=\"white-space:normal\" data-level=\"txtLevel1\" class=\"categorySearch\" value=\""+levelId1+"\" onclick=\"lnk(this);\">"+levelName1+"</a>";
			strLevel1+="<div id=\"submenu1-1Level"+levelId1+"\" data-id=\""+levelName1+"\" data-catname=\""+levelName1+"\" class=\"popover\">";
			strLevel1+="<ul class=\"popover-content dropdown-menu mega-dropdown-menu row rel_amazon checksubmenu\" style=\"overflow-y:auto\">";
			strLevel1+="<li class=\"col-sm-4 firstColumn\"><ul></ul></li>";
			strLevel1+="<li class=\"col-sm-4 secondColumn\"><ul></ul></li>";
			strLevel1+="<li class=\"col-sm-4 thirdColumn\"><ul></ul></li>";
			strLevel1+="</ul></div></li>";			
			$('.courseMenu_drop').append(strLevel1);
			strSearch+="<li><a class=\"categorySearch\" value=\""+levelId1+"\" data-level=\"txtLevel1\" id=\"1Level"+levelId1+"\">"+levelName1+"<span class='selctdIcon hidden'></span></a></li>";
			var strFilterL1="<div class=\"checkbox nextLevel1\"><div class=\"checkbox panel-heading course_head 1Level"+levelId1+"\" style=\"padding:2px 10px !important;margin-bottom:6px;\"><label style=\"font-size: 13px !important;color:#666;width:86%;\"><input type=\"checkbox\" onclick=\"filterSearch();\" data-id=\"txtLevels\" data-level=\"txtLevel1\" value=\""+levelId1+"\"><span class=\"addCentre\" style='padding-top:0px;'>"+levelName1+"</span></label>";
			strFilterL1+="<i style=\"position: absolute;right: 13px;cursor:pointer;top:6px;\" class=\"fa fa-plus openNextLevel \"></i>";
			strFilterL1+="</div></div>";
			strFilterL1+="<div class=\"checkbox hidden\"><ul style=\"padding-left:10px\">";
			var strMob1="";
			strMob1+="<li class='mmenu_Bordr'> <a class=\"categorySearch\" href=\"#\" value=\""+levelId1+"\" onclick=\"lnk(this);\" data-level=\"txtLevel1\" >"+levelName1+"</a><ul id=\"submenuMobL1-1Level"+levelId1+"\"></ul></li>";
			$('ul#mobUi').append(strMob1);
			for (label in L) {
				if (label == "subLevels"){
					var L1 = L["subLevels"];
					var i=0;
					var count=0;
					for (label in L1){
						var L2 = L1[label];
						var levelName2=$.trim(L2.levelName);
						var levelId2=$.trim(L2.levelId);
						if(levelName2!="" && levelId2!=""){
							level2ArrayN.push(levelName2);
							level2ArrayV.push(levelId2);
							l2++;
						}
						var strLevel2="";
						strLevel2+="<li class=\"dropdown-header\" onclick=\"lnk(this);\" value=\""+levelId2+"\" style=\"cursor:pointer;\" data-level=\"txtLevel2\" id=\"submenu2-2Level"+levelId2+"\">"+levelName2+"</li>";/* strLevel2+="<li>&nbsp;</li>"; */			
						if(count%3==0){
							$('#submenu1-1Level'+levelId1).find('.firstColumn').find('ul').append(strLevel2);
						}
						else if(count%3==1){
							$('#submenu1-1Level'+levelId1).find('.secondColumn').find('ul').append(strLevel2);
						}
						else if(count%3==2){
							$('#submenu1-1Level'+levelId1).find('.thirdColumn').find('ul').append(strLevel2);
						}
						count++;
						strFilterL1+="<li class=\"\"><div><label style=\"margin-right: 26px;width:86%;\" class=\"darkgreyText\"><input type=\"checkbox\" onclick=\"filterSearch();\" class=\"2Level"+levelId2+" \" data-id=\"txtLevels\" data-level=\"txtLevel2\" value=\""+levelId2+"\"><span class=\"addCentre\">"+levelName2+"</span></label><i class=\"fa openNextLevel fa-plus \" style=\"position: absolute;right: 13px;padding-top: 4px;cursor:pointer;\"></i></div></li>";
						strFilterL1+="<li class=\"checkbox hidden\" style=\" margin-bottom: 5px;margin-top: 5px\"><ul style=\"padding-left:18px\">";
						var strMob2="";
						strMob2+="<li class='mmenu_Bordr'><a data-level=\"txtLevel2\" href=\"#\" value=\""+levelId2+"\" style=\"cursor:pointer;\" onclick=\"lnk(this);goBackButton();\" class=\"categorySearch\">"+levelName2+"</a><ul id=\"submenuMobL2-2Level"+levelId2+"\"></ul></li>";
						$('ul#submenuMobL1-1Level'+levelId1).append(strMob2);
						for (label in L2){
							if (label == "subLevels") {
								var L3 = L2["subLevels"];
								for (label in L3) {
									var L4 = L3[label];
									var levelName3=$.trim(L4.levelName);
									var levelId3=$.trim(L4.levelId);
									if(levelName3!="" && levelId3!=""){
										level3ArrayN.push(levelName3);
										level3ArrayV.push(levelId3);
										l3++;
									}
									var strLevel3="<li><a class=\"categorySearch\" value=\""+levelId3+"\" onclick=\"lnk(this);\" data-level=\"txtLevel3\" id=\"submenu3-3Level"+levelId3+"\">"+levelName3+"</a></li>";
									$('#submenu1-1Level'+levelId1).find('#submenu2-2Level'+levelId2).after(strLevel3);
									strFilterL1+="<li class=\"\"><div><label style=\"margin-right: 26px;width:86%;\" class=\"darkgreyText\"><input type=\"checkbox\"  onclick=\"filterSearch();\" class=\"3Level"+levelId3+" \" data-id=\"txtLevels\" data-level=\"txtLevel3\" value=\""+levelId3+"\"><span class=\"addCentre\">"+levelName3+"</span></label><i class=\"fa openNextLevel fa-plus \" style=\"position: absolute;right: 13px;padding-top: 2px;cursor:pointer;\"></i></div></li>";
									strFilterL1+="<li class=\"checkbox hidden\" style=\" margin-bottom: 5px;margin-top: 5px\"><ul style=\"padding-left:18px\">";
									var strMob3="";
									strMob3+="<li class='mmenu_Bordr'><a data-level=\"txtLevel3\" href=\"#\" value=\""+levelId3+"\" onclick=\"lnk(this);goBackButton();\" class=\"categorySearch\">"+levelName3+"</a><ul id=\"submenuMobL3-3Level"+levelId3+"\"></ul></li>";
									$('ul#submenuMobL1-1Level'+levelId1).find('ul#submenuMobL2-2Level'+levelId2).append(strMob3);
									for (label in L4){
										if (label == "subLevels") {
											var L5 = L4["subLevels"];
											for (label in L5) {
												var L6 = L5[label];
												var levelName4=$.trim(L6.levelName);
												var levelId4=$.trim(L6.levelId);
												if(levelName4!="" && levelId4!=""){
													level4ArrayN.push(levelName4);
													level4ArrayV.push(levelId4);
													l4++;
												}
												var strLevel4="<li class=\"sub_list\"><a class=\"categorySearch\"onclick=\"lnk(this);\" value=\""+levelId4+"\" data-level=\"txtLevel4\" id=\"4Level"+levelId4+"\">"+levelName4+"</a></li>";
												$('#submenu1-1Level'+levelId1).find('#submenu2-2Level'+levelId2).find('#submenu3-3Level'+levelId3).parent().after(strLevel4);
												strFilterL1+="<li><div><label style=\"width:86%;\"><input type=\"checkbox\" onclick=\"filterSearch();\" class=\"4Level"+levelId4+"\" data-id=\"txtLevels\" data-level=\"txtLevel4\" value=\""+levelId4+"\"><span class=\"addCentre\">"+levelName4+"</span></label></div></li>";
												var strMob4="";
												strMob4+="<li class='mmenu_Bordr'><a data-level=\"txtLevel4\" value=\""+levelId4+"\" href=\"#\" onclick=\"lnk(this);goBackButton();\" class=\"categorySearch\">"+levelName4+"</a></li>";
												$('ul#submenuMobL1-1Level'+levelId1).find('ul#submenuMobL2-2Level'+levelId2).find('ul#submenuMobL3-3Level'+levelId3).append(strMob4);
											}
										}
									}
									strFilterL1+="</ul></li>";
								}
							}
						}
						strFilterL1+="</ul></li>";
						i++;
					}
				}
			}
			strFilterL1+="</ul></div>";
			$('#course_list .list-group').append(strFilterL1);
			countofLevel1++;
		}
		$('.dropdown-menu-right.searchdropdown').append(strSearch);
		$('.dropdown-menu-right.searchdropdown li a').on('click',function(){
			$(this).addClass('currSelected');
			if($(this).children('.selctdIcon').hasClass('hidden')){
				$(this).children('.selctdIcon').removeClass('hidden');
			}
			else{
				$(this).children('.selctdIcon').addClass('hidden');
			}
			/* $('[data-level="txtLevel1"][value="'+$(this).attr('value')+'"][type="checkbox"]').prop('checked', true); */
		});
		
		$('#txtLevel1N').val('');
		$('#txtLevel2N').val('');
		$('#txtLevel3N').val('');
		$('#txtLevel4N').val('');
		$('#txtLevel1V').val('');
		$('#txtLevel2V').val('');
		$('#txtLevel3V').val('');
		$('#txtLevel4V').val('');
		$('#txtLevel1N').val(level1ArrayN);
		$('#txtLevel2N').val(level2ArrayN);
		$('#txtLevel3N').val(level3ArrayN);
		$('#txtLevel4N').val(level4ArrayN);
		$('#txtLevel1V').val(level1ArrayV);
		$('#txtLevel2V').val(level2ArrayV);
		$('#txtLevel3V').val(level3ArrayV);
		$('#txtLevel4V').val(level4ArrayV);		
		$('.categorySearch').each(function(){
			if($(this).siblings('ul').html()==""){			
				$(this).siblings().remove();
			}	
		});
		$('input:checkbox[data-id="txtLevels"]').on('click',function(){
			checkForExpandAndCollapse($(this));
			if($(this).parent().siblings().hasClass('fa-plus') && $(this).prop('checked')!=undefined)
				$(this).parent().siblings().click();
			/* if($(this).parent().siblings().hasClass('fa-minus') && $(this).prop('checked')==undefined)
				$(this).parent().siblings().click(); */
		});
		$('.openNextLevel').on('click',function(){
			if($(this).parent().parent().next().hasClass('hidden')){
				$(this).parent().parent().next().removeClass('hidden');
			}
			else
				$(this).parent().parent().next().addClass('hidden');
			if($(this).hasClass('fa-plus')){
				$(this).removeClass('fa-plus');
				$(this).addClass('fa-minus');
				$(this).parents('.nextLevel1').children('.checkbox.course_head').css('background','#c9eafc');
			}
			else if($(this).hasClass('fa-minus')){
				$(this).addClass('fa-plus');
				$(this).removeClass('fa-minus');
				$(this).parents('.nextLevel1').children('.checkbox.course_head').css('background','#f3f3f3');
			}
			if($(this).hasClass('fa-angle-down')){
				$(this).removeClass('fa-angle-down');
				$(this).addClass('fa-angle-up');
			}
			else if($(this).hasClass('fa-angle-up')){
				$(this).addClass('fa-angle-down');
				$(this).removeClass('fa-angle-up');
			}
			checkForCollapseAll();
		});
		$('.collapseAllLink').on('click',function(){
			$('.nextLevel1').next().addClass('hidden');
			$('.openNextLevel').each(function(){
				if($(this).hasClass('fa-minus')){
					$(this).removeClass('fa-minus');
					$(this).addClass('fa-plus');
					$(this).parents('.nextLevel1').children('.checkbox.course_head').css('background','#f3f3f3');
				}
				if($(this).hasClass('fa-angle-up')){
					$(this).removeClass('fa-angle-up');
					$(this).addClass('fa-angle-down');
				}
			});
			checkForCollapseAll();
		});
		$('.collapseAllLink').click();
		$('#course_list .list-group').find('ul').each(function(){
			if($(this).html()==""){
				$(this).parent().prev().children().find('.fa-plus').remove();
				if($(this).parent().prev().hasClass('nextLevel1')){
					$(this).parent().prev().removeClass('nextLevel1');
				}
				$(this).parent().remove();
			}
			else{
				$(this).parent().prev().addClass('nextLevel1');
			}
		});
		$('.checksubmenu').each(function(){
			if($(this).find('ul').html()=="")
				$(this).parent().remove();
		});
		/* $('nav#menu').find('ul').find('li').each(function(){
			if($(this).children().length>1 && $(this).children('a').text()){
				$(this).children('a').removeAttr('href');
			}
		}); */
		setTimeout(function() {
			buildMmenu();
		}, 1000);
		$('#showMoreLevels').on('click',function(){
			$('ul.courseMenu_drop').children('li').removeClass('hidden');
			$(this).addClass('hidden');
			setHeightofDropDown();		
		});
		$("#catlog>a").on("mouseenter",function(){
			if($('#showMoreLevels').length>0){
				$('#showMoreLevels').removeClass('hidden');
				$('#showMoreLevels').parent().nextAll().addClass('hidden');
				setHeightofDropDown();	
			} 	
		});
		$('a[data-level="txtLevel1"]').each(function(){
		  if($(this).siblings('div').html()==undefined){
				$(this).addClass('noValue');
			}
		});
		/* $('.container>a').on('click',function(){
			$('nav#menu').removeClass('hidden');									 
		}); */
		$('.collapseAllLink').addClass('hidden');
		/* $('div.checkbox.course_head').click(function(){
			var checkBoxes=$(this).find('input[type=checkbox]');
			if(checkBoxes.prop("checked"))
				$(this).css('background','#c9eafc');
			else
				$(this).css('background','#f3f3f3');
		}); */
	}
	else{
		$("ul[id='mobUi']").remove();
		buildMmenu();
	}
}
function buildCategories(categories,requestDetails,displayName,defaultYesOrNo){
	if(categories!=undefined){
		var splitFields;
		var splitVariables;
		var splitdisplayName=displayName.split(',');
		
		var message=$.trim(requestDetails.message);
		var orgId=$.trim(requestDetails.orgId);
		var instanceId=$.trim(requestDetails.instanceId);
		var subAction=$.trim(requestDetails.subAction);
		var variables=$.trim(requestDetails.variables);
		var fields=$.trim(requestDetails.fields);
		splitFields=fields.split(',');
		splitVariables=variables.split(',');
		$('.tabsCreationIndex').html("");
		var strStaticFlip="";					
		strStaticFlip+="<div class=\"widthContainer clearfix\"><div class=\"horizTab\">";
		strStaticFlip+="<div class=\"topLink clearfix flipHeading\"></div>";
		strStaticFlip+="<div class=\"contentBoxContainer\"><div class=\"cubeContainer\"><div class=\"cube flipValue\"></div></div></div>";
		strStaticFlip+="</div></div>";
		$('.tabsCreationIndex').append(strStaticFlip);
		$('#tabaccordion').html("");
		$('#tabaccordion').addClass('removemargin');						
		var j=1;
		if(defaultYesOrNo){
			var strCategoryH="";
			strCategoryH+="<div class=\"\" id=\"tbf"+(Number(j))+"\"><p class=\"singleLine\" id='type'></p></div>";
			$('.flipHeading').append(strCategoryH);
			var strCategoryV="";
			strCategoryV+="<div class=\"face\" id=\"tbf"+(Number(j))+"\"><div class=\"contentBox cBoxT"+(Number(j))+"\"><div class=\"clearfix\"></div></div></div>";
			$('.flipValue').append(strCategoryV);						
			var strHVMob = "";
			strHVMob += "<div class=\"panel panel-default\" id=\"tbf"+(Number(j))+"\">";
			strHVMob += "<div class=\"panel-heading mobiletb\" role=\"tab\">";
			strHVMob += "<a role=\"button\" data-toggle=\"collapse\" data-parent=\"#tabaccordion\" href=\"#collapse" + (Number(j)) + "\" aria-expanded=\"true\" aria-controls=\"collapse" + (Number(j)) + "\">";
			strHVMob += "<h4 class=\"semibold panel-title\" id='type'></h4>";
			strHVMob += "</a></div>";
			strHVMob += "<div id=\"collapse" + (Number(j)) + "\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"\">";
			strHVMob += "<div class=\"panel-body container\"><div class=\"row\" id=\"categoryMob\">";
			strHVMob += "</div></div></div></div>";
			$('#tabaccordion').append(strHVMob);
			j++;
		}
		for(var i=j,p=0;p<splitVariables.length;i++,p++){ /* && i<=4 */
			var variableDesc=splitVariables[p];
			if(splitFields[p].indexOf("txtLevel")!=-1){
				variableDesc=getNameForValue(splitFields[p],splitVariables[p]);
			}
			var strH="";
			strH+="<div class=\"\" id=\"tbf"+(Number(i))+"\"><p class=\"dblLine\">"+splitdisplayName[p]+"</p></div>";
			var strV="";
			strV+="  <div class=\"face \" id=\"tbf"+(Number(i))+"\"><div class=\"contentBox category"+splitFields[p].toLowerCase()+"-"+splitVariables[p].toLowerCase()+" cBoxT"+(Number(i))+"\" id=\"category"+splitFields[p].toLowerCase()+"-"+splitVariables[p].toLowerCase()+"\"><div class=\"clearfix\"></div></div></div>";
			$('.flipHeading').append(strH);
			$('.flipValue').append(strV);
			var strHVMob="";
			strHVMob+="<div class=\"panel panel-default\" id=\"tbf"+(Number(i))+"\">";
			strHVMob+="<div class=\"panel-heading mobiletb\" role=\"tab\">";
			strHVMob+="<a role=\"button\" data-toggle=\"collapse\" data-parent=\"#tabaccordion\" href=\"#collapse"+i+"\" aria-expanded=\"true\" aria-controls=\"collapse"+i+"\">";
			strHVMob+="<h4 class=\"semibold panel-title\">"+splitdisplayName[p]+"</h4>";
			strHVMob+="</a></div>";
			strHVMob+="<div id=\"collapse"+i+"\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"\">";
			strHVMob+="<div class=\"panel-body container\"><div class=\"row\" id=\"categoryMob"+splitFields[p].toLowerCase()+"-"+splitVariables[p].toLowerCase()+"\">";
			strHVMob+="</div></div></div></div>";
			$('#tabaccordion').append(strHVMob);
		}

		var ca=categories;
		globalCategories=ca;
		$('.productType-group').html('');
		var strCategoryTabs="";
		var categoryMob="";
		for(var i=0;i<5;i++){
			strCategoryTabs+="<ul class=\"TabsInnrTxt categoryTabs"+i+"\"><li><a data-level=\"txtProductCreationType\" class=\"categorySearch greenTooltip checkForEllipsis wrapCat\" onclick=\"lnk(this);\"  ></a></li><li><a data-level=\"txtProductCreationType\" class=\"categorySearch greenTooltip checkForEllipsis wrapCat\" onclick=\"lnk(this);\" ></a></li></ul>";
		}
		if(defaultYesOrNo){
			$('.cBoxT1 .clearfix').append(strCategoryTabs);
		}
		var i=1;x=0;y=0;
		var productPurchaseStr="";
		for(label in ca){
			var ca1=ca[label];
			var txtProductCount=$.trim(ca1.txtProductCount);
			var txtProductType=$.trim(ca1.txtProductType);
			var languageId=$.trim(ca1.languageId);
			var typeId=$.trim(ca1.typeId);
			if(txtProductCount!="null" && txtProductCount!="0" && !isNaN(txtProductCount)){
				if(i>5){
					x=i-6;
					y=2;
					if(defaultYesOrNo){
						$('.cBoxT1 .clearfix .categoryTabs'+x+' li:nth-child('+y+') a:nth-child(1)').html(txtProductType);
						$('.cBoxT1 .clearfix .categoryTabs'+x+' li:nth-child('+y+')').append("<a class=\"removeTextDecoration wrapCatV\"> ("+txtProductCount+")</a>");
						$('.cBoxT1 .clearfix .categoryTabs'+x+' li:nth-child('+y+')').addClass('appended');
						$('.cBoxT1 .clearfix .categoryTabs'+x+' li:nth-child('+y+') a:nth-child(1)').attr({'data-placement':'bottom','data-tooltip':'tooltip','data-typeId':typeId,'title':txtProductType});
					}						
					/* productPurchaseStr+="<div class=\"checkbox\"><label><input type=\"checkbox\" value=\"\" data-level=\"txtProductCreationType\" onclick=\"filterSearch();\" data-id=\"txtProductCreationType\"><span class=\"addCentre\">"+txtProductType+"</span></label></div>"; */
					productPurchaseStr+='<div class="products type'+typeId+'-color clearfix"><input type="checkbox" data-id="txtProductCreationType" onclick="" data-typeId="'+typeId+'" data-level="txtProductCreationType" value="" id="'+txtProductType+'"><label class="checkmark_box" for="'+txtProductType+'"><i class="fa fa-check"></i></label><span class="marginleftrht5">'+txtProductType+'</span></div>';
				}
				else{
					x=i-1;
					y=1;
					if(defaultYesOrNo){
						$('.cBoxT1 .clearfix .categoryTabs'+x+' li:nth-child('+y+') a:nth-child(1)').html(txtProductType);
						$('.cBoxT1 .clearfix .categoryTabs'+x+' li:nth-child('+y+')').append("<a class=\"removeTextDecoration wrapCatV\"> ("+txtProductCount+")</a>");
						$('.cBoxT1 .clearfix .categoryTabs'+x+' li:nth-child('+y+')').addClass('appended');
						$('.cBoxT1 .clearfix .categoryTabs'+x+' li:nth-child('+y+') a:nth-child(1)').attr({'data-placement':'bottom','data-tooltip':'tooltip','data-typeId':typeId,'title':txtProductType});
					}						
					/* productPurchaseStr+="<div class=\"checkbox\"><label><input type=\"checkbox\" value=\"\" data-level=\"txtProductCreationType\" onclick=\"filterSearch();\" data-id=\"txtProductCreationType\"><span class=\"addCentre\">"+txtProductType+"</span></label></div>"; */
					productPurchaseStr+='<div class="products type'+typeId+'-color clearfix"><input type="checkbox" data-id="txtProductCreationType" onclick="" data-typeId="'+typeId+'" data-level="txtProductCreationType" value="" id="'+txtProductType+'"><label class="checkmark_box" for="'+txtProductType+'"><i class="fa fa-check"></i></label><span class="marginleftrht5">'+txtProductType+'</span></div>';
				}
				if(i<=6){
					categoryMob+="<div class=\"col-lg-4 col-md-4 col-sm-4 col-xs-4\"><ul class=\"list-unstyled\"><li><a data-placement=\"bottom\" data-tooltip=\"tooltip\" title=\""+txtProductType+"\" data-level=\"txtProductCreationType\" data-typeId=\""+typeId+"\" class=\"categorySearch greenTooltip checkForEllipsis wrapCat\" onclick=\"lnk(this);\" >"+txtProductType+"</a><a class=\"removeTextDecoration wrapCatV\">("+txtProductCount+")</a></li></ul></div>";
				}
				i++;		
			}							
		}
		$('.productType-group').append(productPurchaseStr);
		if(defaultYesOrNo){
			/* $('.cBoxT1').find('.TabsInnrTxt:nth-child(5)').addClass('lastRow'); */
			$('#categoryMob').append(categoryMob);
		}
	}
}
function buildLeftFirstLevel(categoryLevelDetails){
	if(!jQuery.isEmptyObject(categoryLevelDetails)){
		$('.courseMenu_drop').html("");
		$('.dropdown-menu-right').html("");
		$('#course_list .list-group').html("");
		level1ArrayN=[],level2ArrayN=[],level3ArrayN=[],level4ArrayN=[],level1ArrayV=[],level2ArrayV=[],level3ArrayV=[],level4ArrayV=[];
		var strSearch="";
		if($('#createMobCatalog').siblings().attr('href')=="#mobUi"){
			$("ul[id='mobUi']").remove();
		}
		else{
			$("ul[id='mobUi']").remove();
			$('#createMobCatalog').after("<ul id=\"mobUi\"></ul>");
		}
		var countofLevel1=0;
		$.each(categoryLevelDetails, function(ik, iv) {
			var levelName1=$.trim(iv.levelName);
			var levelId1=$.trim(iv.levelId);
			if(levelName1!="" && levelId1!=""){
				level1ArrayN.push(levelName1);
				level1ArrayV.push(levelId1);
				l1++;
			}
			var strLevel1="";
			if(countofLevel1==10){			
				strLevel1+="<li><a id=\"showMoreLevels\" style=\"text-align: center;\" class=\"noValue\" data-a='195' data-b='View More'><span class='lnkTrance' style='color:#13afeb;'>"+multilingualKeyValue('195','34')+"</span></a></li>";
			}
			if(countofLevel1 > 9){
				strLevel1+="<li data-submenu-id=\"submenu1-1Level"+levelId1+"\" class=\"hidden\">";
			}
			else{
				strLevel1+="<li data-submenu-id=\"submenu1-1Level"+levelId1+"\">";
			}			
			strLevel1+="<a style=\"white-space:normal\" data-level=\"txtLevel1\" class=\"categorySearch\" value=\""+levelId1+"\" onclick=\"lnk(this);\">"+levelName1+"</a>";
			strLevel1+="<div id=\"submenu1-1Level"+levelId1+"\" data-id=\""+levelName1+"\" data-catname=\""+levelName1+"\" class=\"popover\">";
			strLevel1+="<ul class=\"popover-content dropdown-menu mega-dropdown-menu row rel_amazon checksubmenu\" style=\"overflow-y:auto\">";
			strLevel1+="<li class=\"col-sm-4 firstColumn\"><ul></ul></li>";
			strLevel1+="<li class=\"col-sm-4 secondColumn\"><ul></ul></li>";
			strLevel1+="<li class=\"col-sm-4 thirdColumn\"><ul></ul></li>";
			strLevel1+="</ul></div></li>";			
			$('.courseMenu_drop').append(strLevel1);
			strSearch+="<li><a class=\"categorySearch\" value=\""+levelId1+"\" data-level=\"txtLevel1\" id=\"1Level"+levelId1+"\">"+levelName1+"<span class='selctdIcon hidden'></span></a></li>";
			var strFilterL1="<div class=\"checkbox nextLevel1\"><div class=\"checkbox panel-heading course_head 1Level"+levelId1+"\" style=\"padding:2px 10px !important;margin-bottom:6px;\"><label style=\"font-size: 13px !important;color:#666;width:86%;\"><input type=\"checkbox\" onclick=\"filterSearch();\" data-id=\"txtLevels\" data-level=\"txtLevel1\" value=\""+levelId1+"\"><span class=\"addCentre\" style='padding-top:0px;'>"+levelName1+"</span></label>";
			strFilterL1+="<i style=\"position: absolute;right: 13px;cursor:pointer;top:6px;\" class=\"fa fa-plus openNextLevel \"></i>";
			strFilterL1+="</div></div>";
			strFilterL1+="<div class=\"checkbox hidden\"><ul style=\"padding-left:10px\">";
			var strMob1="";
			strMob1+="<li class='mmenu_Bordr'> <a class=\"categorySearch\" href=\"#\" value=\""+levelId1+"\" onclick=\"lnk(this);\" data-level=\"txtLevel1\" >"+levelName1+"</a><ul id=\"submenuMobL1-1Level"+levelId1+"\"></ul></li>";
			$('ul#mobUi').append(strMob1);
			strFilterL1+="</ul></div>";
			$('#course_list .list-group').append(strFilterL1);
			countofLevel1++;
		});
	}
}
function isJobAggregatorYes(){
	$('.iamJobAggregator').addClass('hidden');
}
function isJobAggregatorNo(){
	$('.iamJobAggregator').removeClass('hidden');
}
function isNumber(key,event){
	var keyCode;
	var isIE;
	if(navigator.appName == "Microsoft Internet Explorer" || navigator.appName == "Netscape"){
		keyCode = event.keyCode;
		isIE = 1;
		if(navigator.appName == "Netscape"){
		    keyCode = event.charCode;	
			isIE = 0;
		}
	}else{
		keyCode = event.charCode;
		isIE = 0;
	}
	if(isIE == 1 ){
		if(!((keyCode >= 48 && keyCode <= 57) ))
		{
			return false;
		}
	}
	else{
		if(!((keyCode >= 48 && keyCode <= 57) || keyCode == 0))
		{
			event.preventDefault();
		}
	}
}
function onlyAlphaNumeric(key,e){
if (navigator.appName =="Microsoft Internet Explorer"){
	var oKey = event.keyCode;
	if((oKey > 64 && oKey < 91) || (oKey > 96 && oKey < 123) || (oKey == 32) || (oKey == 46) || (oKey == 39) || (oKey >= 48 && oKey <= 57))
	{
		return true;
	}
	else
	{return false;
		//alert ('Only Alphanumeric in this field.');
	}
}else{
	var oKey = e.charCode;
	if((oKey > 64 && oKey < 91) || (oKey > 96 && oKey < 123) || (oKey == 0) || (oKey == 32) || (oKey == 46) || (oKey == 39) || (oKey >= 48 && oKey <= 57))
	{
		return true;
	}
	else
	{
		return false;
	}
}
	}
function onlyAlphaNumWithSChar(key,e){
if (navigator.appName =="Microsoft Internet Explorer"){
	var oKey = event.keyCode;
	if((oKey > 64 && oKey < 91) || (oKey > 96 && oKey < 123) || (oKey == 32)  || (oKey >= 44 && oKey <= 57))
	{
		return true;
	}
	else
	{
		return false;
	}
}else{
	var oKey = e.charCode;
	if((oKey > 64 && oKey < 91) || (oKey > 96 && oKey < 123) || (oKey == 0) || (oKey == 32)  || (oKey >= 44 && oKey <= 57))
	{
		return true;
	}
	else
	{
		return false;	
	}
}
}
function isfloatNumber(key,event) {
 	var keyCode;
	var isIE;
	if(navigator.appName == "Microsoft Internet Explorer" || navigator.appName == "Netscape"){  
		keyCode = event.keyCode;
		isIE = 1;
		if(navigator.appName == "Netscape"){
		    keyCode = event.charCode;	
			isIE = 0;
		}
	}else{
		keyCode = event.charCode;
		isIE = 0;
	}
			if(isIE == 1 ){
			if(!((keyCode >= 48 && keyCode <= 57) || keyCode==46))
			{
			event.returnValue = false;
				}
			}
			else{
			if(!((keyCode >= 48 && keyCode <= 57) || keyCode == 0 || keyCode==46))
			{
				event.preventDefault();	
			}
	  }
}
function onlyAlpha_forName(key,e){
	if (navigator.appName =="Microsoft Internet Explorer"){
		var oKey = event.keyCode;
		if((oKey > 64 && oKey < 91) || (oKey > 96 && oKey < 123) || (oKey == 32) || (oKey == 46) || (oKey == 39))
		{
			return true;
		}
		else
		{
			//alert ('Only Alphanumeric in this field.');
		}
	}
	else{
		var oKey = e.charCode;
		if((oKey > 64 && oKey < 91) || (oKey > 96 && oKey < 123) || (oKey == 0) || (oKey == 32) || (oKey == 46) || (oKey == 39))
		{
			return true;
		}
		else
		{

		}
	}
	return false;
}
function onlyAlphaNumWithSChariVT(key,e){
	if (navigator.appName =="Microsoft Internet Explorer"){
		var oKey = event.keyCode;
		if((oKey > 64 && oKey < 91) || (oKey > 96 && oKey < 123) || (oKey == 32) || (oKey == 38) || (oKey == 39) || (oKey >= 44 && oKey <= 57)){
			return true;
		}
		else{
			return false;
		}
	} else{
		var oKey = e.charCode;
		if((oKey > 64 && oKey < 91) || (oKey > 96 && oKey < 123) || (oKey == 0) || (oKey == 32) || (oKey == 38) ||(oKey == 39) || (oKey >= 44 && oKey <= 57)){
			return true;
		}
		else{
			return false;		
		}
	}	
} 
function callJobsCataloge(val,search,lnkParams){
	store.set('preLoginState','Catalouge_'+search);
	if($.trim(lnkParams)!=""){
		var lnkParams1=lnkParams.split("@@");
		var Catalouge_field=$.trim(lnkParams1[0]);
		var Catalouge_tempField=$.trim(lnkParams1[1]);
		var Catalouge_tempVariable=$.trim(lnkParams1[2]);
		var Catalouge_txtProductCreationType=$.trim(lnkParams1[3]);
		store.set('Catalouge_field',Catalouge_field);
		store.set('Catalouge_tempField',Catalouge_tempField);
		store.set('Catalouge_tempVariable',Catalouge_tempVariable);
		store.set('Catalouge_txtProductCreationType',Catalouge_txtProductCreationType);
	}
	store.set('Catalouge_data-field',$.trim($(val).attr('data-field')));
	store.set('Catalouge_data-type',$.trim($(val).attr('data-type')));
	$('#showCatalogue a')[0].click();
}
/* added for jobs CR */
function changePhoneNumberMaxLength(){
	var getLength=getPhoneNumberLength().split("@~@");
	if($.trim($('#sessChk').val())=="")
		$('#txtPhoneNumber,#mobileNumberHC,#instituteContactNumberOrg,#principalMobileNumberOrg,#instituteCoordinatorMobileNumberOrg,#assessmentSpocMobileNumberOrg,#parentMobileNoOrg,#OTPPhoneNumber,#parentMobileNo,#instituteContactNumber').attr('maxlength',getLength[0]);
	else
		$('#txtPhoneNumber,#txtCreatorContactNo,#txtCreatorContactNo1,#mobilenumOnLogin,#instituteContactNumberUpdate,#principalMobileNumberUpdate,#instituteCoordinatorMobileNumberUpdate,#assessmentSpocMobileNumberUpdate,#OTPPhoneNumber,#instituteContactNumber').attr('maxlength',getLength[0]);
}
function viewPolicyDetails(n){
	$.get('/iDH/dashboard/js/ihubConsent.js?version='+hubversion, function( response, status, xhr ) {
		showPolicyDetails(n);				
	});
}
/* drop down search in header starts*/
	$("#get-search-selected").text("Products");    
	$('.value-selected').click(function(){
		var selected_value = $(this).html();
		$("#get-search-selected").text(selected_value);
	});
	/* drop down search in header ends */	
function callAfterShareCatalouge(){
	(function rerunGlobalMLjson(){
		if(!jQuery.isEmptyObject(globalMLjson) && globalMLjson!=null && Object.keys(globalMLjson).length != 0){
			eval('getCatalougeData()');
			var hash = decodeURIComponent(location.href);
			/* hash="https://learning.tcsionhub.in/iDH/India/Products/view/catalogue/view/catalogue/schedule/none/search/careeredge/pageNo/1"; */
			var shareurl= hash.split('Products/')[1];
			shareurl=shareurl.split('/');
			var field="",variable="";
			var myPageLocation="redirectTo~@~";
			for(i=2;i<shareurl.length-2;i++){
				if(i % 2 === 0){
					if(i==2){
						field+=shareurl[i];
						variable+=shareurl[i+1];
					}
					else{
						field+="@~@"+shareurl[i];
						variable+="@~@"+shareurl[i+1];
					}
				}
				/* else{
					field+="@~@"+shareurl[i+1];
					variable+="@~@"+shareurl[i+2];
				} */
			}	
			var page_no=shareurl[shareurl.length-1]
			myPageLocation+="field="+field+"&subAction=createCatalogue&variable="+variable+"&pageNo="+page_no;
			console.log(myPageLocation);
			if(myPageLocation!="" && myPageLocation!=undefined){
					goTofilteredCatalogue(myPageLocation);
			}
			/* var myPage = hash.substr(1,hash.length);
			if($.trim(hash)==""){
				filterSearch();
			}
			else{
				if(hash.indexOf('=')!=-1){
					myPage = hash.substr(1,hash.indexOf('=')-1);
					myPageLocation = hash.substr(hash.indexOf('=')+1);
				}
				if(myPage == instanceId+"/Catalogue"){
					if(myPageLocation!="" && myPageLocation!=undefined){
						/* if($.trim(myPageLocation.split('~@~')[0]).toUpperCase()=="FIELD") 
							goTofilteredCatalogue(myPageLocation);
					}
				}
				var userrole = $.trim($('#txtUsrRole').val());
				if(userrole.toLowerCase()=="distributor"){
					getMyProductListsPost(store.get('distributorCatalogue'));
					$('.licence-div').hide();
				}
				else{
					$('.licence-div').show();
					$('#disAssigned').hide();
				}
			}
			 */setTimeout(function() {
				postCatalogueScript();
			},1000);
		}else{
			setTimeout(rerunGlobalMLjson, 200);
		}
	})();	
}